cscope 15 /media/shiruiwei/ourera/pcdn/playground -q 0000002436 0000326872
	@build/CMakeFiles/3.18.4/CompilerIdC/CMakeCCompilerId.c

1 #ifde‡
__˝lu•lus


5 #i‡
deföed
(
__18CXX
)

6 
	#ID_VOID_MAIN


	)

8 #i‡
deföed
(
__CLASSIC_C__
)

10 c⁄°

	)

11 vﬁ©ûe

	)

18 #i‡
deföed
(
__INTEL_COMPILER
Ë|| deföed(
__ICC
)

19 
	#COMPILER_ID
 "I¡ñ"

	)

20 #i‡
deföed
(
_MSC_VER
)

21 
	#SIMULATE_ID
 "MSVC"

	)

23 #i‡
deföed
(
__GNUC__
)

24 
	#SIMULATE_ID
 "GNU"

	)

27 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__INTEL_COMPILER
/100)

	)

28 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__INTEL_COMPILER
/10 % 10)

	)

29 #i‡
deföed
(
__INTEL_COMPILER_UPDATE
)

30 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER_UPDATE
)

	)

32 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER
 % 10)

	)

34 #i‡
deföed
(
__INTEL_COMPILER_BUILD_DATE
)

36 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__INTEL_COMPILER_BUILD_DATE
)

	)

38 #i‡
deföed
(
_MSC_VER
)

40 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

41 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

43 #i‡
deföed
(
__GNUC__
)

44 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

45 #ñi‡
deföed
(
__GNUG__
)

46 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
__GNUG__
)

	)

48 #i‡
deföed
(
__GNUC_MINOR__
)

49 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

51 #i‡
deföed
(
__GNUC_PATCHLEVEL__
)

52 
	#SIMULATE_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

55 #ñi‡
deföed
(
__PATHCC__
)

56 
	#COMPILER_ID
 "P©hSˇÀ"

	)

57 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PATHCC__
)

	)

58 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PATHCC_MINOR__
)

	)

59 #i‡
deföed
(
__PATHCC_PATCHLEVEL__
)

60 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PATHCC_PATCHLEVEL__
)

	)

63 #ñi‡
deföed
(
__BORLANDC__
Ë&& deföed(
__CODEGEARC_VERSION__
)

64 
	#COMPILER_ID
 "Emb¨ˇdîo"

	)

65 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>24 & 0x00FF)

	)

66 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>16 & 0x00FF)

	)

67 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__CODEGEARC_VERSION__
 & 0xFFFF)

	)

69 #ñi‡
deföed
(
__BORLANDC__
)

70 
	#COMPILER_ID
 "B‹œnd"

	)

72 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__BORLANDC__
>>8)

	)

73 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__BORLANDC__
 & 0xFF)

	)

75 #ñi‡
deföed
(
__WATCOMC__
) && __WATCOMC__ < 1200

76 
	#COMPILER_ID
 "W©com"

	)

78 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__WATCOMC__
 / 100)

	)

79 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10Ë% 10)

	)

80 #i‡(
__WATCOMC__
 % 10) > 0

81 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

84 #ñi‡
deföed
(
__WATCOMC__
)

85 
	#COMPILER_ID
 "O≥nW©com"

	)

87 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__WATCOMC__
 - 1100Ë/ 100)

	)

88 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10Ë% 10)

	)

89 #i‡(
__WATCOMC__
 % 10) > 0

90 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

93 #ñi‡
deföed
(
__SUNPRO_C
)

94 
	#COMPILER_ID
 "SunPro"

	)

95 #i‡
__SUNPRO_C
 >= 0x5100

97 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_C
>>12)

	)

98 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_C
>>4 & 0xFF)

	)

99 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_C
 & 0xF)

	)

102 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_C
>>8)

	)

103 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_C
>>4 & 0xF)

	)

104 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_C
 & 0xF)

	)

107 #ñi‡
deföed
(
__HP_cc
)

108 
	#COMPILER_ID
 "HP"

	)

110 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__HP_cc
/10000)

	)

111 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__HP_cc
/100 % 100)

	)

112 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__HP_cc
 % 100)

	)

114 #ñi‡
deföed
(
__DECC
)

115 
	#COMPILER_ID
 "Com∑q"

	)

117 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__DECC_VER
/10000000)

	)

118 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__DECC_VER
/100000 % 100)

	)

119 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__DECC_VER
 % 10000)

	)

121 #ñi‡
deföed
(
__IBMC__
Ë&& deföed(
__COMPILER_VER__
)

122 
	#COMPILER_ID
 "zOS"

	)

124 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

125 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

126 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

128 #ñi‡
deföed
(
__ibmxl__
Ë&& deföed(
__˛™g__
)

129 
	#COMPILER_ID
 "XLCœng"

	)

130 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ibmxl_vîsi⁄__
)

	)

131 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ibmxl_ªÀa£__
)

	)

132 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ibmxl_modifiˇti⁄__
)

	)

133 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__ibmxl_±f_fix_Àvñ__
)

	)

136 #ñi‡
deföed
(
__IBMC__
Ë&& !deföed(
__COMPILER_VER__
) && __IBMC__ >= 800

137 
	#COMPILER_ID
 "XL"

	)

139 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

140 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

141 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

143 #ñi‡
deföed
(
__IBMC__
Ë&& !deföed(
__COMPILER_VER__
) && __IBMC__ < 800

144 
	#COMPILER_ID
 "VisuÆAge"

	)

146 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

147 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

148 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

150 #ñi‡
deföed
(
__PGI
)

151 
	#COMPILER_ID
 "PGI"

	)

152 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PGIC__
)

	)

153 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PGIC_MINOR__
)

	)

154 #i‡
deföed
(
__PGIC_PATCHLEVEL__
)

155 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PGIC_PATCHLEVEL__
)

	)

158 #ñi‡
deföed
(
_CRAYC
)

159 
	#COMPILER_ID
 "Cøy"

	)

160 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_RELEASE_MAJOR
)

	)

161 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_RELEASE_MINOR
)

	)

163 #ñi‡
deföed
(
__TI_COMPILER_VERSION__
)

164 
	#COMPILER_ID
 "TI"

	)

166 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000000)

	)

167 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000 % 1000)

	)

168 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__TI_COMPILER_VERSION__
 % 1000)

	)

170 #ñi‡
deföed
(
__FUJITSU
Ë|| deföed(
__FCC_VERSION
Ë|| deföed(
__fcc_vîsi⁄
)

171 
	#COMPILER_ID
 "Fujôsu"

	)

173 #ñi‡
deföed
(
__ghs__
)

174 
	#COMPILER_ID
 "GHS"

	)

176 #ifde‡
__GHS_VERSION_NUMBER


177 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GHS_VERSION_NUMBER
 / 100)

	)

178 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GHS_VERSION_NUMBER
 / 10 % 10)

	)

179 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GHS_VERSION_NUMBER
 % 10)

	)

182 #ñi‡
deföed
(
__TINYC__
)

183 
	#COMPILER_ID
 "TöyCC"

	)

185 #ñi‡
deföed
(
__BCC__
)

186 
	#COMPILER_ID
 "Bru˚"

	)

188 #ñi‡
deföed
(
__SCO_VERSION__
)

189 
	#COMPILER_ID
 "SCO"

	)

191 #ñi‡
deföed
(
__ARMCC_VERSION
Ë&& !deföed(
__˛™g__
)

192 
	#COMPILER_ID
 "ARMCC"

	)

193 #i‡
__ARMCC_VERSION
 >= 1000000

195 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/1000000)

	)

196 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 100)

	)

197 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

200 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/100000)

	)

201 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 10)

	)

202 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

206 #ñi‡
deföed
(
__˛™g__
Ë&& deföed(
__≠∂e_buûd_vîsi⁄__
)

207 
	#COMPILER_ID
 "AµÀCœng"

	)

208 #i‡
deföed
(
_MSC_VER
)

209 
	#SIMULATE_ID
 "MSVC"

	)

211 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__˛™g_maj‹__
)

	)

212 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__˛™g_mö‹__
)

	)

213 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__˛™g_∑tchÀvñ__
)

	)

214 #i‡
deföed
(
_MSC_VER
)

216 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

217 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

219 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__≠∂e_buûd_vîsi⁄__
)

	)

221 #ñi‡
deföed
(
__˛™g__
Ë&& deföed(
__ARMCOMPILER_VERSION
)

222 
	#COMPILER_ID
 "ARMCœng"

	)

223 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCOMPILER_VERSION
/1000000)

	)

224 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCOMPILER_VERSION
/10000 % 100)

	)

225 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCOMPILER_VERSION
 % 10000)

	)

226 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__ARMCOMPILER_VERSION
)

	)

228 #ñi‡
deföed
(
__˛™g__
)

229 
	#COMPILER_ID
 "Cœng"

	)

230 #i‡
deföed
(
_MSC_VER
)

231 
	#SIMULATE_ID
 "MSVC"

	)

233 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__˛™g_maj‹__
)

	)

234 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__˛™g_mö‹__
)

	)

235 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__˛™g_∑tchÀvñ__
)

	)

236 #i‡
deföed
(
_MSC_VER
)

238 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

239 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

242 #ñi‡
deföed
(
__GNUC__
)

243 
	#COMPILER_ID
 "GNU"

	)

244 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

245 #i‡
deföed
(
__GNUC_MINOR__
)

246 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

248 #i‡
deföed
(
__GNUC_PATCHLEVEL__
)

249 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

252 #ñi‡
deföed
(
_MSC_VER
)

253 
	#COMPILER_ID
 "MSVC"

	)

255 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

256 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

257 #i‡
deföed
(
_MSC_FULL_VER
)

258 #i‡
_MSC_VER
 >= 1400

260 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 100000)

	)

263 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 10000)

	)

266 #i‡
deföed
(
_MSC_BUILD
)

267 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
_MSC_BUILD
)

	)

270 #ñi‡
deföed
(
__VISUALDSPVERSION__
Ë|| deföed(
__ADSPBLACKFIN__
Ë|| deföed(
__ADSPTS__
Ë|| deföed(
__ADSP21000__
)

271 
	#COMPILER_ID
 "ADSP"

	)

272 #i‡
deföed
(
__VISUALDSPVERSION__
)

274 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__VISUALDSPVERSION__
>>24)

	)

275 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__VISUALDSPVERSION__
>>16 & 0xFF)

	)

276 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__VISUALDSPVERSION__
>>8 & 0xFF)

	)

279 #ñi‡
deföed
(
__IAR_SYSTEMS_ICC__
Ë|| deföed(
__IAR_SYSTEMS_ICC
)

280 
	#COMPILER_ID
 "IAR"

	)

281 #i‡
deföed
(
__VER__
Ë&& deföed(
__ICCARM__
)

282 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__VER__
Ë/ 1000000)

	)

283 
	#COMPILER_VERSION_MINOR
 
	`DEC
(((
__VER__
Ë/ 1000Ë% 1000)

	)

284 
	#COMPILER_VERSION_PATCH
 
	`DEC
((
__VER__
Ë% 1000)

	)

285 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__IAR_SYSTEMS_ICC__
)

	)

286 #ñi‡
deföed
(
__VER__
Ë&& (deföed(
__ICCAVR__
Ë|| deföed(
__ICCRX__
Ë|| deföed(
__ICCRH850__
Ë|| deföed(
__ICCRL78__
Ë|| deföed(
__ICC430__
Ë|| deföed(
__ICCRISCV__
Ë|| deföed(
__ICCV850__
Ë|| deföed(
__ICC8051__
))

287 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__VER__
Ë/ 100)

	)

288 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__VER__
Ë- (((__VER__Ë/ 100)*100))

	)

289 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__SUBVERSION__
)

	)

290 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__IAR_SYSTEMS_ICC__
)

	)

293 #ñi‡
deföed
(
__SDCC_VERSION_MAJOR
Ë|| deföed(
SDCC
)

294 
	#COMPILER_ID
 "SDCC"

	)

295 #i‡
deföed
(
__SDCC_VERSION_MAJOR
)

296 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__SDCC_VERSION_MAJOR
)

	)

297 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__SDCC_VERSION_MINOR
)

	)

298 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__SDCC_VERSION_PATCH
)

	)

301 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
SDCC
/100)

	)

302 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
SDCC
/10 % 10)

	)

303 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
SDCC
 % 10)

	)

310 #ñi‡
deföed
(
__hpux
Ë|| deföed(
__hpua
)

311 
	#COMPILER_ID
 "HP"

	)

314 
	#COMPILER_ID
 ""

	)

321 c⁄°* 
	göfo_compûî
 = "INFO" ":" "compûî[" 
COMPILER_ID
 "]";

322 #ifde‡
SIMULATE_ID


323 c⁄°* 
	göfo_simuœã
 = "INFO" ":" "simuœã[" 
SIMULATE_ID
 "]";

326 #ifde‡
__QNXNTO__


327 c⁄°* 
	gqnx¡o
 = "INFO" ":" "qnxnto[]";

330 #i‡
deföed
(
__CRAYXE
Ë|| deföed(
__CRAYXC
)

331 c⁄° *
	göfo_¸ay
 = "INFO" ":" "compiler_wrapper[CrayPrgEnv]";

334 
	#STRINGIFY_HELPER
(
X
Ë#X

	)

335 
	#STRINGIFY
(
X
Ë
	`STRINGIFY_HELPER
(X)

	)

338 #i‡
deföed
(
__löux
Ë|| deföed(
__löux__
Ë|| deföed(
löux
)

339 
	#PLATFORM_ID
 "Löux"

	)

341 #ñi‡
deföed
(
__CYGWIN__
)

342 
	#PLATFORM_ID
 "Cygwö"

	)

344 #ñi‡
deföed
(
__MINGW32__
)

345 
	#PLATFORM_ID
 "MöGW"

	)

347 #ñi‡
deföed
(
__APPLE__
)

348 
	#PLATFORM_ID
 "D¨wö"

	)

350 #ñi‡
deföed
(
_WIN32
Ë|| deföed(
__WIN32__
Ë|| deföed(
WIN32
)

351 
	#PLATFORM_ID
 "Wödows"

	)

353 #ñi‡
deföed
(
__FªeBSD__
Ë|| deföed(
__FªeBSD
)

354 
	#PLATFORM_ID
 "FªeBSD"

	)

356 #ñi‡
deföed
(
__NëBSD__
Ë|| deföed(
__NëBSD
)

357 
	#PLATFORM_ID
 "NëBSD"

	)

359 #ñi‡
deföed
(
__O≥nBSD__
Ë|| deföed(
__OPENBSD
)

360 
	#PLATFORM_ID
 "O≥nBSD"

	)

362 #ñi‡
deföed
(
__sun
Ë|| deföed(
sun
)

363 
	#PLATFORM_ID
 "SunOS"

	)

365 #ñi‡
deföed
(
_AIX
Ë|| deföed(
__AIX
Ë|| deföed(
__AIX__
Ë|| deföed(
__aix
Ë|| deföed(
__aix__
)

366 
	#PLATFORM_ID
 "AIX"

	)

368 #ñi‡
deföed
(
__hpux
Ë|| deföed(
__hpux__
)

369 
	#PLATFORM_ID
 "HP-UX"

	)

371 #ñi‡
deföed
(
__HAIKU__
)

372 
	#PLATFORM_ID
 "Haiku"

	)

374 #ñi‡
deföed
(
__BeOS
Ë|| deföed(
__BEOS__
Ë|| deföed(
_BEOS
)

375 
	#PLATFORM_ID
 "BeOS"

	)

377 #ñi‡
deföed
(
__QNX__
Ë|| deföed(
__QNXNTO__
)

378 
	#PLATFORM_ID
 "QNX"

	)

380 #ñi‡
deföed
(
__åu64
Ë|| deföed(
_åu64
Ë|| deföed(
__TRU64__
)

381 
	#PLATFORM_ID
 "Tru64"

	)

383 #ñi‡
deföed
(
__riscos
Ë|| deföed(
__riscos__
)

384 
	#PLATFORM_ID
 "RISCos"

	)

386 #ñi‡
deföed
(
__söix
Ë|| deföed(
__söix__
Ë|| deföed(
__SINIX__
)

387 
	#PLATFORM_ID
 "SINIX"

	)

389 #ñi‡
deföed
(
__UNIX_SV__
)

390 
	#PLATFORM_ID
 "UNIX_SV"

	)

392 #ñi‡
deföed
(
__bsdos__
)

393 
	#PLATFORM_ID
 "BSDOS"

	)

395 #ñi‡
deföed
(
_MPRAS
Ë|| deföed(
MPRAS
)

396 
	#PLATFORM_ID
 "MP-RAS"

	)

398 #ñi‡
deföed
(
__osf
Ë|| deföed(
__osf__
)

399 
	#PLATFORM_ID
 "OSF1"

	)

401 #ñi‡
deföed
(
_SCO_SV
Ë|| deföed(
SCO_SV
Ë|| deföed(
sco_sv
)

402 
	#PLATFORM_ID
 "SCO_SV"

	)

404 #ñi‡
deföed
(
__u…rix
Ë|| deföed(
__u…rix__
Ë|| deföed(
_ULTRIX
)

405 
	#PLATFORM_ID
 "ULTRIX"

	)

407 #ñi‡
deföed
(
__XENIX__
Ë|| deföed(
_XENIX
Ë|| deföed(
XENIX
)

408 
	#PLATFORM_ID
 "Xíix"

	)

410 #ñi‡
deföed
(
__WATCOMC__
)

411 #i‡
deföed
(
__LINUX__
)

412 
	#PLATFORM_ID
 "Löux"

	)

414 #ñi‡
deföed
(
__DOS__
)

415 
	#PLATFORM_ID
 "DOS"

	)

417 #ñi‡
deföed
(
__OS2__
)

418 
	#PLATFORM_ID
 "OS2"

	)

420 #ñi‡
deföed
(
__WINDOWS__
)

421 
	#PLATFORM_ID
 "Wödows3x"

	)

423 #ñi‡
deföed
(
__VXWORKS__
)

424 
	#PLATFORM_ID
 "VxW‹ks"

	)

427 
	#PLATFORM_ID


	)

430 #ñi‡
deföed
(
__INTEGRITY
)

431 #i‡
deföed
(
INT_178B
)

432 
	#PLATFORM_ID
 "I¡egrôy178"

	)

435 
	#PLATFORM_ID
 "I¡egrôy"

	)

439 
	#PLATFORM_ID


	)

448 #i‡
deföed
(
_WIN32
Ë&& deföed(
_MSC_VER
)

449 #i‡
deföed
(
_M_IA64
)

450 
	#ARCHITECTURE_ID
 "IA64"

	)

452 #ñi‡
deföed
(
_M_X64
Ë|| deföed(
_M_AMD64
)

453 
	#ARCHITECTURE_ID
 "x64"

	)

455 #ñi‡
deföed
(
_M_IX86
)

456 
	#ARCHITECTURE_ID
 "X86"

	)

458 #ñi‡
deföed
(
_M_ARM64
)

459 
	#ARCHITECTURE_ID
 "ARM64"

	)

461 #ñi‡
deföed
(
_M_ARM
)

462 #i‡
_M_ARM
 == 4

463 
	#ARCHITECTURE_ID
 "ARMV4I"

	)

464 #ñi‡
_M_ARM
 == 5

465 
	#ARCHITECTURE_ID
 "ARMV5I"

	)

467 
	#ARCHITECTURE_ID
 "ARMV" 
	`STRINGIFY
(
_M_ARM
)

	)

470 #ñi‡
deföed
(
_M_MIPS
)

471 
	#ARCHITECTURE_ID
 "MIPS"

	)

473 #ñi‡
deföed
(
_M_SH
)

474 
	#ARCHITECTURE_ID
 "SHx"

	)

477 
	#ARCHITECTURE_ID
 ""

	)

480 #ñi‡
deföed
(
__WATCOMC__
)

481 #i‡
deföed
(
_M_I86
)

482 
	#ARCHITECTURE_ID
 "I86"

	)

484 #ñi‡
deföed
(
_M_IX86
)

485 
	#ARCHITECTURE_ID
 "X86"

	)

488 
	#ARCHITECTURE_ID
 ""

	)

491 #ñi‡
deföed
(
__IAR_SYSTEMS_ICC__
Ë|| deföed(
__IAR_SYSTEMS_ICC
)

492 #i‡
deföed
(
__ICCARM__
)

493 
	#ARCHITECTURE_ID
 "ARM"

	)

495 #ñi‡
deföed
(
__ICCRX__
)

496 
	#ARCHITECTURE_ID
 "RX"

	)

498 #ñi‡
deföed
(
__ICCRH850__
)

499 
	#ARCHITECTURE_ID
 "RH850"

	)

501 #ñi‡
deföed
(
__ICCRL78__
)

502 
	#ARCHITECTURE_ID
 "RL78"

	)

504 #ñi‡
deföed
(
__ICCRISCV__
)

505 
	#ARCHITECTURE_ID
 "RISCV"

	)

507 #ñi‡
deföed
(
__ICCAVR__
)

508 
	#ARCHITECTURE_ID
 "AVR"

	)

510 #ñi‡
deföed
(
__ICC430__
)

511 
	#ARCHITECTURE_ID
 "MSP430"

	)

513 #ñi‡
deföed
(
__ICCV850__
)

514 
	#ARCHITECTURE_ID
 "V850"

	)

516 #ñi‡
deföed
(
__ICC8051__
)

517 
	#ARCHITECTURE_ID
 "8051"

	)

520 
	#ARCHITECTURE_ID
 ""

	)

523 #ñi‡
deföed
(
__ghs__
)

524 #i‡
deföed
(
__PPC64__
)

525 
	#ARCHITECTURE_ID
 "PPC64"

	)

527 #ñi‡
deföed
(
__µc__
)

528 
	#ARCHITECTURE_ID
 "PPC"

	)

530 #ñi‡
deföed
(
__ARM__
)

531 
	#ARCHITECTURE_ID
 "ARM"

	)

533 #ñi‡
deföed
(
__x86_64__
)

534 
	#ARCHITECTURE_ID
 "x64"

	)

536 #ñi‡
deföed
(
__i386__
)

537 
	#ARCHITECTURE_ID
 "X86"

	)

540 
	#ARCHITECTURE_ID
 ""

	)

543 
	#ARCHITECTURE_ID


	)

547 
	#DEC
(
n
) \

548 ('0' + (((
n
) / 10000000)%10)), \

549 ('0' + (((
n
) / 1000000)%10)), \

550 ('0' + (((
n
) / 100000)%10)), \

551 ('0' + (((
n
) / 10000)%10)), \

552 ('0' + (((
n
) / 1000)%10)), \

553 ('0' + (((
n
) / 100)%10)), \

554 ('0' + (((
n
) / 10)%10)), \

555 ('0' + ((
n
Ë% 10))

	)

558 
	#HEX
(
n
) \

559 ('0' + ((
n
)>>28 & 0xF)), \

560 ('0' + ((
n
)>>24 & 0xF)), \

561 ('0' + ((
n
)>>20 & 0xF)), \

562 ('0' + ((
n
)>>16 & 0xF)), \

563 ('0' + ((
n
)>>12 & 0xF)), \

564 ('0' + ((
n
)>>8 & 0xF)), \

565 ('0' + ((
n
)>>4 & 0xF)), \

566 ('0' + ((
n
Ë& 0xF))

	)

569 #ifde‡
COMPILER_VERSION_MAJOR


570 c⁄° 
	göfo_vîsi⁄
[] = {

573 
COMPILER_VERSION_MAJOR
,

574 #ifde‡
COMPILER_VERSION_MINOR


575 '.', 
COMPILER_VERSION_MINOR
,

576 #ifde‡
COMPILER_VERSION_PATCH


577 '.', 
COMPILER_VERSION_PATCH
,

578 #ifde‡
COMPILER_VERSION_TWEAK


579 '.', 
COMPILER_VERSION_TWEAK
,

587 #ifde‡
COMPILER_VERSION_INTERNAL


588 c⁄° 
	göfo_vîsi⁄_öã∫Æ
[] = {

592 
COMPILER_VERSION_INTERNAL
,']','\0'};

596 #ifde‡
SIMULATE_VERSION_MAJOR


597 c⁄° 
	göfo_simuœã_vîsi⁄
[] = {

600 
SIMULATE_VERSION_MAJOR
,

601 #ifde‡
SIMULATE_VERSION_MINOR


602 '.', 
SIMULATE_VERSION_MINOR
,

603 #ifde‡
SIMULATE_VERSION_PATCH


604 '.', 
SIMULATE_VERSION_PATCH
,

605 #ifde‡
SIMULATE_VERSION_TWEAK


606 '.', 
SIMULATE_VERSION_TWEAK
,

617 c⁄°* 
	göfo_∂©f‹m
 = "INFO" ":" "∂©f‹m[" 
PLATFORM_ID
 "]";

618 c⁄°* 
	göfo_¨ch
 = "INFO" ":" "¨ch[" 
ARCHITECTURE_ID
 "]";

623 #i‡!
deföed
(
__STDC__
)

624 #i‡(
deföed
(
_MSC_VER
Ë&& !deföed(
__˛™g__
)) \

625 || (
deföed
(
__ibmxl__
Ë|| 
	$deföed
(
__IBMC__
))

626 
	#C_DIALECT
 "90"

	)

628 
	#C_DIALECT


	)

630 #ñi‡
__STDC_VERSION__
 >= 201000L

631 
	#C_DIALECT
 "11"

	)

632 #ñi‡
__STDC_VERSION__
 >= 199901L

633 
	#C_DIALECT
 "99"

	)

635 
	#C_DIALECT
 "90"

	)

637 c⁄° * 
öfo_œnguage_düÀ˘_deÁu…
 =

638 "INFO" ":" "düÀ˘_deÁu…[" 
C_DIALECT
 "]";

642 #ifde‡
ID_VOID_MAIN


643 
	$maö
(Ë{
	}
}

645 #i‡
deföed
(
__CLASSIC_C__
)

646 
	$maö
(
¨gc
, 
¨gv
) argc; *argv[];

648 
	$maö
(
¨gc
, * 
¨gv
[])

651 
ªquúe
 = 0;

652 
ªquúe
 +
öfo_compûî
[
¨gc
];

653 
ªquúe
 +
öfo_∂©f‹m
[
¨gc
];

654 
ªquúe
 +
öfo_¨ch
[
¨gc
];

655 #ifde‡
COMPILER_VERSION_MAJOR


656 
ªquúe
 +
öfo_vîsi⁄
[
¨gc
];

658 #ifde‡
COMPILER_VERSION_INTERNAL


659 
ªquúe
 +
öfo_vîsi⁄_öã∫Æ
[
¨gc
];

661 #ifde‡
SIMULATE_ID


662 
ªquúe
 +
öfo_simuœã
[
¨gc
];

664 #ifde‡
SIMULATE_VERSION_MAJOR


665 
ªquúe
 +
öfo_simuœã_vîsi⁄
[
¨gc
];

667 #i‡
	`deföed
(
__CRAYXE
Ë|| deföed(
__CRAYXC
)

668 
ªquúe
 +
öfo_¸ay
[
¨gc
];

670 
ªquúe
 +
öfo_œnguage_düÀ˘_deÁu…
[
¨gc
];

671 ()
¨gv
;

672  
ªquúe
;

673 
	}
}

	@build/CMakeFiles/3.18.4/CompilerIdCXX/CMakeCXXCompilerId.cpp

4 #i‚de‡
__˝lu•lus


12 #i‡
deföed
(
__COMO__
)

13 
	#COMPILER_ID
 "Comóu"

	)

15 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__COMO_VERSION__
 / 100)

	)

16 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__COMO_VERSION__
 % 100)

	)

18 #ñi‡
deföed
(
__INTEL_COMPILER
Ë|| deföed(
__ICC
)

19 
	#COMPILER_ID
 "I¡ñ"

	)

20 #i‡
deföed
(
_MSC_VER
)

21 
	#SIMULATE_ID
 "MSVC"

	)

23 #i‡
deföed
(
__GNUC__
)

24 
	#SIMULATE_ID
 "GNU"

	)

27 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__INTEL_COMPILER
/100)

	)

28 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__INTEL_COMPILER
/10 % 10)

	)

29 #i‡
deföed
(
__INTEL_COMPILER_UPDATE
)

30 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER_UPDATE
)

	)

32 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER
 % 10)

	)

34 #i‡
deföed
(
__INTEL_COMPILER_BUILD_DATE
)

36 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__INTEL_COMPILER_BUILD_DATE
)

	)

38 #i‡
deföed
(
_MSC_VER
)

40 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

41 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

43 #i‡
deföed
(
__GNUC__
)

44 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

45 #ñi‡
deföed
(
__GNUG__
)

46 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
__GNUG__
)

	)

48 #i‡
deföed
(
__GNUC_MINOR__
)

49 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

51 #i‡
deföed
(
__GNUC_PATCHLEVEL__
)

52 
	#SIMULATE_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

55 #ñi‡
deföed
(
__PATHCC__
)

56 
	#COMPILER_ID
 "P©hSˇÀ"

	)

57 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PATHCC__
)

	)

58 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PATHCC_MINOR__
)

	)

59 #i‡
deföed
(
__PATHCC_PATCHLEVEL__
)

60 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PATHCC_PATCHLEVEL__
)

	)

63 #ñi‡
deföed
(
__BORLANDC__
Ë&& deföed(
__CODEGEARC_VERSION__
)

64 
	#COMPILER_ID
 "Emb¨ˇdîo"

	)

65 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>24 & 0x00FF)

	)

66 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>16 & 0x00FF)

	)

67 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__CODEGEARC_VERSION__
 & 0xFFFF)

	)

69 #ñi‡
deföed
(
__BORLANDC__
)

70 
	#COMPILER_ID
 "B‹œnd"

	)

72 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__BORLANDC__
>>8)

	)

73 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__BORLANDC__
 & 0xFF)

	)

75 #ñi‡
deföed
(
__WATCOMC__
) && __WATCOMC__ < 1200

76 
	#COMPILER_ID
 "W©com"

	)

78 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__WATCOMC__
 / 100)

	)

79 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10Ë% 10)

	)

80 #i‡(
__WATCOMC__
 % 10) > 0

81 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

84 #ñi‡
deföed
(
__WATCOMC__
)

85 
	#COMPILER_ID
 "O≥nW©com"

	)

87 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__WATCOMC__
 - 1100Ë/ 100)

	)

88 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10Ë% 10)

	)

89 #i‡(
__WATCOMC__
 % 10) > 0

90 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

93 #ñi‡
deföed
(
__SUNPRO_CC
)

94 
	#COMPILER_ID
 "SunPro"

	)

95 #i‡
__SUNPRO_CC
 >= 0x5100

97 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_CC
>>12)

	)

98 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_CC
>>4 & 0xFF)

	)

99 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_CC
 & 0xF)

	)

102 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_CC
>>8)

	)

103 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_CC
>>4 & 0xF)

	)

104 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_CC
 & 0xF)

	)

107 #ñi‡
deföed
(
__HP_aCC
)

108 
	#COMPILER_ID
 "HP"

	)

110 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__HP_aCC
/10000)

	)

111 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__HP_aCC
/100 % 100)

	)

112 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__HP_aCC
 % 100)

	)

114 #ñi‡
deföed
(
__DECCXX
)

115 
	#COMPILER_ID
 "Com∑q"

	)

117 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__DECCXX_VER
/10000000)

	)

118 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__DECCXX_VER
/100000 % 100)

	)

119 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__DECCXX_VER
 % 10000)

	)

121 #ñi‡
deföed
(
__IBMCPP__
Ë&& deföed(
__COMPILER_VER__
)

122 
	#COMPILER_ID
 "zOS"

	)

124 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMCPP__
/100)

	)

125 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMCPP__
/10 % 10)

	)

126 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMCPP__
 % 10)

	)

128 #ñi‡
deföed
(
__ibmxl__
Ë&& deföed(
__˛™g__
)

129 
	#COMPILER_ID
 "XLCœng"

	)

130 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ibmxl_vîsi⁄__
)

	)

131 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ibmxl_ªÀa£__
)

	)

132 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ibmxl_modifiˇti⁄__
)

	)

133 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__ibmxl_±f_fix_Àvñ__
)

	)

136 #ñi‡
deföed
(
__IBMCPP__
Ë&& !deföed(
__COMPILER_VER__
) && __IBMCPP__ >= 800

137 
	#COMPILER_ID
 "XL"

	)

139 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMCPP__
/100)

	)

140 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMCPP__
/10 % 10)

	)

141 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMCPP__
 % 10)

	)

143 #ñi‡
deföed
(
__IBMCPP__
Ë&& !deföed(
__COMPILER_VER__
) && __IBMCPP__ < 800

144 
	#COMPILER_ID
 "VisuÆAge"

	)

146 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMCPP__
/100)

	)

147 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMCPP__
/10 % 10)

	)

148 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMCPP__
 % 10)

	)

150 #ñi‡
deföed
(
__PGI
)

151 
	#COMPILER_ID
 "PGI"

	)

152 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PGIC__
)

	)

153 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PGIC_MINOR__
)

	)

154 #i‡
deföed
(
__PGIC_PATCHLEVEL__
)

155 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PGIC_PATCHLEVEL__
)

	)

158 #ñi‡
deföed
(
_CRAYC
)

159 
	#COMPILER_ID
 "Cøy"

	)

160 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_RELEASE_MAJOR
)

	)

161 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_RELEASE_MINOR
)

	)

163 #ñi‡
deföed
(
__TI_COMPILER_VERSION__
)

164 
	#COMPILER_ID
 "TI"

	)

166 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000000)

	)

167 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000 % 1000)

	)

168 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__TI_COMPILER_VERSION__
 % 1000)

	)

170 #ñi‡
deföed
(
__FUJITSU
Ë|| deföed(
__FCC_VERSION
Ë|| deföed(
__fcc_vîsi⁄
)

171 
	#COMPILER_ID
 "Fujôsu"

	)

173 #ñi‡
deföed
(
__ghs__
)

174 
	#COMPILER_ID
 "GHS"

	)

176 #ifde‡
__GHS_VERSION_NUMBER


177 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GHS_VERSION_NUMBER
 / 100)

	)

178 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GHS_VERSION_NUMBER
 / 10 % 10)

	)

179 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GHS_VERSION_NUMBER
 % 10)

	)

182 #ñi‡
deföed
(
__SCO_VERSION__
)

183 
	#COMPILER_ID
 "SCO"

	)

185 #ñi‡
deföed
(
__ARMCC_VERSION
Ë&& !deföed(
__˛™g__
)

186 
	#COMPILER_ID
 "ARMCC"

	)

187 #i‡
__ARMCC_VERSION
 >= 1000000

189 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/1000000)

	)

190 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 100)

	)

191 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

194 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/100000)

	)

195 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 10)

	)

196 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

200 #ñi‡
deföed
(
__˛™g__
Ë&& deföed(
__≠∂e_buûd_vîsi⁄__
)

201 
	#COMPILER_ID
 "AµÀCœng"

	)

202 #i‡
deföed
(
_MSC_VER
)

203 
	#SIMULATE_ID
 "MSVC"

	)

205 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__˛™g_maj‹__
)

	)

206 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__˛™g_mö‹__
)

	)

207 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__˛™g_∑tchÀvñ__
)

	)

208 #i‡
deföed
(
_MSC_VER
)

210 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

211 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

213 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__≠∂e_buûd_vîsi⁄__
)

	)

215 #ñi‡
deföed
(
__˛™g__
Ë&& deföed(
__ARMCOMPILER_VERSION
)

216 
	#COMPILER_ID
 "ARMCœng"

	)

217 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCOMPILER_VERSION
/1000000)

	)

218 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCOMPILER_VERSION
/10000 % 100)

	)

219 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCOMPILER_VERSION
 % 10000)

	)

220 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__ARMCOMPILER_VERSION
)

	)

222 #ñi‡
deföed
(
__˛™g__
)

223 
	#COMPILER_ID
 "Cœng"

	)

224 #i‡
deföed
(
_MSC_VER
)

225 
	#SIMULATE_ID
 "MSVC"

	)

227 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__˛™g_maj‹__
)

	)

228 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__˛™g_mö‹__
)

	)

229 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__˛™g_∑tchÀvñ__
)

	)

230 #i‡
deföed
(
_MSC_VER
)

232 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

233 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

236 #ñi‡
deföed
(
__GNUC__
Ë|| deföed(
__GNUG__
)

237 
	#COMPILER_ID
 "GNU"

	)

238 #i‡
deföed
(
__GNUC__
)

239 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

241 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUG__
)

	)

243 #i‡
deföed
(
__GNUC_MINOR__
)

244 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

246 #i‡
deföed
(
__GNUC_PATCHLEVEL__
)

247 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

250 #ñi‡
deföed
(
_MSC_VER
)

251 
	#COMPILER_ID
 "MSVC"

	)

253 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

254 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

255 #i‡
deföed
(
_MSC_FULL_VER
)

256 #i‡
_MSC_VER
 >= 1400

258 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 100000)

	)

261 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 10000)

	)

264 #i‡
deföed
(
_MSC_BUILD
)

265 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
_MSC_BUILD
)

	)

268 #ñi‡
deföed
(
__VISUALDSPVERSION__
Ë|| deföed(
__ADSPBLACKFIN__
Ë|| deföed(
__ADSPTS__
Ë|| deföed(
__ADSP21000__
)

269 
	#COMPILER_ID
 "ADSP"

	)

270 #i‡
deföed
(
__VISUALDSPVERSION__
)

272 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__VISUALDSPVERSION__
>>24)

	)

273 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__VISUALDSPVERSION__
>>16 & 0xFF)

	)

274 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__VISUALDSPVERSION__
>>8 & 0xFF)

	)

277 #ñi‡
deföed
(
__IAR_SYSTEMS_ICC__
Ë|| deföed(
__IAR_SYSTEMS_ICC
)

278 
	#COMPILER_ID
 "IAR"

	)

279 #i‡
deföed
(
__VER__
Ë&& deföed(
__ICCARM__
)

280 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__VER__
Ë/ 1000000)

	)

281 
	#COMPILER_VERSION_MINOR
 
	`DEC
(((
__VER__
Ë/ 1000Ë% 1000)

	)

282 
	#COMPILER_VERSION_PATCH
 
	`DEC
((
__VER__
Ë% 1000)

	)

283 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__IAR_SYSTEMS_ICC__
)

	)

284 #ñi‡
deföed
(
__VER__
Ë&& (deföed(
__ICCAVR__
Ë|| deföed(
__ICCRX__
Ë|| deföed(
__ICCRH850__
Ë|| deföed(
__ICCRL78__
Ë|| deföed(
__ICC430__
Ë|| deföed(
__ICCRISCV__
Ë|| deföed(
__ICCV850__
Ë|| deföed(
__ICC8051__
))

285 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__VER__
Ë/ 100)

	)

286 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__VER__
Ë- (((__VER__Ë/ 100)*100))

	)

287 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__SUBVERSION__
)

	)

288 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__IAR_SYSTEMS_ICC__
)

	)

295 #ñi‡
deföed
(
__hpux
Ë|| deföed(
__hpua
)

296 
	#COMPILER_ID
 "HP"

	)

299 
	#COMPILER_ID
 ""

	)

306 c⁄°* 
	göfo_compûî
 = "INFO" ":" "compûî[" 
COMPILER_ID
 "]";

307 #ifde‡
SIMULATE_ID


308 c⁄°* 
	göfo_simuœã
 = "INFO" ":" "simuœã[" 
SIMULATE_ID
 "]";

311 #ifde‡
__QNXNTO__


312 c⁄°* 
	gqnx¡o
 = "INFO" ":" "qnxnto[]";

315 #i‡
deföed
(
__CRAYXE
Ë|| deföed(
__CRAYXC
)

316 c⁄° *
	göfo_¸ay
 = "INFO" ":" "compiler_wrapper[CrayPrgEnv]";

319 
	#STRINGIFY_HELPER
(
X
Ë#X

	)

320 
	#STRINGIFY
(
X
Ë
	`STRINGIFY_HELPER
(X)

	)

323 #i‡
deföed
(
__löux
Ë|| deföed(
__löux__
Ë|| deföed(
löux
)

324 
	#PLATFORM_ID
 "Löux"

	)

326 #ñi‡
deföed
(
__CYGWIN__
)

327 
	#PLATFORM_ID
 "Cygwö"

	)

329 #ñi‡
deföed
(
__MINGW32__
)

330 
	#PLATFORM_ID
 "MöGW"

	)

332 #ñi‡
deföed
(
__APPLE__
)

333 
	#PLATFORM_ID
 "D¨wö"

	)

335 #ñi‡
deföed
(
_WIN32
Ë|| deföed(
__WIN32__
Ë|| deföed(
WIN32
)

336 
	#PLATFORM_ID
 "Wödows"

	)

338 #ñi‡
deföed
(
__FªeBSD__
Ë|| deföed(
__FªeBSD
)

339 
	#PLATFORM_ID
 "FªeBSD"

	)

341 #ñi‡
deföed
(
__NëBSD__
Ë|| deföed(
__NëBSD
)

342 
	#PLATFORM_ID
 "NëBSD"

	)

344 #ñi‡
deföed
(
__O≥nBSD__
Ë|| deföed(
__OPENBSD
)

345 
	#PLATFORM_ID
 "O≥nBSD"

	)

347 #ñi‡
deföed
(
__sun
Ë|| deföed(
sun
)

348 
	#PLATFORM_ID
 "SunOS"

	)

350 #ñi‡
deföed
(
_AIX
Ë|| deföed(
__AIX
Ë|| deföed(
__AIX__
Ë|| deföed(
__aix
Ë|| deföed(
__aix__
)

351 
	#PLATFORM_ID
 "AIX"

	)

353 #ñi‡
deföed
(
__hpux
Ë|| deföed(
__hpux__
)

354 
	#PLATFORM_ID
 "HP-UX"

	)

356 #ñi‡
deföed
(
__HAIKU__
)

357 
	#PLATFORM_ID
 "Haiku"

	)

359 #ñi‡
deföed
(
__BeOS
Ë|| deföed(
__BEOS__
Ë|| deföed(
_BEOS
)

360 
	#PLATFORM_ID
 "BeOS"

	)

362 #ñi‡
deföed
(
__QNX__
Ë|| deföed(
__QNXNTO__
)

363 
	#PLATFORM_ID
 "QNX"

	)

365 #ñi‡
deföed
(
__åu64
Ë|| deföed(
_åu64
Ë|| deföed(
__TRU64__
)

366 
	#PLATFORM_ID
 "Tru64"

	)

368 #ñi‡
deföed
(
__riscos
Ë|| deföed(
__riscos__
)

369 
	#PLATFORM_ID
 "RISCos"

	)

371 #ñi‡
deföed
(
__söix
Ë|| deföed(
__söix__
Ë|| deföed(
__SINIX__
)

372 
	#PLATFORM_ID
 "SINIX"

	)

374 #ñi‡
deföed
(
__UNIX_SV__
)

375 
	#PLATFORM_ID
 "UNIX_SV"

	)

377 #ñi‡
deföed
(
__bsdos__
)

378 
	#PLATFORM_ID
 "BSDOS"

	)

380 #ñi‡
deföed
(
_MPRAS
Ë|| deföed(
MPRAS
)

381 
	#PLATFORM_ID
 "MP-RAS"

	)

383 #ñi‡
deföed
(
__osf
Ë|| deföed(
__osf__
)

384 
	#PLATFORM_ID
 "OSF1"

	)

386 #ñi‡
deföed
(
_SCO_SV
Ë|| deföed(
SCO_SV
Ë|| deföed(
sco_sv
)

387 
	#PLATFORM_ID
 "SCO_SV"

	)

389 #ñi‡
deföed
(
__u…rix
Ë|| deföed(
__u…rix__
Ë|| deföed(
_ULTRIX
)

390 
	#PLATFORM_ID
 "ULTRIX"

	)

392 #ñi‡
deföed
(
__XENIX__
Ë|| deföed(
_XENIX
Ë|| deföed(
XENIX
)

393 
	#PLATFORM_ID
 "Xíix"

	)

395 #ñi‡
deföed
(
__WATCOMC__
)

396 #i‡
deföed
(
__LINUX__
)

397 
	#PLATFORM_ID
 "Löux"

	)

399 #ñi‡
deföed
(
__DOS__
)

400 
	#PLATFORM_ID
 "DOS"

	)

402 #ñi‡
deföed
(
__OS2__
)

403 
	#PLATFORM_ID
 "OS2"

	)

405 #ñi‡
deföed
(
__WINDOWS__
)

406 
	#PLATFORM_ID
 "Wödows3x"

	)

408 #ñi‡
deföed
(
__VXWORKS__
)

409 
	#PLATFORM_ID
 "VxW‹ks"

	)

412 
	#PLATFORM_ID


	)

415 #ñi‡
deföed
(
__INTEGRITY
)

416 #i‡
deföed
(
INT_178B
)

417 
	#PLATFORM_ID
 "I¡egrôy178"

	)

420 
	#PLATFORM_ID
 "I¡egrôy"

	)

424 
	#PLATFORM_ID


	)

433 #i‡
deföed
(
_WIN32
Ë&& deföed(
_MSC_VER
)

434 #i‡
deföed
(
_M_IA64
)

435 
	#ARCHITECTURE_ID
 "IA64"

	)

437 #ñi‡
deföed
(
_M_X64
Ë|| deföed(
_M_AMD64
)

438 
	#ARCHITECTURE_ID
 "x64"

	)

440 #ñi‡
deföed
(
_M_IX86
)

441 
	#ARCHITECTURE_ID
 "X86"

	)

443 #ñi‡
deföed
(
_M_ARM64
)

444 
	#ARCHITECTURE_ID
 "ARM64"

	)

446 #ñi‡
deföed
(
_M_ARM
)

447 #i‡
_M_ARM
 == 4

448 
	#ARCHITECTURE_ID
 "ARMV4I"

	)

449 #ñi‡
_M_ARM
 == 5

450 
	#ARCHITECTURE_ID
 "ARMV5I"

	)

452 
	#ARCHITECTURE_ID
 "ARMV" 
	`STRINGIFY
(
_M_ARM
)

	)

455 #ñi‡
deföed
(
_M_MIPS
)

456 
	#ARCHITECTURE_ID
 "MIPS"

	)

458 #ñi‡
deföed
(
_M_SH
)

459 
	#ARCHITECTURE_ID
 "SHx"

	)

462 
	#ARCHITECTURE_ID
 ""

	)

465 #ñi‡
deföed
(
__WATCOMC__
)

466 #i‡
deföed
(
_M_I86
)

467 
	#ARCHITECTURE_ID
 "I86"

	)

469 #ñi‡
deföed
(
_M_IX86
)

470 
	#ARCHITECTURE_ID
 "X86"

	)

473 
	#ARCHITECTURE_ID
 ""

	)

476 #ñi‡
deföed
(
__IAR_SYSTEMS_ICC__
Ë|| deföed(
__IAR_SYSTEMS_ICC
)

477 #i‡
deföed
(
__ICCARM__
)

478 
	#ARCHITECTURE_ID
 "ARM"

	)

480 #ñi‡
deföed
(
__ICCRX__
)

481 
	#ARCHITECTURE_ID
 "RX"

	)

483 #ñi‡
deföed
(
__ICCRH850__
)

484 
	#ARCHITECTURE_ID
 "RH850"

	)

486 #ñi‡
deföed
(
__ICCRL78__
)

487 
	#ARCHITECTURE_ID
 "RL78"

	)

489 #ñi‡
deföed
(
__ICCRISCV__
)

490 
	#ARCHITECTURE_ID
 "RISCV"

	)

492 #ñi‡
deföed
(
__ICCAVR__
)

493 
	#ARCHITECTURE_ID
 "AVR"

	)

495 #ñi‡
deföed
(
__ICC430__
)

496 
	#ARCHITECTURE_ID
 "MSP430"

	)

498 #ñi‡
deföed
(
__ICCV850__
)

499 
	#ARCHITECTURE_ID
 "V850"

	)

501 #ñi‡
deföed
(
__ICC8051__
)

502 
	#ARCHITECTURE_ID
 "8051"

	)

505 
	#ARCHITECTURE_ID
 ""

	)

508 #ñi‡
deföed
(
__ghs__
)

509 #i‡
deföed
(
__PPC64__
)

510 
	#ARCHITECTURE_ID
 "PPC64"

	)

512 #ñi‡
deföed
(
__µc__
)

513 
	#ARCHITECTURE_ID
 "PPC"

	)

515 #ñi‡
deföed
(
__ARM__
)

516 
	#ARCHITECTURE_ID
 "ARM"

	)

518 #ñi‡
deföed
(
__x86_64__
)

519 
	#ARCHITECTURE_ID
 "x64"

	)

521 #ñi‡
deföed
(
__i386__
)

522 
	#ARCHITECTURE_ID
 "X86"

	)

525 
	#ARCHITECTURE_ID
 ""

	)

528 
	#ARCHITECTURE_ID


	)

532 
	#DEC
(
n
) \

533 ('0' + (((
n
) / 10000000)%10)), \

534 ('0' + (((
n
) / 1000000)%10)), \

535 ('0' + (((
n
) / 100000)%10)), \

536 ('0' + (((
n
) / 10000)%10)), \

537 ('0' + (((
n
) / 1000)%10)), \

538 ('0' + (((
n
) / 100)%10)), \

539 ('0' + (((
n
) / 10)%10)), \

540 ('0' + ((
n
Ë% 10))

	)

543 
	#HEX
(
n
) \

544 ('0' + ((
n
)>>28 & 0xF)), \

545 ('0' + ((
n
)>>24 & 0xF)), \

546 ('0' + ((
n
)>>20 & 0xF)), \

547 ('0' + ((
n
)>>16 & 0xF)), \

548 ('0' + ((
n
)>>12 & 0xF)), \

549 ('0' + ((
n
)>>8 & 0xF)), \

550 ('0' + ((
n
)>>4 & 0xF)), \

551 ('0' + ((
n
Ë& 0xF))

	)

554 #ifde‡
COMPILER_VERSION_MAJOR


555 c⁄° 
	göfo_vîsi⁄
[] = {

558 
COMPILER_VERSION_MAJOR
,

559 #ifde‡
COMPILER_VERSION_MINOR


560 '.', 
COMPILER_VERSION_MINOR
,

561 #ifde‡
COMPILER_VERSION_PATCH


562 '.', 
COMPILER_VERSION_PATCH
,

563 #ifde‡
COMPILER_VERSION_TWEAK


564 '.', 
COMPILER_VERSION_TWEAK
,

572 #ifde‡
COMPILER_VERSION_INTERNAL


573 c⁄° 
	göfo_vîsi⁄_öã∫Æ
[] = {

577 
COMPILER_VERSION_INTERNAL
,']','\0'};

581 #ifde‡
SIMULATE_VERSION_MAJOR


582 c⁄° 
	göfo_simuœã_vîsi⁄
[] = {

585 
SIMULATE_VERSION_MAJOR
,

586 #ifde‡
SIMULATE_VERSION_MINOR


587 '.', 
SIMULATE_VERSION_MINOR
,

588 #ifde‡
SIMULATE_VERSION_PATCH


589 '.', 
SIMULATE_VERSION_PATCH
,

590 #ifde‡
SIMULATE_VERSION_TWEAK


591 '.', 
SIMULATE_VERSION_TWEAK
,

602 c⁄°* 
	göfo_∂©f‹m
 = "INFO" ":" "∂©f‹m[" 
PLATFORM_ID
 "]";

603 c⁄°* 
	göfo_¨ch
 = "INFO" ":" "¨ch[" 
ARCHITECTURE_ID
 "]";

608 #i‡
deföed
(
__INTEL_COMPILER
Ë&& deföed(
_MSVC_LANG
) && _MSVC_LANG < 201403L

609 #i‡
deföed
(
__INTEL_CXX11_MODE__
)

610 #i‡
deföed
(
__˝p_aggªg©e_nsdmi
)

611 
	#CXX_STD
 201402L

	)

613 
	#CXX_STD
 201103L

	)

616 
	#CXX_STD
 199711L

	)

618 #ñi‡
deföed
(
_MSC_VER
Ë&& deföed(
_MSVC_LANG
)

619 
	#CXX_STD
 
_MSVC_LANG


	)

621 
	#CXX_STD
 
__˝lu•lus


	)

624 c⁄° * 
	göfo_œnguage_düÀ˘_deÁu…
 = "INFO" ":" "dialect_default["

625 #i‡
CXX_STD
 > 201703L

627 #ñi‡
CXX_STD
 >= 201703L

629 #ñi‡
CXX_STD
 >= 201402L

631 #ñi‡
CXX_STD
 >= 201103L

640 
	$maö
(
¨gc
, * 
¨gv
[])

642 
ªquúe
 = 0;

643 
ªquúe
 +
öfo_compûî
[
¨gc
];

644 
ªquúe
 +
öfo_∂©f‹m
[
¨gc
];

645 #ifde‡
COMPILER_VERSION_MAJOR


646 
ªquúe
 +
öfo_vîsi⁄
[
¨gc
];

648 #ifde‡
COMPILER_VERSION_INTERNAL


649 
ªquúe
 +
öfo_vîsi⁄_öã∫Æ
[
¨gc
];

651 #ifde‡
SIMULATE_ID


652 
ªquúe
 +
öfo_simuœã
[
¨gc
];

654 #ifde‡
SIMULATE_VERSION_MAJOR


655 
ªquúe
 +
öfo_simuœã_vîsi⁄
[
¨gc
];

657 #i‡
	`deföed
(
__CRAYXE
Ë|| deföed(
__CRAYXC
)

658 
ªquúe
 +
öfo_¸ay
[
¨gc
];

660 
ªquúe
 +
öfo_œnguage_düÀ˘_deÁu…
[
¨gc
];

661 ()
¨gv
;

662  
ªquúe
;

663 
	}
}

	@kcp/ikcp.c

12 
	~"ik˝.h
"

14 
	~<°ddef.h
>

15 
	~<°dlib.h
>

16 
	~<°rög.h
>

17 
	~<°d¨g.h
>

18 
	~<°dio.h
>

25 c⁄° 
IUINT32
 
	gIKCP_RTO_NDL
 = 30;

26 c⁄° 
IUINT32
 
	gIKCP_RTO_MIN
 = 100;

27 c⁄° 
IUINT32
 
	gIKCP_RTO_DEF
 = 200;

28 c⁄° 
IUINT32
 
	gIKCP_RTO_MAX
 = 60000;

29 c⁄° 
IUINT32
 
	gIKCP_CMD_PUSH
 = 81;

30 c⁄° 
IUINT32
 
	gIKCP_CMD_ACK
 = 82;

31 c⁄° 
IUINT32
 
	gIKCP_CMD_WASK
 = 83;

32 c⁄° 
IUINT32
 
	gIKCP_CMD_WINS
 = 84;

33 c⁄° 
IUINT32
 
	gIKCP_ASK_SEND
 = 1;

34 c⁄° 
IUINT32
 
	gIKCP_ASK_TELL
 = 2;

35 c⁄° 
IUINT32
 
	gIKCP_WND_SND
 = 32;

36 c⁄° 
IUINT32
 
	gIKCP_WND_RCV
 = 128;

37 c⁄° 
IUINT32
 
	gIKCP_MTU_DEF
 = 1400;

38 c⁄° 
IUINT32
 
	gIKCP_ACK_FAST
 = 3;

39 c⁄° 
IUINT32
 
	gIKCP_INTERVAL
 = 100;

40 c⁄° 
IUINT32
 
	gIKCP_OVERHEAD
 = 24;

41 c⁄° 
IUINT32
 
	gIKCP_DEADLINK
 = 20;

42 c⁄° 
IUINT32
 
	gIKCP_THRESH_INIT
 = 2;

43 c⁄° 
IUINT32
 
	gIKCP_THRESH_MIN
 = 2;

44 c⁄° 
IUINT32
 
	gIKCP_PROBE_INIT
 = 7000;

45 c⁄° 
IUINT32
 
	gIKCP_PROBE_LIMIT
 = 120000;

46 c⁄° 
IUINT32
 
	gIKCP_FASTACK_LIMIT
 = 5;

54 
ölöe
 *
	$ik˝_ícode8u
(*
p
, 
c
)

56 *(*)
p
++ = 
c
;

57  
p
;

58 
	}
}

61 
ölöe
 c⁄° *
	$ik˝_decode8u
(c⁄° *
p
, *
c
)

63 *
c
 = *(*)
p
++;

64  
p
;

65 
	}
}

68 
ölöe
 *
	$ik˝_ícode16u
(*
p
, 
w
)

70 #i‡
IWORDS_BIG_ENDIAN
 || 
IWORDS_MUST_ALIGN


71 *(*)(
p
 + 0Ë(
w
 & 255);

72 *(*)(
p
 + 1Ë(
w
 >> 8);

74 
	`mem˝y
(
p
, &
w
, 2);

76 
p
 += 2;

77  
p
;

78 
	}
}

81 
ölöe
 c⁄° *
	$ik˝_decode16u
(c⁄° *
p
, *
w
)

83 #i‡
IWORDS_BIG_ENDIAN
 || 
IWORDS_MUST_ALIGN


84 *
w
 = *(c⁄° *)(
p
 + 1);

85 *
w
 = *(c⁄° *)(
p
 + 0) + (*w << 8);

87 
	`mem˝y
(
w
, 
p
, 2);

89 
p
 += 2;

90  
p
;

91 
	}
}

94 
ölöe
 *
	$ik˝_ícode32u
(*
p
, 
IUINT32
 
l
)

96 #i‡
IWORDS_BIG_ENDIAN
 || 
IWORDS_MUST_ALIGN


97 *(*)(
p
 + 0Ë()((
l
 >> 0) & 0xff);

98 *(*)(
p
 + 1Ë()((
l
 >> 8) & 0xff);

99 *(*)(
p
 + 2Ë()((
l
 >> 16) & 0xff);

100 *(*)(
p
 + 3Ë()((
l
 >> 24) & 0xff);

102 
	`mem˝y
(
p
, &
l
, 4);

104 
p
 += 4;

105  
p
;

106 
	}
}

109 
ölöe
 c⁄° *
	$ik˝_decode32u
(c⁄° *
p
, 
IUINT32
 *
l
)

111 #i‡
IWORDS_BIG_ENDIAN
 || 
IWORDS_MUST_ALIGN


112 *
l
 = *(c⁄° *)(
p
 + 3);

113 *
l
 = *(c⁄° *)(
p
 + 2) + (*l << 8);

114 *
l
 = *(c⁄° *)(
p
 + 1) + (*l << 8);

115 *
l
 = *(c⁄° *)(
p
 + 0) + (*l << 8);

117 
	`mem˝y
(
l
, 
p
, 4);

119 
p
 += 4;

120  
p
;

121 
	}
}

123 
ölöe
 
IUINT32
 
	$_imö_
(
IUINT32
 
a
, IUINT32 
b
) {

124  
a
 <
b
 ?á : b;

125 
	}
}

127 
ölöe
 
IUINT32
 
	$_imax_
(
IUINT32
 
a
, IUINT32 
b
) {

128  
a
 >
b
 ?á : b;

129 
	}
}

131 
ölöe
 
IUINT32
 
	$_ibound_
(
IUINT32
 
lowî
, IUINT32 
middÀ
, IUINT32 
uµî
)

133  
	`_imö_
(
	`_imax_
(
lowî
, 
middÀ
), 
uµî
);

134 
	}
}

136 
ölöe
 
	$_ôimediff
(
IUINT32
 
œãr
, IUINT32 
óæõr
)

138  ((
IINT32
)(
œãr
 - 
óæõr
));

139 
	}
}

144 
IKCPSEG
 
	tIKCPSEG
;

146 * (*
	gik˝_mÆloc_hook
)(
	gsize_t
Ë
NULL
;

147 (*
ik˝_‰ì_hook
)(*Ë
NULL
;

150 * 
	$ik˝_mÆloc
(
size_t
 
size
) {

151 i‡(
ik˝_mÆloc_hook
)

152  
	`ik˝_mÆloc_hook
(
size
);

153  
	`mÆloc
(
size
);

154 
	}
}

157 
	$ik˝_‰ì
(*
±r
) {

158 i‡(
ik˝_‰ì_hook
) {

159 
	`ik˝_‰ì_hook
(
±r
);

161 
	`‰ì
(
±r
);

163 
	}
}

166 
	$ik˝_Æloˇt‹
(* (*
√w_mÆloc
)(
size_t
), (*
√w_‰ì
)(*))

168 
ik˝_mÆloc_hook
 = 
√w_mÆloc
;

169 
ik˝_‰ì_hook
 = 
√w_‰ì
;

170 
	}
}

173 
IKCPSEG
* 
	$ik˝_£gmít_√w
(
ik˝cb
 *
k˝
, 
size
)

175  (
IKCPSEG
*)
	`ik˝_mÆloc
((IKCPSEGË+ 
size
);

176 
	}
}

179 
	$ik˝_£gmít_dñëe
(
ik˝cb
 *
k˝
, 
IKCPSEG
 *
£g
)

181 
	`ik˝_‰ì
(
£g
);

182 
	}
}

185 
	$ik˝_log
(
ik˝cb
 *
k˝
, 
mask
, c⁄° *
fmt
, ...)

187 
buf„r
[1024];

188 
va_li°
 
¨g±r
;

189 i‡((
mask
 & 
k˝
->
logmask
Ë=0 || k˝->
wrôñog
 == 0) ;

190 
	`va_°¨t
(
¨g±r
, 
fmt
);

191 
	`v•rötf
(
buf„r
, 
fmt
, 
¨g±r
);

192 
	`va_íd
(
¨g±r
);

193 
k˝
->
	`wrôñog
(
buf„r
, k˝, k˝->
u£r
);

194 
	}
}

197 
	$ik˝_ˇ∆og
(c⁄° 
ik˝cb
 *
k˝
, 
mask
)

199 i‡((
mask
 & 
k˝
->
logmask
Ë=0 || k˝->
wrôñog
 =
NULL
)  0;

201 
	}
}

204 
	$ik˝_ouçut
(
ik˝cb
 *
k˝
, c⁄° *
d©a
, 
size
)

206 
	`as£π
(
k˝
);

207 
	`as£π
(
k˝
->
ouçut
);

208 i‡(
	`ik˝_ˇ∆og
(
k˝
, 
IKCP_LOG_OUTPUT
)) {

209 
	`ik˝_log
(
k˝
, 
IKCP_LOG_OUTPUT
, "[RO] %ld byãs", ()
size
);

211 i‡(
size
 == 0)  0;

212  
k˝
->
	`ouçut
((c⁄° *)
d©a
, 
size
, k˝, k˝->
u£r
);

213 
	}
}

216 
	$ik˝_q¥öt
(c⁄° *
«me
, c⁄° 
IQUEUEHEAD
 *
hód
)

219 c⁄° 
IQUEUEHEAD
 *
p
;

220 
	`¥ötf
("<%s>: [", 
«me
);

221 
p
 = 
hód
->
√xt
;Ö != head;Ö =Ö->next) {

222 c⁄° 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
p
, c⁄° IKCPSEG, 
node
);

223 
	`¥ötf
("(%lu %d)", ()
£g
->
¢
, ()(£g->
ts
 % 10000));

224 i‡(
p
->
√xt
 !
hód
Ë
	`¥ötf
(",");

226 
	`¥ötf
("]\n");

228 
	}
}

234 
ik˝cb
* 
	$ik˝_¸óã
(
IUINT32
 
c⁄v
, *
u£r
)

236 
ik˝cb
 *
k˝
 = (ik˝cb*)
	`ik˝_mÆloc
((
IKCPCB
));

237 i‡(
k˝
 =
NULL
)  NULL;

238 
k˝
->
c⁄v
 = conv;

239 
k˝
->
u£r
 = user;

240 
k˝
->
¢d_u«
 = 0;

241 
k˝
->
¢d_nxt
 = 0;

242 
k˝
->
rcv_nxt
 = 0;

243 
k˝
->
ts_ª˚¡
 = 0;

244 
k˝
->
ts_œ°ack
 = 0;

245 
k˝
->
ts_¥obe
 = 0;

246 
k˝
->
¥obe_waô
 = 0;

247 
k˝
->
¢d_wnd
 = 
IKCP_WND_SND
;

248 
k˝
->
rcv_wnd
 = 
IKCP_WND_RCV
;

249 
k˝
->
rmt_wnd
 = 
IKCP_WND_RCV
;

250 
k˝
->
cwnd
 = 0;

251 
k˝
->
ö¸
 = 0;

252 
k˝
->
¥obe
 = 0;

253 
k˝
->
mtu
 = 
IKCP_MTU_DEF
;

254 
k˝
->
mss
 = k˝->
mtu
 - 
IKCP_OVERHEAD
;

255 
k˝
->
°ªam
 = 0;

257 
k˝
->
buf„r
 = (*)
	`ik˝_mÆloc
((k˝->
mtu
 + 
IKCP_OVERHEAD
) * 3);

258 i‡(
k˝
->
buf„r
 =
NULL
) {

259 
	`ik˝_‰ì
(
k˝
);

260  
NULL
;

263 
	`iqueue_öô
(&
k˝
->
¢d_queue
);

264 
	`iqueue_öô
(&
k˝
->
rcv_queue
);

265 
	`iqueue_öô
(&
k˝
->
¢d_buf
);

266 
	`iqueue_öô
(&
k˝
->
rcv_buf
);

267 
k˝
->
ƒcv_buf
 = 0;

268 
k˝
->
n¢d_buf
 = 0;

269 
k˝
->
ƒcv_que
 = 0;

270 
k˝
->
n¢d_que
 = 0;

271 
k˝
->
°©e
 = 0;

272 
k˝
->
ackli°
 = 
NULL
;

273 
k˝
->
ackblock
 = 0;

274 
k˝
->
ackcou¡
 = 0;

275 
k˝
->
rx_§â
 = 0;

276 
k˝
->
rx_πtvÆ
 = 0;

277 
k˝
->
rx_πo
 = 
IKCP_RTO_DEF
;

278 
k˝
->
rx_möπo
 = 
IKCP_RTO_MIN
;

279 
k˝
->
cuºít
 = 0;

280 
k˝
->
öãrvÆ
 = 
IKCP_INTERVAL
;

281 
k˝
->
ts_Êush
 = 
IKCP_INTERVAL
;

282 
k˝
->
nodñay
 = 0;

283 
k˝
->
upd©ed
 = 0;

284 
k˝
->
logmask
 = 0;

285 
k˝
->
s°hªsh
 = 
IKCP_THRESH_INIT
;

286 
k˝
->
Á°ª£nd
 = 0;

287 
k˝
->
Á°limô
 = 
IKCP_FASTACK_LIMIT
;

288 
k˝
->
nocwnd
 = 0;

289 
k˝
->
xmô
 = 0;

290 
k˝
->
dód_lök
 = 
IKCP_DEADLINK
;

291 
k˝
->
ouçut
 = 
NULL
;

292 
k˝
->
wrôñog
 = 
NULL
;

294  
k˝
;

295 
	}
}

301 
	$ik˝_ªÀa£
(
ik˝cb
 *
k˝
)

303 
	`as£π
(
k˝
);

304 i‡(
k˝
) {

305 
IKCPSEG
 *
£g
;

306 !
	`iqueue_is_em±y
(&
k˝
->
¢d_buf
)) {

307 
£g
 = 
	`iqueue_íåy
(
k˝
->
¢d_buf
.
√xt
, 
IKCPSEG
, 
node
);

308 
	`iqueue_dñ
(&
£g
->
node
);

309 
	`ik˝_£gmít_dñëe
(
k˝
, 
£g
);

311 !
	`iqueue_is_em±y
(&
k˝
->
rcv_buf
)) {

312 
£g
 = 
	`iqueue_íåy
(
k˝
->
rcv_buf
.
√xt
, 
IKCPSEG
, 
node
);

313 
	`iqueue_dñ
(&
£g
->
node
);

314 
	`ik˝_£gmít_dñëe
(
k˝
, 
£g
);

316 !
	`iqueue_is_em±y
(&
k˝
->
¢d_queue
)) {

317 
£g
 = 
	`iqueue_íåy
(
k˝
->
¢d_queue
.
√xt
, 
IKCPSEG
, 
node
);

318 
	`iqueue_dñ
(&
£g
->
node
);

319 
	`ik˝_£gmít_dñëe
(
k˝
, 
£g
);

321 !
	`iqueue_is_em±y
(&
k˝
->
rcv_queue
)) {

322 
£g
 = 
	`iqueue_íåy
(
k˝
->
rcv_queue
.
√xt
, 
IKCPSEG
, 
node
);

323 
	`iqueue_dñ
(&
£g
->
node
);

324 
	`ik˝_£gmít_dñëe
(
k˝
, 
£g
);

326 i‡(
k˝
->
buf„r
) {

327 
	`ik˝_‰ì
(
k˝
->
buf„r
);

329 i‡(
k˝
->
ackli°
) {

330 
	`ik˝_‰ì
(
k˝
->
ackli°
);

333 
k˝
->
ƒcv_buf
 = 0;

334 
k˝
->
n¢d_buf
 = 0;

335 
k˝
->
ƒcv_que
 = 0;

336 
k˝
->
n¢d_que
 = 0;

337 
k˝
->
ackcou¡
 = 0;

338 
k˝
->
buf„r
 = 
NULL
;

339 
k˝
->
ackli°
 = 
NULL
;

340 
	`ik˝_‰ì
(
k˝
);

342 
	}
}

348 
	$ik˝_£touçut
(
ik˝cb
 *
k˝
, (*
ouçut
)(c⁄° *
buf
, 
Àn
,

349 
ik˝cb
 *
k˝
, *
u£r
))

351 
k˝
->
ouçut
 = output;

352 
	}
}

358 
	$ik˝_ªcv
(
ik˝cb
 *
k˝
, *
buf„r
, 
Àn
)

360 
IQUEUEHEAD
 *
p
;

361 
i•ìk
 = (
Àn
 < 0)? 1 : 0;

362 
≥eksize
;

363 
ªcovî
 = 0;

364 
IKCPSEG
 *
£g
;

365 
	`as£π
(
k˝
);

367 i‡(
	`iqueue_is_em±y
(&
k˝
->
rcv_queue
))

370 i‡(
Àn
 < 0)Üen = -len;

372 
≥eksize
 = 
	`ik˝_≥eksize
(
k˝
);

374 i‡(
≥eksize
 < 0)

377 i‡(
≥eksize
 > 
Àn
)

380 i‡(
k˝
->
ƒcv_que
 >k˝->
rcv_wnd
)

381 
ªcovî
 = 1;

384 
Àn
 = 0, 
p
 = 
k˝
->
rcv_queue
.
√xt
;Ö != &kcp->rcv_queue; ) {

385 
‰agmít
;

386 
£g
 = 
	`iqueue_íåy
(
p
, 
IKCPSEG
, 
node
);

387 
p
 =Ö->
√xt
;

389 i‡(
buf„r
) {

390 
	`mem˝y
(
buf„r
, 
£g
->
d©a
, seg->
Àn
);

391 
buf„r
 +
£g
->
Àn
;

394 
Àn
 +
£g
->len;

395 
‰agmít
 = 
£g
->
‰g
;

397 i‡(
	`ik˝_ˇ∆og
(
k˝
, 
IKCP_LOG_RECV
)) {

398 
	`ik˝_log
(
k˝
, 
IKCP_LOG_RECV
, "ªcv sn=%lu", ()
£g
->
¢
);

401 i‡(
i•ìk
 == 0) {

402 
	`iqueue_dñ
(&
£g
->
node
);

403 
	`ik˝_£gmít_dñëe
(
k˝
, 
£g
);

404 
k˝
->
ƒcv_que
--;

407 i‡(
‰agmít
 == 0)

411 
	`as£π
(
Àn
 =
≥eksize
);

414 ! 
	`iqueue_is_em±y
(&
k˝
->
rcv_buf
)) {

415 
£g
 = 
	`iqueue_íåy
(
k˝
->
rcv_buf
.
√xt
, 
IKCPSEG
, 
node
);

416 i‡(
£g
->
¢
 =
k˝
->
rcv_nxt
 && k˝->
ƒcv_que
 < k˝->
rcv_wnd
) {

417 
	`iqueue_dñ
(&
£g
->
node
);

418 
k˝
->
ƒcv_buf
--;

419 
	`iqueue_add_èû
(&
£g
->
node
, &
k˝
->
rcv_queue
);

420 
k˝
->
ƒcv_que
++;

421 
k˝
->
rcv_nxt
++;

428 i‡(
k˝
->
ƒcv_que
 < k˝->
rcv_wnd
 && 
ªcovî
) {

431 
k˝
->
¥obe
 |
IKCP_ASK_TELL
;

434  
Àn
;

435 
	}
}

441 
	$ik˝_≥eksize
(c⁄° 
ik˝cb
 *
k˝
)

443 
IQUEUEHEAD
 *
p
;

444 
IKCPSEG
 *
£g
;

445 
Àngth
 = 0;

447 
	`as£π
(
k˝
);

449 i‡(
	`iqueue_is_em±y
(&
k˝
->
rcv_queue
))  -1;

451 
£g
 = 
	`iqueue_íåy
(
k˝
->
rcv_queue
.
√xt
, 
IKCPSEG
, 
node
);

452 i‡(
£g
->
‰g
 =0Ë seg->
Àn
;

454 i‡(
k˝
->
ƒcv_que
 < 
£g
->
‰g
 + 1)  -1;

456 
p
 = 
k˝
->
rcv_queue
.
√xt
;Ö != &kcp->rcv_queue;Ö =Ö->next) {

457 
£g
 = 
	`iqueue_íåy
(
p
, 
IKCPSEG
, 
node
);

458 
Àngth
 +
£g
->
Àn
;

459 i‡(
£g
->
‰g
 == 0) ;

462  
Àngth
;

463 
	}
}

469 
	$ik˝_£nd
(
ik˝cb
 *
k˝
, c⁄° *
buf„r
, 
Àn
)

471 
IKCPSEG
 *
£g
;

472 
cou¡
, 
i
;

474 
	`as£π
(
k˝
->
mss
 > 0);

475 i‡(
Àn
 < 0)  -1;

478 i‡(
k˝
->
°ªam
 != 0) {

479 i‡(!
	`iqueue_is_em±y
(&
k˝
->
¢d_queue
)) {

480 
IKCPSEG
 *
ﬁd
 = 
	`iqueue_íåy
(
k˝
->
¢d_queue
.
¥ev
, IKCPSEG, 
node
);

481 i‡(
ﬁd
->
Àn
 < 
k˝
->
mss
) {

482 
ˇ∑côy
 = 
k˝
->
mss
 - 
ﬁd
->
Àn
;

483 
exãnd
 = (
Àn
 < 
ˇ∑côy
)?Üen : capacity;

484 
£g
 = 
	`ik˝_£gmít_√w
(
k˝
, 
ﬁd
->
Àn
 + 
exãnd
);

485 
	`as£π
(
£g
);

486 i‡(
£g
 =
NULL
) {

489 
	`iqueue_add_èû
(&
£g
->
node
, &
k˝
->
¢d_queue
);

490 
	`mem˝y
(
£g
->
d©a
, 
ﬁd
->d©a, old->
Àn
);

491 i‡(
buf„r
) {

492 
	`mem˝y
(
£g
->
d©a
 + 
ﬁd
->
Àn
, 
buf„r
, 
exãnd
);

493 
buf„r
 +
exãnd
;

495 
£g
->
Àn
 = 
ﬁd
->À¿+ 
exãnd
;

496 
£g
->
‰g
 = 0;

497 
Àn
 -
exãnd
;

498 
	`iqueue_dñ_öô
(&
ﬁd
->
node
);

499 
	`ik˝_£gmít_dñëe
(
k˝
, 
ﬁd
);

502 i‡(
Àn
 <= 0) {

507 i‡(
Àn
 <()
k˝
->
mss
Ë
cou¡
 = 1;

508 
cou¡
 = (
Àn
 + 
k˝
->
mss
 - 1) / kcp->mss;

510 i‡(
cou¡
 >()
IKCP_WND_RCV
)  -2;

512 i‡(
cou¡
 == 0) count = 1;

515 
i
 = 0; i < 
cou¡
; i++) {

516 
size
 = 
Àn
 > ()
k˝
->
mss
 ? ()kcp->mss :Üen;

517 
£g
 = 
	`ik˝_£gmít_√w
(
k˝
, 
size
);

518 
	`as£π
(
£g
);

519 i‡(
£g
 =
NULL
) {

522 i‡(
buf„r
 && 
Àn
 > 0) {

523 
	`mem˝y
(
£g
->
d©a
, 
buf„r
, 
size
);

525 
£g
->
Àn
 = 
size
;

526 
£g
->
‰g
 = (
k˝
->
°ªam
 =0)? (
cou¡
 - 
i
 - 1) : 0;

527 
	`iqueue_öô
(&
£g
->
node
);

528 
	`iqueue_add_èû
(&
£g
->
node
, &
k˝
->
¢d_queue
);

529 
k˝
->
n¢d_que
++;

530 i‡(
buf„r
) {

531 
buf„r
 +
size
;

533 
Àn
 -
size
;

537 
	}
}

543 
	$ik˝_upd©e_ack
(
ik˝cb
 *
k˝
, 
IINT32
 
πt
)

545 
IINT32
 
πo
 = 0;

546 i‡(
k˝
->
rx_§â
 == 0) {

547 
k˝
->
rx_§â
 = 
πt
;

548 
k˝
->
rx_πtvÆ
 = 
πt
 / 2;

550 
dñè
 = 
πt
 - 
k˝
->
rx_§â
;

551 i‡(
dñè
 < 0) delta = -delta;

552 
k˝
->
rx_πtvÆ
 = (3 * k˝->rx_πtvÆ + 
dñè
) / 4;

553 
k˝
->
rx_§â
 = (7 * k˝->rx_§â + 
πt
) / 8;

554 i‡(
k˝
->
rx_§â
 < 1) kcp->rx_srtt = 1;

556 
πo
 = 
k˝
->
rx_§â
 + 
	`_imax_
(k˝->
öãrvÆ
, 4 * k˝->
rx_πtvÆ
);

557 
k˝
->
rx_πo
 = 
	`_ibound_
(k˝->
rx_möπo
, 
πo
, 
IKCP_RTO_MAX
);

558 
	}
}

560 
	$ik˝_shrök_buf
(
ik˝cb
 *
k˝
)

562 
IQUEUEHEAD
 *
p
 = 
k˝
->
¢d_buf
.
√xt
;

563 i‡(
p
 !&
k˝
->
¢d_buf
) {

564 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
p
, IKCPSEG, 
node
);

565 
k˝
->
¢d_u«
 = 
£g
->
¢
;

567 
k˝
->
¢d_u«
 = k˝->
¢d_nxt
;

569 
	}
}

571 
	$ik˝_∑r£_ack
(
ik˝cb
 *
k˝
, 
IUINT32
 
¢
)

573 
IQUEUEHEAD
 *
p
, *
√xt
;

575 i‡(
	`_ôimediff
(
¢
, 
k˝
->
¢d_u«
Ë< 0 || _ôimediff(¢, k˝->
¢d_nxt
) >= 0)

578 
p
 = 
k˝
->
¢d_buf
.
√xt
;Ö != &kcp->snd_buf;Ö =Çext) {

579 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
p
, IKCPSEG, 
node
);

580 
√xt
 = 
p
->next;

581 i‡(
¢
 =
£g
->sn) {

582 
	`iqueue_dñ
(
p
);

583 
	`ik˝_£gmít_dñëe
(
k˝
, 
£g
);

584 
k˝
->
n¢d_buf
--;

587 i‡(
	`_ôimediff
(
¢
, 
£g
->sn) < 0) {

591 
	}
}

593 
	$ik˝_∑r£_u«
(
ik˝cb
 *
k˝
, 
IUINT32
 
u«
)

595 
IQUEUEHEAD
 *
p
, *
√xt
;

596 
p
 = 
k˝
->
¢d_buf
.
√xt
;Ö != &kcp->snd_buf;Ö =Çext) {

597 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
p
, IKCPSEG, 
node
);

598 
√xt
 = 
p
->next;

599 i‡(
	`_ôimediff
(
u«
, 
£g
->
¢
) > 0) {

600 
	`iqueue_dñ
(
p
);

601 
	`ik˝_£gmít_dñëe
(
k˝
, 
£g
);

602 
k˝
->
n¢d_buf
--;

607 
	}
}

609 
	$ik˝_∑r£_Á°ack
(
ik˝cb
 *
k˝
, 
IUINT32
 
¢
, IUINT32 
ts
)

611 
IQUEUEHEAD
 *
p
, *
√xt
;

613 i‡(
	`_ôimediff
(
¢
, 
k˝
->
¢d_u«
Ë< 0 || _ôimediff(¢, k˝->
¢d_nxt
) >= 0)

616 
p
 = 
k˝
->
¢d_buf
.
√xt
;Ö != &kcp->snd_buf;Ö =Çext) {

617 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
p
, IKCPSEG, 
node
);

618 
√xt
 = 
p
->next;

619 i‡(
	`_ôimediff
(
¢
, 
£g
->sn) < 0) {

622 i‡(
¢
 !
£g
->sn) {

623 #i‚de‡
IKCP_FASTACK_CONSERVE


624 
£g
->
Á°ack
++;

626 i‡(
	`_ôimediff
(
ts
, 
£g
->ts) >= 0)

627 
£g
->
Á°ack
++;

631 
	}
}

637 
	$ik˝_ack_push
(
ik˝cb
 *
k˝
, 
IUINT32
 
¢
, IUINT32 
ts
)

639 
IUINT32
 
√wsize
 = 
k˝
->
ackcou¡
 + 1;

640 
IUINT32
 *
±r
;

642 i‡(
√wsize
 > 
k˝
->
ackblock
) {

643 
IUINT32
 *
ackli°
;

644 
IUINT32
 
√wblock
;

646 
√wblock
 = 8;Çewblock < 
√wsize
;Çewblock <<= 1);

647 
ackli°
 = (
IUINT32
*)
	`ik˝_mÆloc
(
√wblock
 * (IUINT32) * 2);

649 i‡(
ackli°
 =
NULL
) {

650 
	`as£π
(
ackli°
 !
NULL
);

651 
	`ab‹t
();

654 i‡(
k˝
->
ackli°
 !
NULL
) {

655 
IUINT32
 
x
;

656 
x
 = 0; x < 
k˝
->
ackcou¡
; x++) {

657 
ackli°
[
x
 * 2 + 0] = 
k˝
->acklist[x * 2 + 0];

658 
ackli°
[
x
 * 2 + 1] = 
k˝
->acklist[x * 2 + 1];

660 
	`ik˝_‰ì
(
k˝
->
ackli°
);

663 
k˝
->
ackli°
 =ácklist;

664 
k˝
->
ackblock
 = 
√wblock
;

667 
±r
 = &
k˝
->
ackli°
[k˝->
ackcou¡
 * 2];

668 
±r
[0] = 
¢
;

669 
±r
[1] = 
ts
;

670 
k˝
->
ackcou¡
++;

671 
	}
}

673 
	$ik˝_ack_gë
(c⁄° 
ik˝cb
 *
k˝
, 
p
, 
IUINT32
 *
¢
, IUINT32 *
ts
)

675 i‡(
¢
Ë¢[0] = 
k˝
->
ackli°
[
p
 * 2 + 0];

676 i‡(
ts
Ëts[0] = 
k˝
->
ackli°
[
p
 * 2 + 1];

677 
	}
}

683 
	$ik˝_∑r£_d©a
(
ik˝cb
 *
k˝
, 
IKCPSEG
 *
√w£g
)

685 
IQUEUEHEAD
 *
p
, *
¥ev
;

686 
IUINT32
 
¢
 = 
√w£g
->sn;

687 
ª≥©
 = 0;

689 i‡(
	`_ôimediff
(
¢
, 
k˝
->
rcv_nxt
 + k˝->
rcv_wnd
) >= 0 ||

690 
	`_ôimediff
(
¢
, 
k˝
->
rcv_nxt
) < 0) {

691 
	`ik˝_£gmít_dñëe
(
k˝
, 
√w£g
);

695 
p
 = 
k˝
->
rcv_buf
.
¥ev
;Ö != &kcp->rcv_buf;Ö =Örev) {

696 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
p
, IKCPSEG, 
node
);

697 
¥ev
 = 
p
->prev;

698 i‡(
£g
->
¢
 == sn) {

699 
ª≥©
 = 1;

702 i‡(
	`_ôimediff
(
¢
, 
£g
->sn) > 0) {

707 i‡(
ª≥©
 == 0) {

708 
	`iqueue_öô
(&
√w£g
->
node
);

709 
	`iqueue_add
(&
√w£g
->
node
, 
p
);

710 
k˝
->
ƒcv_buf
++;

712 
	`ik˝_£gmít_dñëe
(
k˝
, 
√w£g
);

716 
	`ik˝_q¥öt
("rcvbuf", &
k˝
->
rcv_buf
);

717 
	`¥ötf
("rcv_nxt=%lu\n", 
k˝
->
rcv_nxt
);

721 ! 
	`iqueue_is_em±y
(&
k˝
->
rcv_buf
)) {

722 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
k˝
->
rcv_buf
.
√xt
, IKCPSEG, 
node
);

723 i‡(
£g
->
¢
 =
k˝
->
rcv_nxt
 && k˝->
ƒcv_que
 < k˝->
rcv_wnd
) {

724 
	`iqueue_dñ
(&
£g
->
node
);

725 
k˝
->
ƒcv_buf
--;

726 
	`iqueue_add_èû
(&
£g
->
node
, &
k˝
->
rcv_queue
);

727 
k˝
->
ƒcv_que
++;

728 
k˝
->
rcv_nxt
++;

735 
	`ik˝_q¥öt
("queue", &
k˝
->
rcv_queue
);

736 
	`¥ötf
("rcv_nxt=%lu\n", 
k˝
->
rcv_nxt
);

743 
	}
}

749 
	$ik˝_öput
(
ik˝cb
 *
k˝
, c⁄° *
d©a
, 
size
)

751 
IUINT32
 
¥ev_u«
 = 
k˝
->
¢d_u«
;

752 
IUINT32
 
maxack
 = 0, 
œã°_ts
 = 0;

753 
Êag
 = 0;

755 i‡(
	`ik˝_ˇ∆og
(
k˝
, 
IKCP_LOG_INPUT
)) {

756 
	`ik˝_log
(
k˝
, 
IKCP_LOG_INPUT
, "[RI] %d byãs", ()
size
);

759 i‡(
d©a
 =
NULL
 || ()
size
 < ()
IKCP_OVERHEAD
)  -1;

762 
IUINT32
 
ts
, 
¢
, 
Àn
, 
u«
, 
c⁄v
;

763 
IUINT16
 
wnd
;

764 
IUINT8
 
cmd
, 
‰g
;

765 
IKCPSEG
 *
£g
;

767 i‡(
size
 < ()
IKCP_OVERHEAD
) ;

769 
d©a
 = 
	`ik˝_decode32u
(d©a, &
c⁄v
);

770 i‡(
c⁄v
 !
k˝
->conv)  -1;

772 
d©a
 = 
	`ik˝_decode8u
(d©a, &
cmd
);

773 
d©a
 = 
	`ik˝_decode8u
(d©a, &
‰g
);

774 
d©a
 = 
	`ik˝_decode16u
(d©a, &
wnd
);

775 
d©a
 = 
	`ik˝_decode32u
(d©a, &
ts
);

776 
d©a
 = 
	`ik˝_decode32u
(d©a, &
¢
);

777 
d©a
 = 
	`ik˝_decode32u
(d©a, &
u«
);

778 
d©a
 = 
	`ik˝_decode32u
(d©a, &
Àn
);

780 
size
 -
IKCP_OVERHEAD
;

782 i‡(()
size
 < ()
Àn
 || ()len < 0)  -2;

784 i‡(
cmd
 !
IKCP_CMD_PUSH
 && cmd !
IKCP_CMD_ACK
 &&

785 
cmd
 !
IKCP_CMD_WASK
 && cmd !
IKCP_CMD_WINS
)

788 
k˝
->
rmt_wnd
 = 
wnd
;

789 
	`ik˝_∑r£_u«
(
k˝
, 
u«
);

790 
	`ik˝_shrök_buf
(
k˝
);

792 i‡(
cmd
 =
IKCP_CMD_ACK
) {

793 i‡(
	`_ôimediff
(
k˝
->
cuºít
, 
ts
) >= 0) {

794 
	`ik˝_upd©e_ack
(
k˝
, 
	`_ôimediff
(k˝->
cuºít
, 
ts
));

796 
	`ik˝_∑r£_ack
(
k˝
, 
¢
);

797 
	`ik˝_shrök_buf
(
k˝
);

798 i‡(
Êag
 == 0) {

799 
Êag
 = 1;

800 
maxack
 = 
¢
;

801 
œã°_ts
 = 
ts
;

803 i‡(
	`_ôimediff
(
¢
, 
maxack
) > 0) {

804 #i‚de‡
IKCP_FASTACK_CONSERVE


805 
maxack
 = 
¢
;

806 
œã°_ts
 = 
ts
;

808 i‡(
	`_ôimediff
(
ts
, 
œã°_ts
) > 0) {

809 
maxack
 = 
¢
;

810 
œã°_ts
 = 
ts
;

815 i‡(
	`ik˝_ˇ∆og
(
k˝
, 
IKCP_LOG_IN_ACK
)) {

816 
	`ik˝_log
(
k˝
, 
IKCP_LOG_IN_ACK
,

817 "öpuàack: sn=%luÑâ=%ldÑto=%ld", ()
¢
,

818 ()
	`_ôimediff
(
k˝
->
cuºít
, 
ts
),

819 ()
k˝
->
rx_πo
);

822 i‡(
cmd
 =
IKCP_CMD_PUSH
) {

823 i‡(
	`ik˝_ˇ∆og
(
k˝
, 
IKCP_LOG_IN_DATA
)) {

824 
	`ik˝_log
(
k˝
, 
IKCP_LOG_IN_DATA
,

825 "öpuàpsh: sn=%luÅs=%lu", ()
¢
, ()
ts
);

827 i‡(
	`_ôimediff
(
¢
, 
k˝
->
rcv_nxt
 + k˝->
rcv_wnd
) < 0) {

828 
	`ik˝_ack_push
(
k˝
, 
¢
, 
ts
);

829 i‡(
	`_ôimediff
(
¢
, 
k˝
->
rcv_nxt
) >= 0) {

830 
£g
 = 
	`ik˝_£gmít_√w
(
k˝
, 
Àn
);

831 
£g
->
c⁄v
 = conv;

832 
£g
->
cmd
 = cmd;

833 
£g
->
‰g
 = frg;

834 
£g
->
wnd
 = wnd;

835 
£g
->
ts
 =Ås;

836 
£g
->
¢
 = sn;

837 
£g
->
u«
 = una;

838 
£g
->
Àn
 =Üen;

840 i‡(
Àn
 > 0) {

841 
	`mem˝y
(
£g
->
d©a
, d©a, 
Àn
);

844 
	`ik˝_∑r£_d©a
(
k˝
, 
£g
);

848 i‡(
cmd
 =
IKCP_CMD_WASK
) {

851 
k˝
->
¥obe
 |
IKCP_ASK_TELL
;

852 i‡(
	`ik˝_ˇ∆og
(
k˝
, 
IKCP_LOG_IN_PROBE
)) {

853 
	`ik˝_log
(
k˝
, 
IKCP_LOG_IN_PROBE
, "inputÖrobe");

856 i‡(
cmd
 =
IKCP_CMD_WINS
) {

858 i‡(
	`ik˝_ˇ∆og
(
k˝
, 
IKCP_LOG_IN_WINS
)) {

859 
	`ik˝_log
(
k˝
, 
IKCP_LOG_IN_WINS
,

860 "öpuàwös: %lu", ()(
wnd
));

867 
d©a
 +
Àn
;

868 
size
 -
Àn
;

871 i‡(
Êag
 != 0) {

872 
	`ik˝_∑r£_Á°ack
(
k˝
, 
maxack
, 
œã°_ts
);

875 i‡(
	`_ôimediff
(
k˝
->
¢d_u«
, 
¥ev_u«
) > 0) {

876 i‡(
k˝
->
cwnd
 < k˝->
rmt_wnd
) {

877 
IUINT32
 
mss
 = 
k˝
->mss;

878 i‡(
k˝
->
cwnd
 < k˝->
s°hªsh
) {

879 
k˝
->
cwnd
++;

880 
k˝
->
ö¸
 +
mss
;

882 i‡(
k˝
->
ö¸
 < 
mss
) kcp->incr = mss;

883 
k˝
->
ö¸
 +(
mss
 * mss) / kcp->incr + (mss / 16);

884 i‡((
k˝
->
cwnd
 + 1Ë* 
mss
 <k˝->
ö¸
) {

886 
k˝
->
cwnd
 = (k˝->
ö¸
 + 
mss
 - 1) / ((mss > 0)? mss : 1);

888 
k˝
->
cwnd
++;

892 i‡(
k˝
->
cwnd
 > k˝->
rmt_wnd
) {

893 
k˝
->
cwnd
 = k˝->
rmt_wnd
;

894 
k˝
->
ö¸
 = k˝->
rmt_wnd
 * 
mss
;

900 
	}
}

906 *
	$ik˝_ícode_£g
(*
±r
, c⁄° 
IKCPSEG
 *
£g
)

908 
±r
 = 
	`ik˝_ícode32u
’å, 
£g
->
c⁄v
);

909 
±r
 = 
	`ik˝_ícode8u
’å, (
IUINT8
)
£g
->
cmd
);

910 
±r
 = 
	`ik˝_ícode8u
’å, (
IUINT8
)
£g
->
‰g
);

911 
±r
 = 
	`ik˝_ícode16u
’å, (
IUINT16
)
£g
->
wnd
);

912 
±r
 = 
	`ik˝_ícode32u
’å, 
£g
->
ts
);

913 
±r
 = 
	`ik˝_ícode32u
’å, 
£g
->
¢
);

914 
±r
 = 
	`ik˝_ícode32u
’å, 
£g
->
u«
);

915 
±r
 = 
	`ik˝_ícode32u
’å, 
£g
->
Àn
);

916  
±r
;

917 
	}
}

919 
	$ik˝_wnd_unu£d
(c⁄° 
ik˝cb
 *
k˝
)

921 i‡(
k˝
->
ƒcv_que
 < k˝->
rcv_wnd
) {

922  
k˝
->
rcv_wnd
 - k˝->
ƒcv_que
;

925 
	}
}

931 
	$ik˝_Êush
(
ik˝cb
 *
k˝
)

933 
IUINT32
 
cuºít
 = 
k˝
->current;

934 *
buf„r
 = 
k˝
->buffer;

935 *
±r
 = 
buf„r
;

936 
cou¡
, 
size
, 
i
;

937 
IUINT32
 
ª£¡
, 
cwnd
;

938 
IUINT32
 
πomö
;

939 
IQUEUEHEAD
 *
p
;

940 
ch™ge
 = 0;

941 
lo°
 = 0;

942 
IKCPSEG
 
£g
;

945 i‡(
k˝
->
upd©ed
 == 0) ;

947 
£g
.
c⁄v
 = 
k˝
->conv;

948 
£g
.
cmd
 = 
IKCP_CMD_ACK
;

949 
£g
.
‰g
 = 0;

950 
£g
.
wnd
 = 
	`ik˝_wnd_unu£d
(
k˝
);

951 
£g
.
u«
 = 
k˝
->
rcv_nxt
;

952 
£g
.
Àn
 = 0;

953 
£g
.
¢
 = 0;

954 
£g
.
ts
 = 0;

957 
cou¡
 = 
k˝
->
ackcou¡
;

958 
i
 = 0; i < 
cou¡
; i++) {

959 
size
 = ()(
±r
 - 
buf„r
);

960 i‡(
size
 + ()
IKCP_OVERHEAD
 > ()
k˝
->
mtu
) {

961 
	`ik˝_ouçut
(
k˝
, 
buf„r
, 
size
);

962 
±r
 = 
buf„r
;

964 
	`ik˝_ack_gë
(
k˝
, 
i
, &
£g
.
¢
, &£g.
ts
);

965 
±r
 = 
	`ik˝_ícode_£g
’å, &
£g
);

968 
k˝
->
ackcou¡
 = 0;

971 i‡(
k˝
->
rmt_wnd
 == 0) {

972 i‡(
k˝
->
¥obe_waô
 == 0) {

973 
k˝
->
¥obe_waô
 = 
IKCP_PROBE_INIT
;

974 
k˝
->
ts_¥obe
 = k˝->
cuºít
 + k˝->
¥obe_waô
;

977 i‡(
	`_ôimediff
(
k˝
->
cuºít
, k˝->
ts_¥obe
) >= 0) {

978 i‡(
k˝
->
¥obe_waô
 < 
IKCP_PROBE_INIT
)

979 
k˝
->
¥obe_waô
 = 
IKCP_PROBE_INIT
;

980 
k˝
->
¥obe_waô
 += kcp->probe_wait / 2;

981 i‡(
k˝
->
¥obe_waô
 > 
IKCP_PROBE_LIMIT
)

982 
k˝
->
¥obe_waô
 = 
IKCP_PROBE_LIMIT
;

983 
k˝
->
ts_¥obe
 = k˝->
cuºít
 + k˝->
¥obe_waô
;

984 
k˝
->
¥obe
 |
IKCP_ASK_SEND
;

988 
k˝
->
ts_¥obe
 = 0;

989 
k˝
->
¥obe_waô
 = 0;

993 i‡(
k˝
->
¥obe
 & 
IKCP_ASK_SEND
) {

994 
£g
.
cmd
 = 
IKCP_CMD_WASK
;

995 
size
 = ()(
±r
 - 
buf„r
);

996 i‡(
size
 + ()
IKCP_OVERHEAD
 > ()
k˝
->
mtu
) {

997 
	`ik˝_ouçut
(
k˝
, 
buf„r
, 
size
);

998 
±r
 = 
buf„r
;

1000 
±r
 = 
	`ik˝_ícode_£g
’å, &
£g
);

1004 i‡(
k˝
->
¥obe
 & 
IKCP_ASK_TELL
) {

1005 
£g
.
cmd
 = 
IKCP_CMD_WINS
;

1006 
size
 = ()(
±r
 - 
buf„r
);

1007 i‡(
size
 + ()
IKCP_OVERHEAD
 > ()
k˝
->
mtu
) {

1008 
	`ik˝_ouçut
(
k˝
, 
buf„r
, 
size
);

1009 
±r
 = 
buf„r
;

1011 
±r
 = 
	`ik˝_ícode_£g
’å, &
£g
);

1014 
k˝
->
¥obe
 = 0;

1017 
cwnd
 = 
	`_imö_
(
k˝
->
¢d_wnd
, k˝->
rmt_wnd
);

1018 i‡(
k˝
->
nocwnd
 =0Ë
cwnd
 = 
	`_imö_
(kcp->cwnd, cwnd);

1021 
	`_ôimediff
(
k˝
->
¢d_nxt
, k˝->
¢d_u«
 + 
cwnd
) < 0) {

1022 
IKCPSEG
 *
√w£g
;

1023 i‡(
	`iqueue_is_em±y
(&
k˝
->
¢d_queue
)) ;

1025 
√w£g
 = 
	`iqueue_íåy
(
k˝
->
¢d_queue
.
√xt
, 
IKCPSEG
, 
node
);

1027 
	`iqueue_dñ
(&
√w£g
->
node
);

1028 
	`iqueue_add_èû
(&
√w£g
->
node
, &
k˝
->
¢d_buf
);

1029 
k˝
->
n¢d_que
--;

1030 
k˝
->
n¢d_buf
++;

1032 
√w£g
->
c⁄v
 = 
k˝
->conv;

1033 
√w£g
->
cmd
 = 
IKCP_CMD_PUSH
;

1034 
√w£g
->
wnd
 = 
£g
.wnd;

1035 
√w£g
->
ts
 = 
cuºít
;

1036 
√w£g
->
¢
 = 
k˝
->
¢d_nxt
++;

1037 
√w£g
->
u«
 = 
k˝
->
rcv_nxt
;

1038 
√w£g
->
ª£ndts
 = 
cuºít
;

1039 
√w£g
->
πo
 = 
k˝
->
rx_πo
;

1040 
√w£g
->
Á°ack
 = 0;

1041 
√w£g
->
xmô
 = 0;

1045 
ª£¡
 = (
k˝
->
Á°ª£nd
 > 0)? (
IUINT32
)kcp->fastresend : 0xffffffff;

1046 
πomö
 = (
k˝
->
nodñay
 =0)? (k˝->
rx_πo
 >> 3) : 0;

1049 
p
 = 
k˝
->
¢d_buf
.
√xt
;Ö != &kcp->snd_buf;Ö =Ö->next) {

1050 
IKCPSEG
 *
£gmít
 = 
	`iqueue_íåy
(
p
, IKCPSEG, 
node
);

1051 
√ed£nd
 = 0;

1052 i‡(
£gmít
->
xmô
 == 0) {

1053 
√ed£nd
 = 1;

1054 
£gmít
->
xmô
++;

1055 
£gmít
->
πo
 = 
k˝
->
rx_πo
;

1056 
£gmít
->
ª£ndts
 = 
cuºít
 + segmít->
πo
 + 
πomö
;

1058 i‡(
	`_ôimediff
(
cuºít
, 
£gmít
->
ª£ndts
) >= 0) {

1059 
√ed£nd
 = 1;

1060 
£gmít
->
xmô
++;

1061 
k˝
->
xmô
++;

1062 i‡(
k˝
->
nodñay
 == 0) {

1063 
£gmít
->
πo
 +
	`_imax_
(£gmít->πo, (
IUINT32
)
k˝
->
rx_πo
);

1065 
IINT32
 
°ï
 = (
k˝
->
nodñay
 < 2)?

1066 ((
IINT32
)(
£gmít
->
πo
)Ë: 
k˝
->
rx_πo
;

1067 
£gmít
->
πo
 +
°ï
 / 2;

1069 
£gmít
->
ª£ndts
 = 
cuºít
 + segmít->
πo
;

1070 
lo°
 = 1;

1072 i‡(
£gmít
->
Á°ack
 >
ª£¡
) {

1073 i‡(()
£gmít
->
xmô
 <
k˝
->
Á°limô
 ||

1074 
k˝
->
Á°limô
 <= 0) {

1075 
√ed£nd
 = 1;

1076 
£gmít
->
xmô
++;

1077 
£gmít
->
Á°ack
 = 0;

1078 
£gmít
->
ª£ndts
 = 
cuºít
 + segmít->
πo
;

1079 
ch™ge
++;

1083 i‡(
√ed£nd
) {

1084 
√ed
;

1085 
£gmít
->
ts
 = 
cuºít
;

1086 
£gmít
->
wnd
 = 
£g
.wnd;

1087 
£gmít
->
u«
 = 
k˝
->
rcv_nxt
;

1089 
size
 = ()(
±r
 - 
buf„r
);

1090 
√ed
 = 
IKCP_OVERHEAD
 + 
£gmít
->
Àn
;

1092 i‡(
size
 + 
√ed
 > ()
k˝
->
mtu
) {

1093 
	`ik˝_ouçut
(
k˝
, 
buf„r
, 
size
);

1094 
±r
 = 
buf„r
;

1097 
±r
 = 
	`ik˝_ícode_£g
’å, 
£gmít
);

1099 i‡(
£gmít
->
Àn
 > 0) {

1100 
	`mem˝y
(
±r
, 
£gmít
->
d©a
, segmít->
Àn
);

1101 
±r
 +
£gmít
->
Àn
;

1104 i‡(
£gmít
->
xmô
 >
k˝
->
dód_lök
) {

1105 
k˝
->
°©e
 = (
IUINT32
)-1;

1111 
size
 = ()(
±r
 - 
buf„r
);

1112 i‡(
size
 > 0) {

1113 
	`ik˝_ouçut
(
k˝
, 
buf„r
, 
size
);

1117 i‡(
ch™ge
) {

1118 
IUINT32
 
öÊight
 = 
k˝
->
¢d_nxt
 - k˝->
¢d_u«
;

1119 
k˝
->
s°hªsh
 = 
öÊight
 / 2;

1120 i‡(
k˝
->
s°hªsh
 < 
IKCP_THRESH_MIN
)

1121 
k˝
->
s°hªsh
 = 
IKCP_THRESH_MIN
;

1122 
k˝
->
cwnd
 = k˝->
s°hªsh
 + 
ª£¡
;

1123 
k˝
->
ö¸
 = k˝->
cwnd
 * k˝->
mss
;

1126 i‡(
lo°
) {

1127 
k˝
->
s°hªsh
 = 
cwnd
 / 2;

1128 i‡(
k˝
->
s°hªsh
 < 
IKCP_THRESH_MIN
)

1129 
k˝
->
s°hªsh
 = 
IKCP_THRESH_MIN
;

1130 
k˝
->
cwnd
 = 1;

1131 
k˝
->
ö¸
 = k˝->
mss
;

1134 i‡(
k˝
->
cwnd
 < 1) {

1135 
k˝
->
cwnd
 = 1;

1136 
k˝
->
ö¸
 = k˝->
mss
;

1138 
	}
}

1146 
	$ik˝_upd©e
(
ik˝cb
 *
k˝
, 
IUINT32
 
cuºít
)

1148 
IINT32
 
¶≠
;

1150 
k˝
->
cuºít
 = current;

1152 i‡(
k˝
->
upd©ed
 == 0) {

1153 
k˝
->
upd©ed
 = 1;

1154 
k˝
->
ts_Êush
 = k˝->
cuºít
;

1157 
¶≠
 = 
	`_ôimediff
(
k˝
->
cuºít
, k˝->
ts_Êush
);

1159 i‡(
¶≠
 >= 10000 || slap < -10000) {

1160 
k˝
->
ts_Êush
 = k˝->
cuºít
;

1161 
¶≠
 = 0;

1164 i‡(
¶≠
 >= 0) {

1165 
k˝
->
ts_Êush
 +k˝->
öãrvÆ
;

1166 i‡(
	`_ôimediff
(
k˝
->
cuºít
, k˝->
ts_Êush
) >= 0) {

1167 
k˝
->
ts_Êush
 = k˝->
cuºít
 + k˝->
öãrvÆ
;

1169 
	`ik˝_Êush
(
k˝
);

1171 
	}
}

1183 
IUINT32
 
	$ik˝_check
(c⁄° 
ik˝cb
 *
k˝
, 
IUINT32
 
cuºít
)

1185 
IUINT32
 
ts_Êush
 = 
k˝
->ts_flush;

1186 
IINT32
 
tm_Êush
 = 0x7fffffff;

1187 
IINT32
 
tm_∑ckë
 = 0x7fffffff;

1188 
IUINT32
 
möimÆ
 = 0;

1189 
IQUEUEHEAD
 *
p
;

1191 i‡(
k˝
->
upd©ed
 == 0) {

1192  
cuºít
;

1195 i‡(
	`_ôimediff
(
cuºít
, 
ts_Êush
) >= 10000 ||

1196 
	`_ôimediff
(
cuºít
, 
ts_Êush
) < -10000) {

1197 
ts_Êush
 = 
cuºít
;

1200 i‡(
	`_ôimediff
(
cuºít
, 
ts_Êush
) >= 0) {

1201  
cuºít
;

1204 
tm_Êush
 = 
	`_ôimediff
(
ts_Êush
, 
cuºít
);

1206 
p
 = 
k˝
->
¢d_buf
.
√xt
;Ö != &kcp->snd_buf;Ö =Ö->next) {

1207 c⁄° 
IKCPSEG
 *
£g
 = 
	`iqueue_íåy
(
p
, c⁄° IKCPSEG, 
node
);

1208 
IINT32
 
diff
 = 
	`_ôimediff
(
£g
->
ª£ndts
, 
cuºít
);

1209 i‡(
diff
 <= 0) {

1210  
cuºít
;

1212 i‡(
diff
 < 
tm_∑ckë
)Åm_packet = diff;

1215 
möimÆ
 = (
IUINT32
)(
tm_∑ckë
 < 
tm_Êush
 ?Åm_packet :Åm_flush);

1216 i‡(
möimÆ
 >
k˝
->
öãrvÆ
) minimal = kcp->interval;

1218  
cuºít
 + 
möimÆ
;

1219 
	}
}

1223 
	$ik˝_£tmtu
(
ik˝cb
 *
k˝
, 
mtu
)

1225 *
buf„r
;

1226 i‡(
mtu
 < 50 || mtu < ()
IKCP_OVERHEAD
)

1228 
buf„r
 = (*)
	`ik˝_mÆloc
((
mtu
 + 
IKCP_OVERHEAD
) * 3);

1229 i‡(
buf„r
 =
NULL
)

1231 
k˝
->
mtu
 = mtu;

1232 
k˝
->
mss
 = k˝->
mtu
 - 
IKCP_OVERHEAD
;

1233 
	`ik˝_‰ì
(
k˝
->
buf„r
);

1234 
k˝
->
buf„r
 = buffer;

1236 
	}
}

1238 
	$ik˝_öãrvÆ
(
ik˝cb
 *
k˝
, 
öãrvÆ
)

1240 i‡(
öãrvÆ
 > 5000) interval = 5000;

1241 i‡(
öãrvÆ
 < 10) interval = 10;

1242 
k˝
->
öãrvÆ
 = interval;

1244 
	}
}

1246 
	$ik˝_nodñay
(
ik˝cb
 *
k˝
, 
nodñay
, 
öãrvÆ
, 
ª£nd
, 
nc
)

1248 i‡(
nodñay
 >= 0) {

1249 
k˝
->
nodñay
 =Çodelay;

1250 i‡(
nodñay
) {

1251 
k˝
->
rx_möπo
 = 
IKCP_RTO_NDL
;

1254 
k˝
->
rx_möπo
 = 
IKCP_RTO_MIN
;

1257 i‡(
öãrvÆ
 >= 0) {

1258 i‡(
öãrvÆ
 > 5000) interval = 5000;

1259 i‡(
öãrvÆ
 < 10) interval = 10;

1260 
k˝
->
öãrvÆ
 = interval;

1262 i‡(
ª£nd
 >= 0) {

1263 
k˝
->
Á°ª£nd
 = 
ª£nd
;

1265 i‡(
nc
 >= 0) {

1266 
k˝
->
nocwnd
 = 
nc
;

1269 
	}
}

1272 
	$ik˝_wndsize
(
ik˝cb
 *
k˝
, 
¢dwnd
, 
rcvwnd
)

1274 i‡(
k˝
) {

1275 i‡(
¢dwnd
 > 0) {

1276 
k˝
->
¢d_wnd
 = 
¢dwnd
;

1278 i‡(
rcvwnd
 > 0) {

1279 
k˝
->
rcv_wnd
 = 
	`_imax_
(
rcvwnd
, 
IKCP_WND_RCV
);

1283 
	}
}

1285 
	$ik˝_waô¢d
(c⁄° 
ik˝cb
 *
k˝
)

1287  
k˝
->
n¢d_buf
 + k˝->
n¢d_que
;

1288 
	}
}

1292 
IUINT32
 
	$ik˝_gëc⁄v
(c⁄° *
±r
)

1294 
IUINT32
 
c⁄v
;

1295 
	`ik˝_decode32u
((c⁄° *)
±r
, &
c⁄v
);

1296  
c⁄v
;

1297 
	}
}

	@kcp/ikcp.h

12 #i‚de‡
__IKCP_H__


13 
	#__IKCP_H__


	)

15 
	~<°ddef.h
>

16 
	~<°dlib.h
>

17 
	~<as£π.h
>

23 #i‚de‡
__INTEGER_32_BITS__


24 
	#__INTEGER_32_BITS__


	)

25 #i‡
deföed
(
_WIN64
Ë|| deföed(
WIN64
Ë|| deföed(
__amd64__
) || \

26 
deföed
(
__x86_64
Ë|| deföed(
__x86_64__
Ë|| deföed(
_M_IA64
) || \

27 
	$deföed
(
_M_AMD64
)

28 
	tISTDUINT32
;

29 
	tISTDINT32
;

30 #ñi‡
	`deföed
(
_WIN32
Ë|| deföed(
WIN32
Ë|| deföed(
__i386__
) || \

31 
	`deföed
(
__i386
Ë|| 
	$deföed
(
_M_X86
)

32 
	tISTDUINT32
;

33 
	tISTDINT32
;

34 #ñi‡
	`deföed
(
__MACOS__
)

35 
UI¡32
 
	tISTDUINT32
;

36 
SI¡32
 
	tISTDINT32
;

37 #ñi‡
	`deföed
(
__APPLE__
Ë&& deföed(
__MACH__
)

38 
	~<sys/ty≥s.h
>

39 
u_öt32_t
 
	tISTDUINT32
;

40 
öt32_t
 
	tISTDINT32
;

41 #ñi‡
	`deföed
(
__BEOS__
)

42 
	~<sys/öây≥s.h
>

43 
u_öt32_t
 
	tISTDUINT32
;

44 
öt32_t
 
	tISTDINT32
;

45 #ñi‡(
	`deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
)Ë&& (!deföed(
__MSDOS__
))

46 
	t__öt32
 
	tISTDUINT32
;

47 
__öt32
 
	tISTDINT32
;

48 #ñi‡
	`deföed
(
__GNUC__
)

49 
	~<°döt.h
>

50 
uöt32_t
 
	tISTDUINT32
;

51 
öt32_t
 
	tISTDINT32
;

53 
	tISTDUINT32
;

54 
	tISTDINT32
;

62 #i‚de‡
__IINT8_DEFINED


63 
	#__IINT8_DEFINED


	)

64 
	tIINT8
;

67 #i‚de‡
__IUINT8_DEFINED


68 
	#__IUINT8_DEFINED


	)

69 
	tIUINT8
;

72 #i‚de‡
__IUINT16_DEFINED


73 
	#__IUINT16_DEFINED


	)

74 
	tIUINT16
;

77 #i‚de‡
__IINT16_DEFINED


78 
	#__IINT16_DEFINED


	)

79 
	tIINT16
;

82 #i‚de‡
__IINT32_DEFINED


83 
	#__IINT32_DEFINED


	)

84 
ISTDINT32
 
	tIINT32
;

87 #i‚de‡
__IUINT32_DEFINED


88 
	#__IUINT32_DEFINED


	)

89 
ISTDUINT32
 
	tIUINT32
;

92 #i‚de‡
__IINT64_DEFINED


93 
	#__IINT64_DEFINED


	)

94 #i‡
	`deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
)

95 
__öt64
 
	tIINT64
;

97 
	tIINT64
;

101 #i‚de‡
__IUINT64_DEFINED


102 
	#__IUINT64_DEFINED


	)

103 #i‡
	`deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
)

104 
	t__öt64
 
	tIUINT64
;

106 
	tIUINT64
;

110 #i‚de‡
INLINE


111 #i‡
	`deföed
(
__GNUC__
)

113 #i‡(
__GNUC__
 > 3Ë|| ((__GNUC__ =3Ë&& (
__GNUC_MINOR__
 >= 1))

114 
	#INLINE
 
__ölöe__
 
	`__©åibuã__
((
Æways_ölöe
))

	)

116 
	#INLINE
 
__ölöe__


	)

119 #ñi‡(
	`deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
Ë|| deföed(
__WATCOMC__
))

120 
	#INLINE
 
__ölöe


	)

122 
	#INLINE


	)

126 #i‡(!
	`deföed
(
__˝lu•lus
)Ë&& (!deföed(
ölöe
))

127 
	#ölöe
 
INLINE


	)

134 #i‚de‡
__IQUEUE_DEF__


135 
	#__IQUEUE_DEF__


	)

137 
	sIQUEUEHEAD
 {

138 
IQUEUEHEAD
 *
√xt
, *
¥ev
;

141 
IQUEUEHEAD
 
	tiqueue_hód
;

147 
	#IQUEUE_HEAD_INIT
(
«me
Ë{ &“ame), &“ameË
	}

	)
}

148 
	#IQUEUE_HEAD
(
«me
Ë\

	)

149 
IQUEUEHEAD
 
	g«me
 = 
	$IQUEUE_HEAD_INIT
(
«me
)

151 
	#IQUEUE_INIT
(
±r
Ë–\

	)

152 (
±r
)->
√xt
 = (±r), (±r)->
¥ev
 = (ptr))

154 
	#IOFFSETOF
(
TYPE
, 
MEMBER
Ë((
size_t
Ë&((TYPE *)0)->MEMBER)

	)

156 
	#ICONTAINEROF
(
±r
, 
ty≥
, 
membî
Ë–\

	)

157 (
ty≥
*)–((*)(—y≥*)
±r
)Ë- 
	$IOFFSETOF
(
ty≥
, 
membî
)) )

159 
	#IQUEUE_ENTRY
(
±r
, 
ty≥
, 
membî
Ë
	`ICONTAINEROF
’å,Åy≥, membî)

	)

165 
	#IQUEUE_ADD
(
node
, 
hód
Ë–\

	)

166 (
node
)->
¥ev
 = (
hód
), (node)->
√xt
 = (head)->next, \

167 (
hód
)->
√xt
->
¥ev
 = (
node
), (head)->next = (node))

169 
	#IQUEUE_ADD_TAIL
(
node
, 
hód
Ë–\

	)

170 (
node
)->
¥ev
 = (
hód
)->¥ev, (node)->
√xt
 = (head), \

171 (
hód
)->
¥ev
->
√xt
 = (
node
), (head)->prev = (node))

173 
	#IQUEUE_DEL_BETWEEN
(
p
, 
n
Ë(“)->
¥ev
 = (p), (p)->
√xt
 = (n))

	)

175 
	#IQUEUE_DEL
(
íåy
Ë(\

	)

176 (
íåy
)->
√xt
->
¥ev
 = (entry)->prev, \

177 (
íåy
)->
¥ev
->
√xt
 = (entry)->next, \

178 (
íåy
)->
√xt
 = 0, (íåy)->
¥ev
 = 0)

180 
	#IQUEUE_DEL_INIT
(
íåy
Ëdÿ{ \

	)

181 
	`IQUEUE_DEL
(
íåy
); 
	`IQUEUE_INIT
”¡ry); 
	}
} 0)

183 
	#IQUEUE_IS_EMPTY
(
íåy
Ë(”¡ryË=”¡ry)->
√xt
)

	)

185 
	#iqueue_öô
 
IQUEUE_INIT


	)

186 
	#iqueue_íåy
 
IQUEUE_ENTRY


	)

187 
	#iqueue_add
 
IQUEUE_ADD


	)

188 
	#iqueue_add_èû
 
IQUEUE_ADD_TAIL


	)

189 
	#iqueue_dñ
 
IQUEUE_DEL


	)

190 
	#iqueue_dñ_öô
 
IQUEUE_DEL_INIT


	)

191 
	#iqueue_is_em±y
 
IQUEUE_IS_EMPTY


	)

193 
	#IQUEUE_FOREACH
(
ôî©‹
, 
hód
, 
TYPE
, 
MEMBER
Ë\

	)

194 (
ôî©‹
Ë
	`iqueue_íåy
((
hód
)->
√xt
, 
TYPE
, 
MEMBER
); \

195 &((
ôî©‹
)->
MEMBER
Ë!(
hód
); \

196 (
ôî©‹
Ë
	`iqueue_íåy
((ôî©‹)->
MEMBER
.
√xt
, 
TYPE
, MEMBER))

198 
	#iqueue_f‹óch
(
ôî©‹
, 
hód
, 
TYPE
, 
MEMBER
Ë\

	)

199 
	$IQUEUE_FOREACH
(
ôî©‹
, 
hód
, 
TYPE
, 
MEMBER
)

201 
	#iqueue_f‹óch_íåy
(
pos
, 
hód
Ë\

	)

202  (
pos
Ë(
hód
)->
√xt
; (pos) != (head) ; (pos) = (pos)->next )

205 
	#__iqueue_•li˚
(
li°
, 
hód
Ëdÿ{ \

	)

206 
iqueue_hód
 *
fú°
 = (
li°
)->
√xt
, *
œ°
 = (li°)->
¥ev
; \

207 
iqueue_hód
 *
©
 = (
hód
)->
√xt
; \

208 (
fú°
)->
¥ev
 = (
hód
), (hód)->
√xt
 = (first); \

209 (
œ°
)->
√xt
 = (
©
), (©)->
¥ev
 = (œ°); 
	}
} 0)

211 
	#iqueue_•li˚
(
li°
, 
hód
Ëdÿ{ \

	)

212 i‡(!
	`iqueue_is_em±y
(
li°
)Ë
	`__iqueue_•li˚
÷i°, 
hód
); 
	}
} 0)

214 
	#iqueue_•li˚_öô
(
li°
, 
hód
Ëdÿ{ \

	)

215 
	`iqueue_•li˚
(
li°
, 
hód
); 
	`iqueue_öô
÷i°); 
	}
} 0)

218 #ifde‡
_MSC_VER


219 #¥agm®
	`w¨nög
(
dißbÀ
:4311)

220 #¥agm®
	`w¨nög
(
dißbÀ
:4312)

221 #¥agm®
	`w¨nög
(
dißbÀ
:4996)

230 #i‚de‡
IWORDS_BIG_ENDIAN


231 #ifde‡
_BIG_ENDIAN_


232 #i‡
_BIG_ENDIAN_


233 
	#IWORDS_BIG_ENDIAN
 1

	)

236 #i‚de‡
IWORDS_BIG_ENDIAN


237 #i‡
	`deföed
(
__hµa__
) || \

238 
	`deföed
(
__m68k__
Ë|| deföed(
mc68000
Ë|| deföed(
_M_M68K
) || \

239 (
	`deföed
(
__MIPS__
Ë&& deföed(
__MIPSEB__
)) || \

240 
	`deföed
(
__µc__
Ë|| deföed(
__POWERPC__
Ë|| deföed(
_M_PPC
) || \

241 
	`deföed
(
__•¨c__
Ë|| deföed(
__powîpc__
) || \

242 
	`deföed
(
__mc68000__
Ë|| deföed(
__s390x__
Ë|| 
	$deföed
(
__s390__
)

243 
	#IWORDS_BIG_ENDIAN
 1

	)

246 #i‚de‡
IWORDS_BIG_ENDIAN


247 
	#IWORDS_BIG_ENDIAN
 0

	)

251 #i‚de‡
IWORDS_MUST_ALIGN


252 #i‡
	`deföed
(
__i386__
Ë|| deföed(
__i386
Ë|| deföed(
_i386_
)

253 
	#IWORDS_MUST_ALIGN
 0

	)

254 #ñi‡
	`deföed
(
_M_IX86
Ë|| deföed(
_X86_
Ë|| deföed(
__x86_64__
)

255 
	#IWORDS_MUST_ALIGN
 0

	)

256 #ñi‡
	`deföed
(
__amd64
Ë|| deföed(
__amd64__
)

257 
	#IWORDS_MUST_ALIGN
 0

	)

259 
	#IWORDS_MUST_ALIGN
 1

	)

267 
	sIKCPSEG


269 
IQUEUEHEAD
 
node
;

270 
IUINT32
 
c⁄v
;

271 
IUINT32
 
cmd
;

272 
IUINT32
 
‰g
;

273 
IUINT32
 
wnd
;

274 
IUINT32
 
ts
;

275 
IUINT32
 
¢
;

276 
IUINT32
 
u«
;

277 
IUINT32
 
Àn
;

278 
IUINT32
 
ª£ndts
;

279 
IUINT32
 
πo
;

280 
IUINT32
 
Á°ack
;

281 
IUINT32
 
xmô
;

282 
d©a
[1];

289 
	sIKCPCB


291 
IUINT32
 
c⁄v
, 
mtu
, 
mss
, 
°©e
;

292 
IUINT32
 
¢d_u«
, 
¢d_nxt
, 
rcv_nxt
;

293 
IUINT32
 
ts_ª˚¡
, 
ts_œ°ack
, 
s°hªsh
;

294 
IINT32
 
rx_πtvÆ
, 
rx_§â
, 
rx_πo
, 
rx_möπo
;

295 
IUINT32
 
¢d_wnd
, 
rcv_wnd
, 
rmt_wnd
, 
cwnd
, 
¥obe
;

296 
IUINT32
 
cuºít
, 
öãrvÆ
, 
ts_Êush
, 
xmô
;

297 
IUINT32
 
ƒcv_buf
, 
n¢d_buf
;

298 
IUINT32
 
ƒcv_que
, 
n¢d_que
;

299 
IUINT32
 
nodñay
, 
upd©ed
;

300 
IUINT32
 
ts_¥obe
, 
¥obe_waô
;

301 
IUINT32
 
dód_lök
, 
ö¸
;

302 
IQUEUEHEAD
 
¢d_queue
;

303 
IQUEUEHEAD
 
rcv_queue
;

304 
IQUEUEHEAD
 
¢d_buf
;

305 
IQUEUEHEAD
 
rcv_buf
;

306 
IUINT32
 *
ackli°
;

307 
IUINT32
 
ackcou¡
;

308 
IUINT32
 
ackblock
;

309 *
u£r
;

310 *
buf„r
;

311 
Á°ª£nd
;

312 
Á°limô
;

313 
nocwnd
, 
°ªam
;

314 
logmask
;

315 (*
ouçut
)(c⁄° *
buf
, 
Àn
, 
IKCPCB
 *
k˝
, *
u£r
);

316 (*
wrôñog
)(c⁄° *
log
, 
IKCPCB
 *
k˝
, *
u£r
);

320 
IKCPCB
 
	tik˝cb
;

322 
	#IKCP_LOG_OUTPUT
 1

	)

323 
	#IKCP_LOG_INPUT
 2

	)

324 
	#IKCP_LOG_SEND
 4

	)

325 
	#IKCP_LOG_RECV
 8

	)

326 
	#IKCP_LOG_IN_DATA
 16

	)

327 
	#IKCP_LOG_IN_ACK
 32

	)

328 
	#IKCP_LOG_IN_PROBE
 64

	)

329 
	#IKCP_LOG_IN_WINS
 128

	)

330 
	#IKCP_LOG_OUT_DATA
 256

	)

331 
	#IKCP_LOG_OUT_ACK
 512

	)

332 
	#IKCP_LOG_OUT_PROBE
 1024

	)

333 
	#IKCP_LOG_OUT_WINS
 2048

	)

335 #ifde‡
__˝lu•lus


346 
ik˝cb
* 
	`ik˝_¸óã
(
IUINT32
 
c⁄v
, *
u£r
);

349 
	`ik˝_ªÀa£
(
ik˝cb
 *
k˝
);

352 
	`ik˝_£touçut
(
ik˝cb
 *
k˝
, (*
ouçut
)(c⁄° *
buf
, 
Àn
,

353 
ik˝cb
 *
k˝
, *
u£r
));

356 
	`ik˝_ªcv
(
ik˝cb
 *
k˝
, *
buf„r
, 
Àn
);

359 
	`ik˝_£nd
(
ik˝cb
 *
k˝
, c⁄° *
buf„r
, 
Àn
);

364 
	`ik˝_upd©e
(
ik˝cb
 *
k˝
, 
IUINT32
 
cuºít
);

373 
IUINT32
 
	`ik˝_check
(c⁄° 
ik˝cb
 *
k˝
, IUINT32 
cuºít
);

376 
	`ik˝_öput
(
ik˝cb
 *
k˝
, c⁄° *
d©a
, 
size
);

379 
	`ik˝_Êush
(
ik˝cb
 *
k˝
);

382 
	`ik˝_≥eksize
(c⁄° 
ik˝cb
 *
k˝
);

385 
	`ik˝_£tmtu
(
ik˝cb
 *
k˝
, 
mtu
);

388 
	`ik˝_wndsize
(
ik˝cb
 *
k˝
, 
¢dwnd
, 
rcvwnd
);

391 
	`ik˝_waô¢d
(c⁄° 
ik˝cb
 *
k˝
);

398 
	`ik˝_nodñay
(
ik˝cb
 *
k˝
, 
nodñay
, 
öãrvÆ
, 
ª£nd
, 
nc
);

401 
	`ik˝_log
(
ik˝cb
 *
k˝
, 
mask
, c⁄° *
fmt
, ...);

404 
	`ik˝_Æloˇt‹
(* (*
√w_mÆloc
)(
size_t
), (*
√w_‰ì
)(*));

407 
IUINT32
 
	`ik˝_gëc⁄v
(c⁄° *
±r
);

410 #ifde‡
__˝lu•lus


411 
	}
}

	@kcp/test.cpp

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

13 
	~"ã°.h
"

14 
	~"ik˝.c
"

18 
L©ícySimuœt‹
 *
	gv√t
;

21 
	$udp_ouçut
(c⁄° *
buf
, 
Àn
, 
ik˝cb
 *
k˝
, *
u£r
)

23 uni⁄ { 
id
; *
±r
; } 
∑ømëî
;

24 
∑ømëî
.
±r
 = 
u£r
;

25 
v√t
->
	`£nd
(
∑ømëî
.
id
, 
buf
, 
Àn
);

27 
	}
}

30 
	$ã°
(
mode
)

33 
v√t
 = 
√w
 
	`L©ícySimuœt‹
(10, 60, 125);

37 
ik˝cb
 *
k˝1
 = 
	`ik˝_¸óã
(0x11223344, (*)0);

38 
ik˝cb
 *
k˝2
 = 
	`ik˝_¸óã
(0x11223344, (*)1);

41 
k˝1
->
ouçut
 = 
udp_ouçut
;

42 
k˝2
->
ouçut
 = 
udp_ouçut
;

44 
IUINT32
 
cuºít
 = 
	`i˛ock
();

45 
IUINT32
 
¶≠
 = 
cuºít
 + 20;

46 
IUINT32
 
ödex
 = 0;

47 
IUINT32
 
√xt
 = 0;

48 
IINT64
 
sumπt
 = 0;

49 
cou¡
 = 0;

50 
maxπt
 = 0;

54 
	`ik˝_wndsize
(
k˝1
, 128, 128);

55 
	`ik˝_wndsize
(
k˝2
, 128, 128);

58 i‡(
mode
 == 0) {

60 
	`ik˝_nodñay
(
k˝1
, 0, 10, 0, 0);

61 
	`ik˝_nodñay
(
k˝2
, 0, 10, 0, 0);

63 i‡(
mode
 == 1) {

65 
	`ik˝_nodñay
(
k˝1
, 0, 10, 0, 1);

66 
	`ik˝_nodñay
(
k˝2
, 0, 10, 0, 1);

73 
	`ik˝_nodñay
(
k˝1
, 2, 10, 2, 1);

74 
	`ik˝_nodñay
(
k˝2
, 2, 10, 2, 1);

75 
k˝1
->
rx_möπo
 = 10;

76 
k˝1
->
Á°ª£nd
 = 1;

80 
buf„r
[2000];

81 
hr
;

83 
IUINT32
 
ts1
 = 
	`i˛ock
();

86 
	`i¶ìp
(1);

87 
cuºít
 = 
	`i˛ock
();

88 
	`ik˝_upd©e
(
k˝1
, 
	`i˛ock
());

89 
	`ik˝_upd©e
(
k˝2
, 
	`i˛ock
());

92 ; 
cuºít
 >
¶≠
; slap += 20) {

93 ((
IUINT32
*)
buf„r
)[0] = 
ödex
++;

94 ((
IUINT32
*)
buf„r
)[1] = 
cuºít
;

97 
	`ik˝_£nd
(
k˝1
, 
buf„r
, 8);

102 
hr
 = 
v√t
->
	`ªcv
(1, 
buf„r
, 2000);

103 i‡(
hr
 < 0) ;

105 
	`ik˝_öput
(
k˝2
, 
buf„r
, 
hr
);

110 
hr
 = 
v√t
->
	`ªcv
(0, 
buf„r
, 2000);

111 i‡(
hr
 < 0) ;

113 
	`ik˝_öput
(
k˝1
, 
buf„r
, 
hr
);

118 
hr
 = 
	`ik˝_ªcv
(
k˝2
, 
buf„r
, 10);

120 i‡(
hr
 < 0) ;

122 
	`ik˝_£nd
(
k˝2
, 
buf„r
, 
hr
);

127 
hr
 = 
	`ik˝_ªcv
(
k˝1
, 
buf„r
, 10);

129 i‡(
hr
 < 0) ;

130 
IUINT32
 
¢
 = *(IUINT32*)(
buf„r
 + 0);

131 
IUINT32
 
ts
 = *(IUINT32*)(
buf„r
 + 4);

132 
IUINT32
 
πt
 = 
cuºít
 - 
ts
;

134 i‡(
¢
 !
√xt
) {

136 
	`¥ötf
("ERROR s¿%d<->%d\n", ()
cou¡
, ()
√xt
);

140 
√xt
++;

141 
sumπt
 +
πt
;

142 
cou¡
++;

143 i‡(
πt
 > (
IUINT32
)
maxπt
) maxrtt =Ñtt;

145 
	`¥ötf
("[RECV] mode=%d sn=%dÑâ=%d\n", 
mode
, ()
¢
, ()
πt
);

147 i‡(
√xt
 > 1000) ;

150 
ts1
 = 
	`i˛ock
() -Ås1;

152 
	`ik˝_ªÀa£
(
k˝1
);

153 
	`ik˝_ªÀa£
(
k˝2
);

155 c⁄° *
«mes
[3] = { "default", "normal", "fast" };

156 
	`¥ötf
("%†modêªsu… (%dms):\n", 
«mes
[
mode
], ()
ts1
);

157 
	`¥ötf
("avgπt=%d maxπt=%dÅx=%d\n", ()(
sumπt
 / 
cou¡
), ()
maxπt
, ()
v√t
->
tx1
);

158 
	`¥ötf
("pressÉnterÅoÇext ...\n");

159 
ch
; 
	`sˇnf
("%c", &ch);

160 
	}
}

162 
	$maö
()

164 
	`ã°
(0);

165 
	`ã°
(1);

166 
	`ã°
(2);

168 
	}
}

	@kcp/test.h

1 #i‚de‡
__TEST_H__


2 
	#__TEST_H__


	)

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	~<time.h
>

7 
	~<˘y≥.h
>

8 
	~<°rög.h
>

10 
	~"ik˝.h
"

12 #i‡
deföed
(
WIN32
Ë|| deföed(
_WIN32
Ë|| deföed(
WIN64
Ë|| deföed(
_WIN64
)

13 
	~<wödows.h
>

14 #ñi‡!
deföed
(
__unix
)

15 
	#__unix


	)

18 #ifde‡
__unix


19 
	~<uni°d.h
>

20 
	~<sys/time.h
>

21 
	~<sys/waô.h
>

22 
	~<sys/ty≥s.h
>

26 
ölöe
 
	$ôimeofday
(*
£c
, *
u£c
)

28 #i‡
	`deföed
(
__unix
)

29 
timevÆ
 
time
;

30 
	`gëtimeofday
(&
time
, 
NULL
);

31 i‡(
£c
Ë*£¯
time
.
tv_£c
;

32 i‡(
u£c
Ë*u£¯
time
.
tv_u£c
;

34 
mode
 = 0, 
add£c
 = 0;

35 
BOOL
 
ªtvÆ
;

36 
IINT64
 
‰eq
 = 1;

37 
IINT64
 
qpc
;

38 i‡(
mode
 == 0) {

39 
ªtvÆ
 = 
	`QuîyPîf‹m™˚Fªquícy
((
LARGE_INTEGER
*)&
‰eq
);

40 
‰eq
 = (freq == 0)? 1 : freq;

41 
ªtvÆ
 = 
	`QuîyPîf‹m™˚Cou¡î
((
LARGE_INTEGER
*)&
qpc
);

42 
add£c
 = ()
	`time
(
NULL
);

43 
add£c
 =ádd£¯- ()((
qpc
 / 
‰eq
) & 0x7fffffff);

44 
mode
 = 1;

46 
ªtvÆ
 = 
	`QuîyPîf‹m™˚Cou¡î
((
LARGE_INTEGER
*)&
qpc
);

47 
ªtvÆ
 =Ñetval * 2;

48 i‡(
£c
Ë*£¯()(
qpc
 / 
‰eq
Ë+ 
add£c
;

49 i‡(
u£c
Ë*u£¯()((
qpc
 % 
‰eq
) * 1000000 / freq);

51 
	}
}

54 
ölöe
 
IINT64
 
	$i˛ock64
()

56 
s
, 
u
;

57 
IINT64
 
vÆue
;

58 
	`ôimeofday
(&
s
, &
u
);

59 
vÆue
 = ((
IINT64
)
s
Ë* 1000 + (
u
 / 1000);

60  
vÆue
;

61 
	}
}

63 
ölöe
 
IUINT32
 
	$i˛ock
()

65  (
IUINT32
)(
	`i˛ock64
() & 0xfffffffful);

66 
	}
}

69 
ölöe
 
	$i¶ìp
(
mûli£c⁄d
)

71 #ifde‡
__unix


72 
time•ec
 
ts
;

73 
ts
.
tv_£c
 = (
time_t
)(
mûli£c⁄d
 / 1000);

74 
ts
.
tv_n£c
 = ()((
mûli£c⁄d
 % 1000) * 1000000);

76 
	`u¶ìp
((
mûli£c⁄d
 << 10) - (millisecond << 4) - (millisecond << 3));

77 #ñi‡
	`deföed
(
_WIN32
)

78 
	`SÀï
(
mûli£c⁄d
);

80 
	}
}

82 #ifde‡
__˝lu•lus


83 
	~<li°
>

84 
	~<ve˘‹
>

87 ˛as†
	cDñayPackë


89 
	mpublic
:

90 
vútuÆ
 ~
	$DñayPackë
() {

91 i‡(
_±r
Ë
dñëe
[] _ptr;

92 
_±r
 = 
NULL
;

95 
	$DñayPackë
(
size
, c⁄° *
§c
 = 
NULL
) {

96 
_±r
 = 
√w
 [
size
];

97 
_size
 = 
size
;

98 i‡(
§c
) {

99 
	`mem˝y
(
_±r
, 
§c
, 
size
);

101 
	}
}

103 * 
	$±r
(Ë{  
_±r
; 
	}
}

104 c⁄° * 
	$±r
(Ëc⁄° {  
_±r
; 
	}
}

106 
	$size
(Ëc⁄° {  
_size
; 
	}
}

107 
IUINT32
 
	$ts
(Ëc⁄° {  
_ts
; 
	}
}

108 
	$£âs
(
IUINT32
 
ts
Ë{ 
_ts
 =Ås; 
	}
}

110 
	g¥Ÿe˘ed
:

111 *
_±r
;

112 
	g_size
;

113 
IUINT32
 
	g_ts
;

117 ˛as†
	cR™dom


119 
	mpublic
:

120 
	$R™dom
(
size
) {

121 
this
->
size
 = 0;

122 
£eds
.
	`ªsize
(
size
);

125 
	$øndom
() {

126 
x
, 
i
;

127 i‡(
£eds
.
	`size
() == 0)  0;

128 i‡(
size
 == 0) {

129 
i
 = 0; i < ()
£eds
.
	`size
(); i++) {

130 
£eds
[
i
] = i;

132 
size
 = ()
£eds
.
	`size
();

134 
i
 = 
	`ønd
(Ë% 
size
;

135 
x
 = 
£eds
[
i
];

136 
£eds
[
i
] = sìds[--
size
];

137  
x
;

138 
	}
}

140 
	g¥Ÿe˘ed
:

141 
size
;

142 
	g°d
::
ve˘‹
<> 
£eds
;

146 ˛as†
	cL©ícySimuœt‹


148 
	mpublic
:

150 
vútuÆ
 ~
	$L©ícySimuœt‹
() {

151 
	`˛ór
();

157 
	$L©ícySimuœt‹
(
lo°øã
 = 10, 
πtmö
 = 60, 
πtmax
 = 125, 
nmax
 = 1000):

158 
	`r12
(100), 
	$r21
(100) {

159 
cuºít
 = 
	`i˛ock
();

160 
this
->
lo°øã
 =Üostrate / 2;

161 
this
->
πtmö
 =Ñttmin / 2;

162 
this
->
πtmax
 =Ñttmax / 2;

163 
this
->
nmax
 =Çmax;

164 
tx1
 = 
tx2
 = 0;

165 
	}
}

168 
	$˛ór
() {

169 
DñayTu¬ñ
::
ôî©‹
 
ô
;

170 
ô
 = 
p12
.
	`begö
(); ià!p12.
	`íd
(); it++) {

171 
dñëe
 *
ô
;

173 
ô
 = 
p21
.
	`begö
(); ià!p21.
	`íd
(); it++) {

174 
dñëe
 *
ô
;

176 
p12
.
	`˛ór
();

177 
p21
.
	`˛ór
();

178 
	}
}

182 
	$£nd
(
≥î
, c⁄° *
d©a
, 
size
) {

183 i‡(
≥î
 == 0) {

184 
tx1
++;

185 i‡(
r12
.
	`øndom
(Ë< 
lo°øã
) ;

186 i‡(()
p12
.
	`size
(Ë>
nmax
) ;

188 
tx2
++;

189 i‡(
r21
.
	`øndom
(Ë< 
lo°øã
) ;

190 i‡(()
p21
.
	`size
(Ë>
nmax
) ;

192 
DñayPackë
 *
pkt
 = 
√w
 
	`DñayPackë
(
size
, 
d©a
);

193 
cuºít
 = 
	`i˛ock
();

194 
IUINT32
 
dñay
 = 
πtmö
;

195 i‡(
πtmax
 > 
πtmö
Ë
dñay
 +
	`ønd
() % (rttmax -Ñttmin);

196 
pkt
->
	`£âs
(
cuºít
 + 
dñay
);

197 i‡(
≥î
 == 0) {

198 
p12
.
	`push_back
(
pkt
);

200 
p21
.
	`push_back
(
pkt
);

202 
	}
}

205 
	$ªcv
(
≥î
, *
d©a
, 
maxsize
) {

206 
DñayTu¬ñ
::
ôî©‹
 
ô
;

207 i‡(
≥î
 == 0) {

208 
ô
 = 
p21
.
	`begö
();

209 i‡(
p21
.
	`size
() == 0)  -1;

211 
ô
 = 
p12
.
	`begö
();

212 i‡(
p12
.
	`size
() == 0)  -1;

214 
DñayPackë
 *
pkt
 = *
ô
;

215 
cuºít
 = 
	`i˛ock
();

216 i‡(
cuºít
 < 
pkt
->
	`ts
())  -2;

217 i‡(
maxsize
 < 
pkt
->
	`size
())  -3;

218 i‡(
≥î
 == 0) {

219 
p21
.
	`îa£
(
ô
);

221 
p12
.
	`îa£
(
ô
);

223 
maxsize
 = 
pkt
->
	`size
();

224 
	`mem˝y
(
d©a
, 
pkt
->
	`±r
(), 
maxsize
);

225 
dñëe
 
pkt
;

226  
maxsize
;

227 
	}
}

229 
	gpublic
:

230 
tx1
;

231 
	gtx2
;

233 
	g¥Ÿe˘ed
:

234 
IUINT32
 
cuºít
;

235 
	glo°øã
;

236 
	gπtmö
;

237 
	gπtmax
;

238 
	gnmax
;

239 
	g°d
::
	tli°
<
	tDñayPackë
*> 
	tDñayTu¬ñ
;

240 
DñayTu¬ñ
 
	gp12
;

241 
DñayTu¬ñ
 
	gp21
;

242 
R™dom
 
	gr12
;

243 
R™dom
 
	gr21
;

	@libev-examples/include/array-heap.h

2 * 
	md©a
;

3 
	mödex
;

4 
	mÀngth
;

5 } 
	t¨øy
;

7 
¨øy_öô
(
¨øy
* 
¨r
, 
size
);

8 
¨øy_push
(
¨øy
* 
¨r
, * 
d©a
);

9 
¨øy_grow
(
¨øy
* 
¨r
, 
size
);

10 
¨øy_‰ì
(
¨øy
* 
¨r
, (*
‰ì_ñemít
)(*));

	@libev-examples/include/evn-bool.h

10 #i‚de‡
_BOOL_H_


11 
	#_BOOL_H_


	)

14 #i‚de‡
__˝lu•lus


15 #i‚de‡
_BOOL_


16 
	#_BOOL_


	)

17 íum { 
	mÁl£
 = 0, 
	måue
 = 1 } 
	tboﬁ
;

	@libev-examples/include/evn-buffer-list.h

1 #i‚de‡
EVN_BUFFER_LIST_H_


2 
	#EVN_BUFFER_LIST_H_


	)

4 
	~<°dio.h
>

6 
	#evn_îr‹
(...Ë
	`¥ötf
("[EVN] " 
__VA_ARGS__
)

	)

9 * 
	md©a
;

10 * 
	mposôi⁄
;

12 
	m‰ì
;

13 
	mu£d
;

14 
	mˇ∑côy
;

15 } 
	tevn_buf„r
;

18 
evn_buf„r
* 
	mli°
;

19 
evn_buf„r
* 
	mcuºít
;

21 
	mblock_size
;

22 
	mödex
;

23 
	mÀngth
;

24 
	mu£d
;

25 
	msize
;

26 } 
	tevn_buf„æi°
;

30 
evn_buf„r
* 
evn_buf„r_¸óã
(
size
);

32 
evn_buf„r
* 
evn_buf„r_¸óã_c›y
(* 
d©a
, 
size
);

34 
evn_buf„r
* 
evn_buf„r_¸óã_as
(* 
d©a
, 
size
, 
ödex
);

37 
evn_buf„r_add
(
evn_buf„r
* 
buf„r
, * 
d©a
, 
size
);

40 
evn_buf„r_de°roy
(
evn_buf„r
* 
buf„r
);

43 
evn_buf„æi°
* 
evn_buf„æi°_¸óã
(
mö_block_size
, 
¶i˚s
);

45 
evn_buf„æi°_add
(
evn_buf„æi°
* 
buf„æi°
, * 
d©a
, 
size
);

47 
evn_buf„r
* 
evn_buf„æi°_c⁄ˇt
(
evn_buf„æi°
* 
buf„æi°
);

52 
evn_buf„æi°_de°roy
(
evn_buf„æi°
* 
buf„æi°
);

	@libev-examples/include/evn-inbuf.h

1 #i‚de‡
_EVN_INBUF_H_


2 
	#_EVN_INBUF_H_


	)

10 
	gevn_öbuf
;

13 * 
	m°¨t
;

14 * 
	míd
;

15 * 
	mbŸtom
;

16 * 
	mt›
;

17 
	msize
;

18 } 
	tevn_öbuf
;

43 
evn_öbuf
* 
evn_öbuf_¸óã
(
size
);

44 
evn_öbuf_öô
(
evn_öbuf
* 
buf
, 
size
);

46 
evn_öbuf_add
(
evn_öbuf
* 
buf
, * 
d©a
, 
size
);

48 
evn_öbuf_≥ek
(
evn_öbuf
* 
buf
, * 
d©a
, 
size
);

50 
evn_öbuf_toss
(
evn_öbuf
* 
buf
, 
size
);

52 
evn_öbuf_de°roy
(
evn_öbuf
* 
buf
);

	@libev-examples/include/evn.h

1 #i‚de‡
_EVN_H_


2 
	#_EVN_H_


	)

4 
	~<sys/time.h
>

7 
	~<sys/ty≥s.h
>

8 
	~<sys/sockë.h
>

9 
	~<√töë/ö.h
>

10 
	~<¨∑/öë.h
>

11 
	~<sys/un.h
>

12 
	~<f˙é.h
>

13 
	~<uni°d.h
>

15 
	~<ev.h
>

17 
	~"evn-buf„r-li°.h
"

18 
	~"evn-öbuf.h
"

19 
	~"evn-boﬁ.h
"

21 #i‚de‡
EVN_DEBUG


22 #i‡
deföed
 
DEBUG


23 
	#EVN_DEBUG
 1

	)

25 
	#EVN_DEBUG
 0

	)

29 #i‡
EVN_DEBUG


30 
	~<°dio.h
>

31 
	#evn_debug
(...Ë
	`¥ötf
("[EVN] " 
__VA_ARGS__
)

	)

32 
	#evn_debugs
(...Ë
	`puts
("[EVN] " 
__VA_ARGS__
)

	)

34 
	#evn_debug
(...)

	)

35 
	#evn_debugs
(...)

	)

39 
	gevn_°ªam
;

40 
	gevn_£rvî
;

41 
	gevn_ex˚±i⁄
;

43 
	#EVN_SERVER_P
 
evn_£rvî
* 
£rvî


	)

44 
	#EVN_STREAM_P
 
evn_°ªam
* 
°ªam


	)

47 (
	tevn_£rvî_⁄_li°í
)(
	tEV_P_
 
	tevn_£rvî
* 
	t£rvî
);

48 (
	tevn_£rvî_⁄_c⁄√˘i⁄
)(
	tEV_P_
 
	tevn_£rvî
* 
	t£rvî
, 
	tevn_°ªam
* 
	t°ªam
);

49 (
	tevn_£rvî_⁄_˛o£
)(
	tEV_P_
 
	tevn_£rvî
* 
	t£rvî
);

52 (
	tevn_°ªam_⁄_c⁄√˘
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
);

53 (
	tevn_°ªam_⁄_£cuª
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
);

54 (
	tevn_°ªam_⁄_d©a
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
, * 
	tblob
, 
	tsize
);

55 (
	tevn_°ªam_⁄_íd
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
);

56 (
	tevn_°ªam_⁄_timeout
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
);

57 (
	tevn_°ªam_⁄_døö
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
);

58 (
	tevn_°ªam_⁄_îr‹
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
, 
	tevn_ex˚±i⁄
* 
	tîr‹
);

59 (
	tevn_°ªam_⁄_˛o£
)(
	tEV_P_
 
	tevn_°ªam
* 
	t°ªam
, 
	tboﬁ
 
	thad_îr‹
);

63 
evn_CLOSED
,

64 
evn_OPEN
,

65 
evn_OPENING
,

66 
evn_READ_ONLY
,

67 
evn_WRITE_ONLY


68 } 
	tevn_ªady_°©e
;

70 
	sevn_ex˚±i⁄
 {

71 
îr‹_numbî
;

72 
mesßge
[256];

75 
	sevn_£rvî
 {

76 
ev_io
 
io
;

77 
EV_P
;

78 
evn_£rvî_⁄_li°í
* 
⁄_li°í
;

79 
evn_£rvî_⁄_c⁄√˘i⁄
* 
⁄_c⁄√˘i⁄
;

80 
evn_£rvî_⁄_˛o£
* 
⁄_˛o£
;

81 
sockaddr
* 
sockë
;

82 
sockë_Àn
;

86 
	sevn_°ªam
 {

87 
ev_io
 
io
;

88 
evn_°ªam_⁄_c⁄√˘
* 
⁄_c⁄√˘
;

89 
evn_°ªam_⁄_£cuª
* 
⁄_£cuª
;

90 
evn_°ªam_⁄_d©a
* 
⁄_d©a
;

91 
evn_°ªam_⁄_íd
* 
⁄_íd
;

92 
evn_°ªam_⁄_timeout
* 
⁄_timeout
;

93 
evn_°ªam_⁄_døö
* 
⁄_døö
;

94 
evn_°ªam_⁄_îr‹
* 
⁄_îr‹
;

95 
evn_°ªam_⁄_˛o£
* 
⁄_˛o£
;

96 
evn_ªady_°©e
 
ªady_°©e
;

97 
ödex
;

98 
boﬁ
 
⁄eshŸ
;

99 
evn_buf„æi°
* 
buf„æi°
;

100 
evn_öbuf
* 
_¥iv_out_buf„r
;

101 
evn_£rvî
* 
£rvî
;

102 
sockaddr
* 
sockë
;

103 
sockë_Àn
;

104 
EV_P
;

105 
ty≥
;

106 * 
£nd_d©a
;

110 
	`evn_£t_n⁄block
(
fd
);

112 
evn_£rvî
* 
	`evn_£rvî_¸óã
(
EV_P_
 
evn_£rvî_⁄_c⁄√˘i⁄
* 
⁄_c⁄√˘i⁄
);

113 
	`evn_£rvî_li°í
(
evn_£rvî
* 
£rvî
, 
p‹t
, * 
addªss
);

114 
	`evn_£rvî_¥iv_⁄_c⁄√˘i⁄
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
);

115 
	`evn_£rvî_˛o£
(
EV_P_
 
evn_£rvî
* 
£rvî
);

116 
	`evn_£rvî_de°roy
(
EV_P_
 
evn_£rvî
* 
£rvî
);

118 
evn_°ªam
* 
	`evn_°ªam_¸óã
(
fd
);

119 
ölöe
 
evn_°ªam
* 
	`evn_¸óã_c⁄√˘i⁄
(
EV_P_
 
p‹t
, * 
addªss
);

120 
evn_°ªam
* 
	`evn_¸óã_c⁄√˘i⁄_unix_°ªam
(
EV_P_
 * 
sock_∑th
);

121 
evn_°ªam
* 
	`evn_¸óã_c⁄√˘i⁄_t˝_°ªam
(
EV_P_
 
p‹t
, * 
addªss
);

122 
	`evn_°ªam_¥iv_⁄_ªad
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
);

123 
boﬁ
 
	`evn_°ªam_wrôe
(
EV_P_
 
evn_°ªam
* 
°ªam
, * 
d©a
, 
size
);

124 
boﬁ
 
	`evn_°ªam_íd
(
EV_P_
 
evn_°ªam
* 
°ªam
);

125 
boﬁ
 
	`evn_°ªam_de°roy
(
EV_P_
 
evn_°ªam
* 
°ªam
);

	@libev-examples/ipc/my-data.h

1 
	eNRC_MODE
 {

2 
	mNRC_FAST
,

3 
	mNRC_SLOW
,

4 
	mNRC_TURBO
,

5 
	mNRC_REALTIME


8 
	smy_d©a
 {

9 
NRC_MODE
 
	mmode
;

10 
	mfûe
[255];

	@libev-examples/ipc/unix-socket-ipc-daemon.c

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 
	~<î∫o.h
>

5 
	~<°rög.h
>

8 
	~<sys/ty≥s.h
>

9 
	~<sys/sockë.h
>

10 
	~<sys/un.h
>

11 
	~<f˙é.h
>

12 
	~<uni°d.h
>

15 
	~<ev.h
>

19 
	#g_w¨nög
 
¥ötf


	)

22 
	~"¨øy-hóp.h
"

23 
	~"my-d©a.h
"

25 
my_d©a
 
	gd©a
;

27 
	ssock_ev_£rv
 {

28 
ev_io
 
	mio
;

29 
	mfd
;

30 
sockaddr_un
 
	msockë
;

31 
	msockë_Àn
;

32 
¨øy
 
	m˛õ¡s
;

35 
	ssock_ev_˛õ¡
 {

36 
ev_io
 
	mio
;

37 
	mfd
;

38 
	mödex
;

39 
sock_ev_£rv
* 
	m£rvî
;

42 
£ä⁄block
(
fd
);

43 
nŸ_blocked
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
);

44 
£rvî_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
);

45 
ölöe
 
sock_ev_˛õ¡
* 
˛õ¡_√w
(
fd
);

46 
˛õ¡_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
);

47 
£rvî_öô
(
sock_ev_£rv
* 
£rvî
, * 
sock_∑th
, 
max_queue
);

48 
unix_sockë_öô
(
sockaddr_un
* 
sockë_un
, * 
sock_∑th
, 
max_queue
);

52 
	$˛õ¡_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

55 
sock_ev_˛õ¡
* 
˛õ¡
 = (sock_ev_˛õ¡*Ë
w
;

57 
n
;

59 
	`¥ötf
("[r]");

60 
n
 = 
	`ªcv
(
˛õ¡
->
fd
, &
d©a
,  data, 0);

61 i‡(
n
 <= 0) {

62 i‡(0 =
n
) {

64 
	`puts
("orderly disconnect");

65 
	`ev_io_°›
(
EV_A_
 &
˛õ¡
->
io
);

66 
	`˛o£
(
˛õ¡
->
fd
);

67 } i‡(
EAGAIN
 =
î∫o
) {

68 
	`puts
("shouldÇever get inÅhis state withÜibev");

70 
	`≥º‹
("recv");

76 i‡(
	`£nd
(
˛õ¡
->
fd
, ".", 
	`°æí
("."), 0) < 0) {

77 
	`≥º‹
("send");

79 
	}
}

81 
ölöe
 
sock_ev_˛õ¡
* 
	$˛õ¡_√w
(
fd
) {

82 
sock_ev_˛õ¡
* 
˛õ¡
;

84 
˛õ¡
 = 
	`ªÆloc
(
NULL
, (
sock_ev_˛õ¡
));

85 
˛õ¡
->
fd
 = fd;

87 
	`£ä⁄block
(
˛õ¡
->
fd
);

88 
	`ev_io_öô
(&
˛õ¡
->
io
, 
˛õ¡_cb
, clõ¡->
fd
, 
EV_READ
);

90  
˛õ¡
;

91 
	}
}

94 
	$£rvî_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

95 
	`puts
("unix stream socket has becomeÑeadable");

97 
˛õ¡_fd
;

98 
sock_ev_˛õ¡
* 
˛õ¡
;

103 
sock_ev_£rv
* 
£rvî
 = (sock_ev_£rv*Ë
w
;

107 
˛õ¡_fd
 = 
	`ac˚±
(
£rvî
->
fd
, 
NULL
, NULL);

108 if–
˛õ¡_fd
 == -1 )

110 if–
î∫o
 !
EAGAIN
 &&Éºnÿ!
EWOULDBLOCK
 )

112 
	`g_w¨nög
("ac˚±(ËÁûedÉºno=%ò(%s)", 
î∫o
, 
	`°ªº‹
(errno));

113 
	`exô
(
EXIT_FAILURE
);

117 
	`puts
("acceptedá client");

118 
˛õ¡
 = 
	`˛õ¡_√w
(
˛õ¡_fd
);

119 
˛õ¡
->
£rvî
 = server;

120 
˛õ¡
->
ödex
 = 
	`¨øy_push
(&
£rvî
->
˛õ¡s
, client);

121 
	`ev_io_°¨t
(
EV_A_
 &
˛õ¡
->
io
);

123 
	}
}

126 
	$£ä⁄block
(
fd
)

128 
Êags
;

130 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
);

131 
Êags
 |
O_NONBLOCK
;

132  
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
);

133 
	}
}

135 
	$unix_sockë_öô
(
sockaddr_un
* 
sockë_un
, * 
sock_∑th
, 
max_queue
) {

136 
fd
;

138 
	`u∆ök
(
sock_∑th
);

141 
fd
 = 
	`sockë
(
AF_UNIX
, 
SOCK_STREAM
, 0);

142 i‡(-1 =
fd
) {

143 
	`≥º‹
("echo server socket");

144 
	`exô
(
EXIT_FAILURE
);

148 i‡(-1 =
	`£ä⁄block
(
fd
)) {

149 
	`≥º‹
("echo server socketÇonblock");

150 
	`exô
(
EXIT_FAILURE
);

154 
sockë_un
->
sun_Ámûy
 = 
AF_UNIX
;

155 
	`°r˝y
(
sockë_un
->
sun_∑th
, 
sock_∑th
);

157  
fd
;

158 
	}
}

160 
	$£rvî_öô
(
sock_ev_£rv
* 
£rvî
, * 
sock_∑th
, 
max_queue
) {

161 
£rvî
->
fd
 = 
	`unix_sockë_öô
(&£rvî->
sockë
, 
sock_∑th
, 
max_queue
);

162 
£rvî
->
sockë_Àn
 = (£rvî->
sockë
.
sun_Ámûy
Ë+ 
	`°æí
(£rvî->sockë.
sun_∑th
);

164 
	`¨øy_öô
(&
£rvî
->
˛õ¡s
, 128);

166 i‡(-1 =
	`böd
(
£rvî
->
fd
, (
sockaddr
*Ë&£rvî->
sockë
, sîvî->
sockë_Àn
))

168 
	`≥º‹
("echo server bind");

169 
	`exô
(
EXIT_FAILURE
);

172 i‡(-1 =
	`li°í
(
£rvî
->
fd
, 
max_queue
)) {

173 
	`≥º‹
("listen");

174 
	`exô
(
EXIT_FAILURE
);

177 
	}
}

179 
	$maö
() {

180 
max_queue
 = 128;

181 
sock_ev_£rv
 
£rvî
;

182 
ev_≥riodic
 
evîy_„w_£c⁄ds
;

184 
EV_P
 = 
	`ev_deÁu…_lo›
(0);

187 
	`£rvî_öô
(&
£rvî
, "/tmp/libev-ùc-d´m⁄.sock", 
max_queue
);

190 
	`ev_≥riodic_öô
(&
evîy_„w_£c⁄ds
, 
nŸ_blocked
, 0, 5, 0);

191 
	`ev_≥riodic_°¨t
(
EV_A_
 &
evîy_„w_£c⁄ds
);

194 
	`ev_io_öô
(&
£rvî
.
io
, 
£rvî_cb
, sîvî.
fd
, 
EV_READ
);

195 
	`ev_io_°¨t
(
EV_A_
 &
£rvî
.
io
);

198 
	`puts
("unix-socket-echo starting...\n");

199 
	`ev_lo›
(
EV_A_
 0);

202 
	`˛o£
(
£rvî
.
fd
);

203  
EXIT_SUCCESS
;

204 
	}
}

207 
	$nŸ_blocked
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
) {

208 
mode
[20];

210 
d©a
.
mode
)

212 
NRC_TURBO
:

213 
	`°r˝y
(
mode
, "turbo");

215 
NRC_FAST
:

216 
	`°r˝y
(
mode
, "fast");

218 
NRC_SLOW
:

219 
	`°r˝y
(
mode
, "slow");

221 
NRC_REALTIME
:

222 
	`°r˝y
(
mode
, "realtime");

225 
	`°r˝y
(
mode
, "ERROR STATE");

228 
	`puts
("Current Settings:");

229 
	`¥ötf
("fûe: %s\n", 
d©a
.
fûe
);

230 
	`¥ötf
("mode: %s\n", 
mode
);

231 
	}
}

	@libev-examples/ipc/unix-socket-ipc-remote-control.c

2 
	~<¨gp.h
>

5 
	~<°dlib.h
>

6 
	~<°dio.h
>

9 
	~<ev.h
>

12 
	~<sys/sockë.h
>

13 
	~<sys/un.h
>

14 
	~<sys/f˙é.h
>

15 
	~<uni°d.h
>

16 
	~<î∫o.h
>

19 
	~"my-d©a.h
"

28 
my_d©a
 
	gd©a
;

36 c⁄° * 
	g¨gp_¥ogøm_vîsi⁄
 = "Newdora Remote v0.1 (Alpha Alligator)";

37 c⁄° * 
	g¨gp_¥ogøm_bug_addªss
 = "<newdora@example.tld>";

40 
	gdoc
[] = "Newdora Remote -- Remote Control (RC) for Newdora Serving Server Services Streamer (N4S)";

43 
¨gp_›ti⁄
 
	g›ti⁄s
[] = {

49 
îr‹_t
 
	$∑r£_›t
(
key
, * 
¨g
, 
¨gp_°©e
* 
°©e
)

53 
my_d©a
* 
d©a
 = 
°©e
->
öput
;

55 
key
)

58 i‡(0 =
	`°rcmp
("Á°", 
¨g
))

60 
d©a
->
mode
 = 
NRC_FAST
;

62 i‡(0 =
	`°rcmp
("¶ow", 
¨g
))

64 
d©a
->
mode
 = 
NRC_SLOW
;

66 i‡(0 =
	`°rcmp
("turbo", 
¨g
))

68 
d©a
->
mode
 = 
NRC_TURBO
;

70 i‡(0 =
	`°rcmp
("ªÆtime", 
¨g
))

72 
d©a
->
mode
 = 
NRC_REALTIME
;

76  
EINVAL
;

81 i‡(
	`°æí
(
¨g
) > 255) {

82  
E2BIG
;

84 
	`°r˝y
(
d©a
->
fûe
, 
¨g
);

87 
ARGP_KEY_ARG
:

88  
ARGP_ERR_UNKNOWN
;

91 
ARGP_KEY_END
:

95  
ARGP_ERR_UNKNOWN
;

98 
	}
}

100 
¨gp
 
	g¨gp
 = { 
›ti⁄s
, 
∑r£_›t
, 0, 
doc
 };

111 
	gEV_P
;

112 
ev_io
 
	gd´m⁄_w
;

113 
ev_io
 
	g£nd_w
;

114 
	gd´m⁄_fd
;

116 
	$£nd_cb
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

118 
s_£¡
;

120 i‡(
ªvíts
 & 
EV_WRITE
)

122 
	`puts
 ("daemonÑeady for writing...");

124 
s_£¡
 = 
	`£nd
(
d´m⁄_fd
, &
d©a
,  data, 0);

125 i‡(-1 =
s_£¡
)

127 
	`≥º‹
("echo send");

128 
	`exô
(
EXIT_FAILURE
);

130 i‡( 
d©a
 !
s_£¡
)

132 
	`¥ötf
("whatÅhe heck? mismatch size? crazy!\n");

137 
	`ev_io_°›
(
EV_A_
 &
£nd_w
);

138 
	`ev_u∆o›
(
EV_A_
 
EVUNLOOP_ALL
);

142 i‡(
ªvíts
 & 
EV_READ
)

146 
	}
}

148 
	$d´m⁄_cb
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

150 
	`puts
 ("connected,Çow watching stdin");

152 
	`ev_io_°¨t
(
EV_A_
 &
£nd_w
);

154 
	`ev_io_°›
(
EV_A_
 &
d´m⁄_w
);

155 
	}
}

159 
	$£ä⁄block
(
fd
)

161 
Êags
;

163 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
);

164 
Êags
 |
O_NONBLOCK
;

165  
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
);

166 
	}
}

168 
	$c⁄√˘i⁄_√w
(
EV_P_
 * 
sock_∑th
) {

169 
Àn
;

170 
sockaddr_un
 
d´m⁄
;

172 i‡(-1 =(
d´m⁄_fd
 = 
	`sockë
(
AF_UNIX
, 
SOCK_STREAM
, 0))) {

173 
	`≥º‹
("socket");

174 
	`exô
(1);

178 i‡(-1 =
	`£ä⁄block
(
d´m⁄_fd
)) {

179 
	`≥º‹
("echo client socketÇonblock");

180 
	`exô
(
EXIT_FAILURE
);

188 
	`ev_io_öô
 (&
d´m⁄_w
, 
d´m⁄_cb
, 
d´m⁄_fd
, 
EV_WRITE
);

189 
	`ev_io_°¨t
(
EV_A_
 &
d´m⁄_w
);

191 
	`ev_io_öô
(&
£nd_w
, 
£nd_cb
, 
d´m⁄_fd
, 
EV_WRITE
);

192 
	`ev_io_°¨t
(
EV_A_
 &
£nd_w
);

194 
d´m⁄
.
sun_Ámûy
 = 
AF_UNIX
;

195 
	`°r˝y
(
d´m⁄
.
sun_∑th
, 
sock_∑th
);

196 
Àn
 = 
	`°æí
(
d´m⁄
.
sun_∑th
Ë+ (d´m⁄.
sun_Ámûy
);

198 i‡(-1 =
	`c⁄√˘
(
d´m⁄_fd
, (
sockaddr
 *)&
d´m⁄
, 
Àn
)) {

199 
	`≥º‹
("connect");

202 
	}
}

204 
	$maö
 (
¨gc
, * 
¨gv
[])

209 
d©a
.
mode
 = 
NRC_REALTIME
;

210 
	`°r˝y
(
d©a
.
fûe
, "/usr/local/media/demo.n4s");

213 
	`¨gp_∑r£
 (&
¨gp
, 
¨gc
, 
¨gv
, 0, 0, &
d©a
);

219 
lo›
 = 
EV_DEFAULT
;

220 
	`c⁄√˘i⁄_√w
(
EV_A_
 "/tmp/libev-ipc-daemon.sock");

223 
	`ev_lo›
(
EV_A_
 0);

227 
	}
}

	@libev-examples/paired-threaded-ipc/dummy-daemon.c

1 
	~<¨gp.h
>

2 
	~<sys/ªsour˚.h
>

3 
	~<sig«l.h
>

5 
	~"dummy-w‹kî-thªad.h
"

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<î∫o.h
>

11 
	~<°rög.h
>

14 
	~<ev.h
>

15 
	~<±hªad.h
>

17 
	~"dummy-£âögs.h
"

18 
	~"boﬁ.h
"

20 
	~"evn.h
"

22 
	#LOG_PATH
 "/tmp/"

	)

25 
dwt_íqueue
(* 
fûíame
);

28 
˛ón_shutdown
(
EV_P_
 
sig
);

29 
ã°_¥o˚ss_is_nŸ_blocked
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
);

32 
°ªam_⁄_d©a
(
EV_P_
 
evn_°ªam
* 
°ªam
, * 
d©a
, 
n
);

33 
°ªam_⁄_˛o£
(
EV_P_
 
evn_°ªam
* 
°ªam
, 
boﬁ
 
had_îr‹
);

34 
£rvî_⁄_c⁄√˘i⁄
(
EV_P_
 
evn_£rvî
* 
£rvî
, 
evn_°ªam
* 
°ªam
);

37 c⁄° * 
	g¨gp_¥ogøm_vîsi⁄
 = "ACME DummyServe v1.0 (Alphabet Animal)";

38 c⁄° * 
	g¨gp_¥ogøm_bug_addªss
 = "<bugs@example.com>";

41 
	gdoc
[] = "ACME DummyServe -- AnábstractionÜayer betweenÅhe Dummy Processing Algorithmsánd Business Logic";

44 
DUMMY_SETTINGS
 
	gdummy_£âögs
;

45 
boﬁ
 
	gªdúe˘
 = 
Ál£
;

47 
±hªad_t
 
	gdummy_w‹kî_±hªad
;

48 
DUMMY_WORKER_THREAD_CONTROL
 
	gthªad_c⁄åﬁ
;

52 
¨gp_›ti⁄
 
	g›ti⁄s
[] = {

53 
	~"dummy_£âögs_¨gp_›ti⁄.c
"

59 
îr‹_t
 
	$∑r£_›t
 (
key
, *
¨g
, 
¨gp_°©e
 *
°©e
)

61 
key
)

63 
	~"dummy_£âögs_∑r£_›t.c
"

66 
ªdúe˘
 = 
åue
;

69 
ARGP_KEY_ARG
:

70  
ARGP_ERR_UNKNOWN
;

72 
ARGP_KEY_END
:

76  
ARGP_ERR_UNKNOWN
;

79 
	}
}

82 
¨gp
 
	g¨gp
 = { 
›ti⁄s
, 
∑r£_›t
, 0, 
doc
 };

84 
	$˛ón_shutdown
(
EV_P_
 
sig
) {

85 * 
exô_°©us
;

87 
	`puts
("[Daemon] Shutting Down.\n");

88 
	`Ârötf
(
°dîr
, "Re˚ived sig«»%d, shuâög down\n", 
sig
);

90 
	`ev_async_£nd
(
thªad_c⁄åﬁ
.
EV_A
, &—hªad_c⁄åﬁ.
˛ónup
));

93 
	`±hªad_joö
(
dummy_w‹kî_±hªad
, &
exô_°©us
);

94 
	`ev_lo›_de°roy
 (
EV_DEFAULT_UC
);

95 
	`puts
("[dummyd] Dummy cleanup finished.");

96 
	`exô
(
EXIT_SUCCESS
);

97 
	}
}

99 
	$ªdúe˘_ouçut
()

103 
√w_°dîr
, 
√w_°dout
;

104 
√w_°dîr
 = 
	`›í
(
LOG_PATH
 "dummy_îr‹.log", 
O_RDWR
 | 
O_CREAT
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
);

105 
√w_°dout
 = 
	`›í
(
LOG_PATH
 "dummy_debug.log", 
O_RDWR
 | 
O_CREAT
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
);

108 i‡(0 !
	`·runˇã
(
√w_°dîr
, 0))

110 
	`≥º‹
("couldÇotÅruncate stderrÜog");

112 i‡(0 !
	`·runˇã
(
√w_°dout
, 0))

114 
	`≥º‹
("couldÇotÅruncate stdoutÜog");

118 
	`dup2
(
√w_°dîr
, 2);

119 
	`dup2
(
√w_°dout
, 1);

122 
	`˛o£
(
√w_°dîr
);

123 
	`˛o£
(
√w_°dout
);

124 
	}
}

126 
	$maö
 (
¨gc
, * 
¨gv
[])

129 
EV_P
;

130 
±hªad_©å_t
 
©å
;

131 
thªad_°©us
;

132 
evn_£rvî
* 
£rvî
;

133 
sockë_addªss
[256];

134 
EV_A
 = 
	`ev_deÁu…_lo›
(0);

138 
	`dummy_£âögs_£t_¥e£ts
(&
dummy_£âögs
);

139 
	`¨gp_∑r£
 (&
¨gp
, 
¨gc
, 
¨gv
, 0, 0, &
dummy_£âögs
);

143 i‡(
åue
 =
ªdúe˘
)

145 
	`ªdúe˘_ouçut
();

150 
ev_≥riodic
 
evîy_„w_£c⁄ds
;

153 
	`ev_≥riodic_öô
(&
evîy_„w_£c⁄ds
, 
ã°_¥o˚ss_is_nŸ_blocked
, 0, 1, 0);

154 
	`ev_≥riodic_°¨t
(
EV_A_
 &
evîy_„w_£c⁄ds
);

158 
	`£çri‹ôy
(
PRIO_PROCESS
, 0, -13);

161 
thªad_c⁄åﬁ
.
dummy_£âögs
 = &dummy_settings;

162 
thªad_c⁄åﬁ
.
buf„r_hód
 = 0;

163 
thªad_c⁄åﬁ
.
buf„r_cou¡
 = 0;

164 
thªad_c⁄åﬁ
.
EV_A
 = 
	`ev_lo›_√w
(
EVFLAG_AUTO
);

166 
	`±hªad_©å_öô
(&
©å
);

167 
	`±hªad_©å_£tdëach°©e
(&
©å
, 
PTHREAD_CREATE_JOINABLE
);

169 
thªad_°©us
 = 
	`±hªad_¸óã
(&
dummy_w‹kî_±hªad
, &
©å
, 
dummy_w‹kî_thªad
, (*)(&
thªad_c⁄åﬁ
));

170 i‡(0 !
thªad_°©us
)

172 
	`Ârötf
(
°dîr
, "thªad cª©i⁄ faûed wôhÉºnÿ%d (%s)\n", 
thªad_°©us
, 
	`°ªº‹
(thread_status));

173 
	`exô
(
EXIT_FAILURE
);

175 
	`±hªad_©å_de°roy
(&
©å
);

179 
	`¢¥ötf
(
sockë_addªss
, (sockë_addªss), 
DUMMYD_SOCK
, ()
	`gëuid
());

180 
	`u∆ök
(
sockë_addªss
);

181 
£rvî
 = 
	`evn_£rvî_¸óã
(
EV_A_
 
£rvî_⁄_c⁄√˘i⁄
);

182 
£rvî
->
⁄_c⁄√˘i⁄
 = 
£rvî_⁄_c⁄√˘i⁄
;

183 
	`evn_£rvî_li°í
(
£rvî
, 0, 
sockë_addªss
);

186 
	`puts
("[Daemon] Looping.\n");

187 
	`ev_lo›
(
EV_A_
 0);

190 
	`˛ón_shutdown
(
EV_A_
 0);

192 
	}
}

194 
	$ã°_¥o˚ss_is_nŸ_blocked
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
) {

195 
up_time
 = 0;

196 
°©
 
sb
;

197 
°©us1
, 
°©us2
;

201 
	`f°©
(1, &
sb
);

202 if(
sb
.
°_size
 > 1048576)

204 
°©us1
 = 
	`·runˇã
(1, 0);

205 
°©us2
 = 
	`l£ek
(1, 0, 
SEEK_SET
);

206 i‡–(0 !
°©us1
Ë|| (0 !
°©us2
))

208 
	`≥º‹
("truncating stdout file");

212 
	`¥ötf
("successfullyÅruncatedÅhe stdout file\n");

216 
	`¥ötf
("I'm stû»Æivê(%d)\n", 
up_time
);

217 
up_time
 += 1;

218 
	}
}

220 
	$dwt_íqueue
(* 
fûíame
)

222 
buf„r_èû
;

224 
	`±hªad_muãx_lock
(&(
thªad_c⁄åﬁ
.
buf„r_lock
));

225 i‡(
thªad_c⁄åﬁ
.
buf„r_cou¡
 < 
BUFFER_SIZE
)

227 
buf„r_èû
 = (
thªad_c⁄åﬁ
.
buf„r_hód
 +Åhªad_c⁄åﬁ.
buf„r_cou¡
Ë% 
BUFFER_SIZE
;

228 
	`°∫˝y
(
thªad_c⁄åﬁ
.
buf„r
[
buf„r_èû
], 
fûíame
, Åhread_control.buffer[buffer_tail]);

229 
thªad_c⁄åﬁ
.
buf„r_cou¡
 += 1;

230 
	`¥ötf
("addedÅÿthêbuf„r.Çow c⁄èö†%d\n", 
thªad_c⁄åﬁ
.
buf„r_cou¡
);

235 
buf„r_èû
 = 
thªad_c⁄åﬁ
.
buf„r_hód
;

236 
thªad_c⁄åﬁ
.
buf„r_hód
 = (thªad_c⁄åﬁ.buf„r_hód + 1Ë% 
BUFFER_SIZE
;

237 
	`¥ötf
("ovîwrôög %†öÅhêbuf„r\n", 
thªad_c⁄åﬁ
.
buf„r
[
buf„r_èû
]);

238 
	`°∫˝y
(
thªad_c⁄åﬁ
.
buf„r
[
buf„r_èû
], 
fûíame
, Åhread_control.buffer[buffer_tail]);

240 
	`±hªad_muãx_u∆ock
(&(
thªad_c⁄åﬁ
.
buf„r_lock
));

242 
	`ev_async_£nd
(
thªad_c⁄åﬁ
.
EV_A
, &—hªad_c⁄åﬁ.
¥o˚ss_d©a
));

243 
	}
}

246 
ölöe
 
	$dwt_upd©e_£âögs
(* 
d©a
)

249 
	`±hªad_muãx_lock
(&(
thªad_c⁄åﬁ
.
£âögs_lock
));

250 
	`mem˝y
(&
dummy_£âögs
, 
d©a
, (dummy_settings));

251 
	`±hªad_muãx_u∆ock
(&(
thªad_c⁄åﬁ
.
£âögs_lock
));

252 
	`ev_async_£nd
(
thªad_c⁄åﬁ
.
EV_A
, &—hªad_c⁄åﬁ.
upd©e_£âögs
));

253 
	}
}

256 
	$£rvî_⁄_c⁄√˘i⁄
(
EV_P_
 
evn_£rvî
* 
£rvî
, 
evn_°ªam
* 
°ªam
)

258 
	`puts
("[Server CB]ácceptedá stream");

259 
°ªam
->
⁄_d©a
 = 
°ªam_⁄_d©a
;

260 
°ªam
->
⁄_˛o£
 = 
°ªam_⁄_˛o£
;

261 
°ªam
->
£rvî
 = server;

262 
°ªam
->
⁄eshŸ
 = 
åue
;

263 
	}
}

265 
	$°ªam_⁄_˛o£
(
EV_P_
 
evn_°ªam
* 
°ªam
, 
boﬁ
 
had_îr‹
)

267 
	`puts
("[Stream CB] Close");

268 
	}
}

271 
	$°ªam_⁄_d©a
(
EV_P_
 
evn_°ªam
* 
°ªam
, * 
øw
, 
n
)

273 
fûíame
[32];

274 
code
 = ((*)
øw
)[0];

275 * 
d©a
 = (*Ë&((*)
øw
)[1];

276 
n
 -= 1;

278 
°ªam
->
ty≥
 = 
code
;

280 
	`¥ötf
("[D©®CB] - såóm ha†becomêªadabÀ (%d byãs)\n", 
n
);

282 
°ªam
->
ty≥
) {

284 
	`¥ötf
("\t's' - update dummy_settings");

286 i‡((
dummy_£âögs
Ë!
n
) {

287 
	`¥ötf
("ex≥˘ed=%dá˘uÆ=%d", (Ë(
dummy_£âögs
), 
n
);

291 
	`dwt_upd©e_£âögs
(
d©a
);

297 
	`¥ötf
("\t'.' - continue working");

301 i‡((
fûíame
Ë!
n
) {

302 
	`¥ötf
("ex≥˘ed=%dá˘uÆ=%d", (Ë(
fûíame
), 
n
);

306 
	`mem£t
(
fûíame
, 0, (filename));

307 
	`mem˝y
(
fûíame
, 
d©a
, (filename));

309 
	`dwt_íqueue
(
fûíame
);

314 
	`¥ötf
("\t'x' -Ñeceived kill message;Éxiting");

316 i‡(0 !
n
) {

317 
	`¥ötf
("ex≥˘ed=%dá˘uÆ=%d", (Ë0, 
n
);

321 
	`ev_u∆o›
(
EV_A_
 
EVUNLOOP_ALL
);

326 
	`¥ötf
("\t'%c' (%dË-Ñe˚ived unknow¿mesßge;Éxôög", 
°ªam
->
ty≥
, stream->type);

328 
	`ev_u∆o›
(
EV_A_
 
EVUNLOOP_ALL
);

331 
	`‰ì
(
øw
);

332 
	`puts
(".");

333 
	}
}

	@libev-examples/paired-threaded-ipc/dummy-rc.c

2 
	~<¨gp.h
>

3 
	~<°rög.h
>

6 
	~<°dlib.h
>

7 
	~<°dio.h
>

10 
	~<ev.h
>

13 
	~<sys/sockë.h
>

14 
	~<sys/un.h
>

15 
	~<sys/f˙é.h
>

16 
	~<uni°d.h
>

17 
	~<î∫o.h
>

20 
	~"dummy-£âögs.h
"

21 
	~"boﬁ.h
"

23 
	~"evn.h
"

29 
DUMMY_SETTINGS
 
	gdummy_£âögs
;

30 
boﬁ
 
	gkûl_¥o˚ss
 = 
Ál£
;

31 
boﬁ
 
	gåiggî_¥o˚ss
 = 
Ál£
;

32 
	gfûíame
[32] = {};

40 c⁄° * 
	g¨gp_¥ogøm_vîsi⁄
 = "ACME DummyRemote v1.0 (Alphabet Animal)";

41 c⁄° * 
	g¨gp_¥ogøm_bug_addªss
 = "<bugs@example.com>";

44 
	gdoc
[] = "ACME DummyRemote -- A unix-stream client for controlling DummyServe";

47 
¨gp_›ti⁄
 
	g›ti⁄s
[] = {

48 
	~"dummy_£âögs_¨gp_›ti⁄.c
"

55 
îr‹_t
 
	$∑r£_›t
 (
key
, *
¨g
, 
¨gp_°©e
 *
°©e
)

57 
key
)

60 
kûl_¥o˚ss
 = 
åue
;

63 
åiggî_¥o˚ss
 = 
åue
;

64 
	`°∫˝y
(
fûíame
, 
¨g
,  filename);

65 
fûíame
[ filename - 1] = '\0';

67 
	~"dummy_£âögs_∑r£_›t.c
"

69 
ARGP_KEY_ARG
:

70  
ARGP_ERR_UNKNOWN
;

72 
ARGP_KEY_END
:

76  
ARGP_ERR_UNKNOWN
;

79 
	}
}

81 
¨gp
 
	g¨gp
 = { 
›ti⁄s
, 
∑r£_›t
, 0, 
doc
 };

87 
	$⁄_˛o£
(
EV_P_
 
evn_°ªam
* 
°ªam
, 
boﬁ
 
had_îr‹
)

89 
	`puts
("[dummy-rc]\n\tClose CB");

90 
	}
}

92 
	$⁄_døö
(
EV_P_
 
evn_°ªam
* 
°ªam
)

94 
boﬁ
 
Æl_£¡
;

95 
	`puts
("[dummy-rc]\n\tnowÑeady for writing...");

97 i‡(
åue
 =
kûl_¥o˚ss
)

99 
Æl_£¡
 = 
	`evn_°ªam_wrôe
(
EV_A_
 
°ªam
, "x", ());

101 i‡(
åue
 =
åiggî_¥o˚ss
)

103 
	`evn_°ªam_wrôe
(
EV_A_
 
°ªam
, ".", ());

104 
Æl_£¡
 = 
	`evn_°ªam_wrôe
(
EV_A_
 
°ªam
, 
fûíame
, (filename));

108 
	`evn_°ªam_wrôe
(
EV_A_
 
°ªam
, "s", ());

109 
Æl_£¡
 = 
	`evn_°ªam_wrôe
(
EV_A_
 
°ªam
, &
dummy_£âögs
, (dummy_settings));

113 i‡(
Ál£
 =
Æl_£¡
)

115 
	`puts
("[dummy-rc]");

116 
	`puts
("\tall orÖart ofÅhe data was queued in user memory");

117 
	`puts
("\t'drain' will beÉmitted whenÅhe buffer iságain free");

121 
	`puts
("[dummy-rc]\n\tSuccess: wroteáll data.");

124 
	`evn_°ªam_íd
(
EV_A_
 
°ªam
);

125 
	}
}

127 
	$maö
 (
¨gc
, * 
¨gv
[])

130 
	`dummy_£âögs_£t_¥e£ts
(&
dummy_£âögs
);

133 
	`¨gp_∑r£
 (&
¨gp
, 
¨gc
, 
¨gv
, 0, 0, &
dummy_£âögs
);

136 
EV_P
 = 
EV_DEFAULT
;

139 
sockë_addªss
[256];

140 
	`¢¥ötf
(
sockë_addªss
,  sockë_addªss, 
DUMMYD_SOCK
, ()
	`gëuid
());

141 
evn_°ªam
* 
°ªam
 = 
	`evn_¸óã_c⁄√˘i⁄
(
EV_A_
 0, 
sockë_addªss
);

142 i‡(
°ªam
) {

143 
°ªam
->
⁄_˛o£
 = on_close;

144 
°ªam
->
⁄_døö
 = on_drain;

148 
	`ev_lo›
(
EV_A_
 0);

152 
	}
}

	@libev-examples/paired-threaded-ipc/dummy-settings.c

1 
	~<°dio.h
>

3 
	~"dummy-£âögs.h
"

5 
	$dummy_£âögs_£t_¥e£ts
(
DUMMY_SETTINGS
* 
dummy_£âögs
)

8 
dummy_£âögs
->
dñay
 = 100;

9 
dummy_£âögs
->
v¨ün˚
 = 10;

10 
dummy_£âögs
->
öô_time
 = 10;

11 
	}
}

13 
	$dummy_£âögs_¥öt
(
DUMMY_SETTINGS
* 
dummy_£âögs
)

15 
	`¥ötf
("dñay = %dms\n", 
dummy_£âögs
->
dñay
);

16 
	`¥ötf
("v¨ün˚ = %d%%\n", 
dummy_£âögs
->
v¨ün˚
);

17 
	`¥ötf
("öô_timê%d%%\n", 
dummy_£âögs
->
öô_time
);

18 
	}
}

	@libev-examples/paired-threaded-ipc/dummy-worker-test.c

1 
	~<°dio.h
>

2 
	~<sys/time.h
>

4 
	~"boﬁ.h
"

5 
	~"lo›.h
"

6 
	~"dummy-w‹kî.h
"

8 
DUMMY_SETTINGS
 
	g£âögs
;

11 
	$time_dñè_¥öt
(* 
¥efix
)

13 
cou¡
;

14 
timevÆ
 
œ°_timï
 = {};

15 
timevÆ
 
timï
;

16 
dñè
;

18 i‡(!
œ°_timï
.
tv_u£c
)

20 
	`gëtimeofday
(&
œ°_timï
, 
NULL
);

24 
	`gëtimeofday
(&
timï
, 
NULL
);

26 
dñè
 = (Ë(
timï
.
tv_u£c
 - 
œ°_timï
.tv_usec);

27 i‡(
dñè
 < 0)

29 
dñè
 += 1000000;

31 
	`¥ötf
("%3d %s: %.3‡ms\n", 
cou¡
, 
¥efix
, 
dñè
 / 1000.0);

33 
œ°_timï
 = 
timï
;

34 
cou¡
 += 1;

35 
	}
}

39 
	$w‹k
()

41 
d©a
[4096 * 1024];

42 
i
 = 0;

44 
lo›
 {

45 i‡(
i
 >= 10)

49 
	`w‹kî_run
(&
d©a
);

50 
	`time_dñè_¥öt
("run");

51 
i
 += 1;

53 
	}
}

57 
	$maö
 (
¨gc
, * 
¨gv
[])

59 
£âögs
.
öô_time
 = 10;

60 
£âögs
.
dñay
 = 128;

61 
£âögs
.
v¨ün˚
 = 15;

63 
	`time_dñè_¥öt
("begin");

65 
	`w‹kî_öô
(&
£âögs
);

66 
	`time_dñè_¥öt
("init");

68 
	`w‹kî_£t
(&
£âögs
);

69 
	`time_dñè_¥öt
("set");

71 
	`w‹k
();

73 
	`w‹kî_˛ón
();

74 
	`time_dñè_¥öt
("clean");

77 
	}
}

	@libev-examples/paired-threaded-ipc/dummy-worker-thread.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	~<uni°d.h
>

6 
	~"dummy-w‹kî-thªad.h
"

7 
	~"dummy-w‹kî.h
"

8 
	~"dummy-£âögs.h
"

11 
upd©e_£âögs
(
EV_P_
 
ev_async
 *
w
, 
ªvíts
);

12 
¥o˚ss_d©a
(
EV_P_
 
ev_async
 *
w
, 
ªvíts
);

13 
˛ónup
(
EV_P_
 
ev_async
 *
w
, 
ªvíts
);

16 
DUMMY_WORKER_THREAD_CONTROL
* 
	gthªad_c⁄åﬁ
;

19 
DUMMY_SETTINGS
 
	gdummy_£âögs
;

21 * 
	$dummy_w‹kî_thªad
(* 
c⁄åﬁ_°ru˘
)

23 
thªad_c⁄åﬁ
 = (
DUMMY_WORKER_THREAD_CONTROL
*)
c⁄åﬁ_°ru˘
;

25 
	`±hªad_muãx_lock
(&(
thªad_c⁄åﬁ
->
£âögs_lock
));

26 
	`mem˝y
(&
dummy_£âögs
, 
thªad_c⁄åﬁ
->dummy_settings,  dummy_settings);

27 
	`±hªad_muãx_u∆ock
(&(
thªad_c⁄åﬁ
->
£âögs_lock
));

30 if(
EXIT_SUCCESS
 !
	`w‹kî_öô
(&
dummy_£âögs
)) {

31 
	`Ârötf
(
°dîr
, "failed init DUMMY_WORKERálgorithm\n");

32 
	`exô
(
EXIT_FAILURE
);

36 
	`ev_async_öô
 (&(
thªad_c⁄åﬁ
->
upd©e_£âögs
), &update_settings);

37 
	`ev_async_°¨t
(
thªad_c⁄åﬁ
->
EV_A
, &—hªad_c⁄åﬁ->
upd©e_£âögs
));

39 
	`ev_async_öô
 (&(
thªad_c⁄åﬁ
->
¥o˚ss_d©a
), &process_data);

40 
	`ev_async_°¨t
(
thªad_c⁄åﬁ
->
EV_A
, &—hªad_c⁄åﬁ->
¥o˚ss_d©a
));

42 
	`ev_async_öô
 (&(
thªad_c⁄åﬁ
->
˛ónup
), &cleanup);

43 
	`ev_async_°¨t
(
thªad_c⁄åﬁ
->
EV_A
, &—hªad_c⁄åﬁ->
˛ónup
));

45 
	`ev_lo›
(
thªad_c⁄åﬁ
->
EV_A
, 0);

47 
	`Ârötf
(
°dîr
, "theÉventÜoop forÅhe DUMMY_WORKERÅhreadÉxitted\n");

48  
NULL
;

49 
	}
}

51 
	$upd©e_£âögs
(
EV_P_
 
ev_async
 *
w
, 
ªvíts
)

53 
	`±hªad_muãx_lock
(&(
thªad_c⁄åﬁ
->
£âögs_lock
));

54 
	`mem˝y
(&
dummy_£âögs
, 
thªad_c⁄åﬁ
->dummy_settings,  dummy_settings);

55 
	`±hªad_muãx_u∆ock
(&(
thªad_c⁄åﬁ
->
£âögs_lock
));

57 
	`w‹kî_£t
(&
dummy_£âögs
);

58 
	}
}

60 
	$¥o˚ss_d©a
(
EV_P_
 
ev_async
 *
w
, 
ªvíts
)

62 
cuºít_fûe
[32];

64 
	`±hªad_muãx_lock
(&(
thªad_c⁄åﬁ
->
buf„r_lock
));

65 
	`°∫˝y
(
cuºít_fûe
, 
thªad_c⁄åﬁ
->
buf„r
[thªad_c⁄åﬁ->
buf„r_hód
],  current_file);

66 
thªad_c⁄åﬁ
->
buf„r_hód
 = (thªad_c⁄åﬁ->buf„r_hód + 1Ë% 
BUFFER_SIZE
;

67 
thªad_c⁄åﬁ
->
buf„r_cou¡
 -= 1;

68 
	`±hªad_muãx_u∆ock
(&(
thªad_c⁄åﬁ
->
buf„r_lock
));

70 
	`w‹kî_run
(
cuºít_fûe
);

71 
	}
}

73 
	$˛ónup
(
EV_P_
 
ev_async
 *
w
, 
ªvíts
)

75 
	`w‹kî_˛ón
();

76 
	`ev_u∆o›
(
EV_A_
 
EVUNLOOP_ALL
);

77 
	}
}

	@libev-examples/paired-threaded-ipc/dummy-worker.c

1 
	~<uni°d.h
>

2 
	~<°dio.h
>

3 
	~<°rög.h
>

6 
	~"dummy-w‹kî.h
"

7 
	~"ønd.h
"

9 
DUMMY_SETTINGS
 
	g£âögs
;

11 
	$m¶ìp
(
time
) {

12 i‡(0 !
	`u¶ìp
((
u£c⁄ds_t
Ë(
time
 * 1000)))

14 
	`≥º‹
("couldn't usleep (possibly caughtá signal)");

16 
	}
}

19 
	$w‹kî_öô
(
DUMMY_SETTINGS
* 
√w_£âögs
)

21 
	`w‹kî_£t
(
√w_£âögs
);

22 
	`m¶ìp
(
£âögs
.
öô_time
);

24 
	}
}

27 
	$w‹kî_run
(* 
d©a
)

29 
¥oc_time
;

31 i‡(
£âögs
.
v¨ün˚
)

33 
¥oc_time
 = 
	`øndom_ö_ønge_≥r˚¡
(
£âögs
.
dñay
, (Ë£âögs.
v¨ün˚
);

37 
¥oc_time
 = 
£âögs
.
dñay
;

40 
	`m¶ìp
(
¥oc_time
);

41 
	}
}

44 
	$w‹kî_˛ón
()

46 
	`m¶ìp
(
£âögs
.
öô_time
);

47 
	}
}

50 
	$w‹kî_£t
(
DUMMY_SETTINGS
* 
√w_£âögs
)

52 
	`mem˝y
((*Ë&
£âögs
, (*Ë
√w_£âögs
, (
size_t
Ë(
DUMMY_SETTINGS
));

53 
	}
}

	@libev-examples/paired-threaded-ipc/include/dummy-settings.h

1 #i‚de‡
DUMMY_SETTINGS_STRUCT_H


2 
	#DUMMY_SETTINGS_STRUCT_H


	)

4 
	#DUMMYD_SOCK
 "/tmp/dummyd-%d.sock"

	)

6 #¥agm®
∑ck
(1)

9 
	mdñay
;

10 
	mv¨ün˚
;

11 
	möô_time
;

12 } 
	tDUMMY_SETTINGS
;

13 #¥agm®
∑ck
()

15 
dummy_£âögs_£t_¥e£ts
(
DUMMY_SETTINGS
*);

16 
dummy_£âögs_¥öt
(
DUMMY_SETTINGS
*);

	@libev-examples/paired-threaded-ipc/include/dummy-worker-thread.h

1 #i‚de‡
DUMMY_WORKER_THREAD_STRUCT


2 
	#DUMMY_WORKER_THREAD_STRUCT


	)

4 
	~<ev.h
>

5 
	~<±hªad.h
>

7 
	~"dummy-£âögs.h
"

11 
	#BUFFER_SIZE
 6

	)

13 
	sDUMMY_WORKER_THREAD_CONTROL
 {

15 
±hªad_muãx_t
 
	mbuf„r_lock
;

16 
	mbuf„r
[
BUFFER_SIZE
][32];

17 
	mbuf„r_cou¡
;

18 
	mbuf„r_hód
;

21 
±hªad_muãx_t
 
	m£âögs_lock
;

22 
DUMMY_SETTINGS
* 
	mdummy_£âögs
;

25 
ev_async
 
	mupd©e_£âögs
;

26 
ev_async
 
	m¥o˚ss_d©a
;

27 
ev_async
 
	m˛ónup
;

30 
	mEV_P
;

33 * 
dummy_w‹kî_thªad
(* 
c⁄åﬁ_°ru˘
);

	@libev-examples/paired-threaded-ipc/include/dummy-worker.h

1 #i‚de‡
_DUMMY_WORKER_H_


2 
	#_DUMMY_WORKER_H_


	)

4 
	~"dummy-£âögs.h
"

7 
w‹kî_öô
(
DUMMY_SETTINGS
* 
√w_£âögs
);

10 
w‹kî_run
(* 
d©a
);

13 
w‹kî_˛ón
();

16 
w‹kî_£t
(
DUMMY_SETTINGS
* 
√w_£âögs
);

	@libev-examples/paired-threaded-ipc/include/dummy_settings_argp_option.c

	@libev-examples/paired-threaded-ipc/include/dummy_settings_parse_opt.c

2 
dummy_£âögs
.
dñay
 = 
©oi
(
¨g
);

5 
dummy_£âögs
.
v¨ün˚
 = 
©oi
(
¨g
);

	@libev-examples/paired-threaded-ipc/include/ev.h

40 #i‚de‡
EV_H_


41 
	#EV_H_


	)

43 #ifde‡
__˝lu•lus


47 
	tev_t°amp
;

50 #i‚de‡
EV_MINPRI


51 
	#EV_MINPRI
 -2

	)

53 #i‚de‡
EV_MAXPRI


54 
	#EV_MAXPRI
 +2

	)

57 #i‚de‡
EV_MULTIPLICITY


58 
	#EV_MULTIPLICITY
 1

	)

61 #i‚de‡
EV_PERIODIC_ENABLE


62 
	#EV_PERIODIC_ENABLE
 1

	)

65 #i‚de‡
EV_STAT_ENABLE


66 
	#EV_STAT_ENABLE
 1

	)

69 #i‚de‡
EV_IDLE_ENABLE


70 
	#EV_IDLE_ENABLE
 1

	)

73 #i‚de‡
EV_FORK_ENABLE


74 
	#EV_FORK_ENABLE
 1

	)

77 #i‚de‡
EV_EMBED_ENABLE


78 
	#EV_EMBED_ENABLE
 1

	)

81 #i‚de‡
EV_ASYNC_ENABLE


82 
	#EV_ASYNC_ENABLE
 1

	)

85 #i‚de‡
EV_WALK_ENABLE


86 
	#EV_WALK_ENABLE
 0

	)

89 #i‚de‡
EV_ATOMIC_T


90 
	~<sig«l.h
>

91 
	#EV_ATOMIC_T
 
sig_©omic_t
 vﬁ©ûe

	)

96 #i‡
EV_STAT_ENABLE


97 #ifde‡
_WIN32


98 
	~<time.h
>

99 
	~<sys/ty≥s.h
>

101 
	~<sys/°©.h
>

105 #i‡
EV_MULTIPLICITY


106 
ev_lo›
;

107 
	#EV_P
 
ev_lo›
 *
lo›


	)

108 
	#EV_P_
 
EV_P
,

	)

109 
	#EV_A
 
lo›


	)

110 
	#EV_A_
 
EV_A
,

	)

111 
	#EV_DEFAULT_UC
 
	`ev_deÁu…_lo›_uc
 ()

	)

112 
	#EV_DEFAULT_UC_
 
EV_DEFAULT_UC
,

	)

113 
	#EV_DEFAULT
 
	`ev_deÁu…_lo›
 (0)

	)

114 
	#EV_DEFAULT_
 
EV_DEFAULT
,

	)

116 
	#EV_P
 

	)

117 
	#EV_P_


	)

118 
	#EV_A


	)

119 
	#EV_A_


	)

120 
	#EV_DEFAULT


	)

121 
	#EV_DEFAULT_


	)

122 
	#EV_DEFAULT_UC


	)

123 
	#EV_DEFAULT_UC_


	)

124 #unde‡
EV_EMBED_ENABLE


127 #i‡
__STDC_VERSION__
 >199901L || 
__GNUC__
 >= 3

128 
	#EV_INLINE
 
ölöe


	)

130 
	#EV_INLINE
 

	)

136 
	#EV_UNDEF
 -1

	)

137 
	#EV_NONE
 0x00

	)

138 
	#EV_READ
 0x01

	)

139 
	#EV_WRITE
 0x02

	)

140 
	#EV__IOFDSET
 0x80

	)

141 
	#EV_IO
 
EV_READ


	)

142 
	#EV_TIMEOUT
 0x00000100

	)

143 
	#EV_TIMER
 
EV_TIMEOUT


	)

144 
	#EV_PERIODIC
 0x00000200

	)

145 
	#EV_SIGNAL
 0x00000400

	)

146 
	#EV_CHILD
 0x00000800

	)

147 
	#EV_STAT
 0x00001000

	)

148 
	#EV_IDLE
 0x00002000

	)

149 
	#EV_PREPARE
 0x00004000

	)

150 
	#EV_CHECK
 0x00008000

	)

151 
	#EV_EMBED
 0x00010000

	)

152 
	#EV_FORK
 0x00020000

	)

153 
	#EV_ASYNC
 0x00040000

	)

154 
	#EV_CUSTOM
 0x01000000

	)

155 
	#EV_ERROR
 0x80000000

	)

158 #i‚de‡
EV_COMMON


159 
	#EV_COMMON
 *
d©a
;

	)

161 #i‚de‡
EV_PROTOTYPES


162 
	#EV_PROTOTYPES
 1

	)

165 
	#EV_VERSION_MAJOR
 3

	)

166 
	#EV_VERSION_MINOR
 9

	)

168 #i‚de‡
EV_CB_DECLARE


169 
	#EV_CB_DECLARE
(
ty≥
Ë(*
cb
)(
EV_P_
 ty≥ *
w
, 
ªvíts
);

	)

171 #i‚de‡
EV_CB_INVOKE


172 
	#EV_CB_INVOKE
(
w©chî
,
ªvíts
Ë(w©chî)->
	`cb
 (
	`EV_A_
 (w©chî), (ªvíts))

	)

192 #i‡
EV_MINPRI
 =
EV_MAXPRI


193 
	#EV_DECL_PRIORITY


	)

195 
	#EV_DECL_PRIORITY
 
¥i‹ôy
;

	)

199 
	#EV_WATCHER
(
ty≥
Ë\

	)

200 
a˘ive
; \

201 
≥ndög
; \

202 
EV_DECL_PRIORITY
 \

203 
EV_COMMON
 \

204 
EV_CB_DECLARE
 (
ty≥
)

206 
	#EV_WATCHER_LIST
(
ty≥
Ë\

	)

207 
EV_WATCHER
 (
ty≥
) \

208 
ev_w©chî_li°
 *
√xt
;

210 
	#EV_WATCHER_TIME
(
ty≥
Ë\

	)

211 
EV_WATCHER
 (
ty≥
) \

212 
ev_t°amp
 
©
;

215 
	sev_w©chî


217 
EV_WATCHER
 (
ev_w©chî
)

218 } 
	tev_w©chî
;

221 
	sev_w©chî_li°


223 
EV_WATCHER_LIST
 (
ev_w©chî_li°
)

224 } 
	tev_w©chî_li°
;

227 
	sev_w©chî_time


229 
EV_WATCHER_TIME
 (
ev_w©chî_time
)

230 } 
	tev_w©chî_time
;

234 
	sev_io


236 
EV_WATCHER_LIST
 (
ev_io
)

238 
fd
;

239 
evíts
;

240 } 
	tev_io
;

244 
	sev_timî


246 
EV_WATCHER_TIME
 (
ev_timî
)

248 
ev_t°amp
 
ª≥©
;

249 } 
	tev_timî
;

253 
	sev_≥riodic


255 
EV_WATCHER_TIME
 (
ev_≥riodic
)

257 
ev_t°amp
 
off£t
;

258 
ev_t°amp
 
öãrvÆ
;

259 
ev_t°amp
 (*
ªscheduÀ_cb
)(
ev_≥riodic
 *
w
,Év_t°am∞
now
);

260 } 
	tev_≥riodic
;

264 
	sev_sig«l


266 
EV_WATCHER_LIST
 (
ev_sig«l
)

268 
signum
;

269 } 
	tev_sig«l
;

274 
	sev_chûd


276 
EV_WATCHER_LIST
 (
ev_chûd
)

278 
Êags
;

279 
pid
;

280 
Ωid
;

281 
r°©us
;

282 } 
	tev_chûd
;

284 #i‡
EV_STAT_ENABLE


286 #ifde‡
_WIN32


287 
_°©i64
 
	tev_°©d©a
;

289 
°©
 
	tev_°©d©a
;

294 
	sev_°©


296 
EV_WATCHER_LIST
 (
ev_°©
)

298 
ev_timî
 
timî
;

299 
ev_t°amp
 
öãrvÆ
;

300 c⁄° *
∑th
;

301 
ev_°©d©a
 
¥ev
;

302 
ev_°©d©a
 
©å
;

304 
wd
;

305 } 
	tev_°©
;

308 #i‡
EV_IDLE_ENABLE


311 
	sev_idÀ


313 
EV_WATCHER
 (
ev_idÀ
)

314 } 
	tev_idÀ
;

320 
	sev_¥ï¨e


322 
EV_WATCHER
 (
ev_¥ï¨e
)

323 } 
	tev_¥ï¨e
;

327 
	sev_check


329 
EV_WATCHER
 (
ev_check
)

330 } 
	tev_check
;

332 #i‡
EV_FORK_ENABLE


334 
	sev_f‹k


336 
EV_WATCHER
 (
ev_f‹k
)

337 } 
	tev_f‹k
;

340 #i‡
EV_EMBED_ENABLE


343 
	sev_embed


345 
EV_WATCHER
 (
ev_embed
)

347 
ev_lo›
 *
Ÿhî
;

348 
ev_io
 
io
;

349 
ev_¥ï¨e
 
¥ï¨e
;

350 
ev_check
 
check
;

351 
ev_timî
 
timî
;

352 
ev_≥riodic
 
≥riodic
;

353 
ev_idÀ
 
idÀ
;

354 
ev_f‹k
 
f‹k
;

355 } 
	tev_embed
;

358 #i‡
EV_ASYNC_ENABLE


361 
	sev_async


363 
EV_WATCHER
 (
ev_async
)

365 
EV_ATOMIC_T
 
£¡
;

366 } 
	tev_async
;

368 
	#ev_async_≥ndög
(
w
Ë(+(w)->
£¡
)

	)

372 
	uev_™y_w©chî


374 
ev_w©chî
 
w
;

375 
ev_w©chî_li°
 
wl
;

377 
ev_io
 
io
;

378 
ev_timî
 
timî
;

379 
ev_≥riodic
 
≥riodic
;

380 
ev_sig«l
 
sig«l
;

381 
ev_chûd
 
chûd
;

382 #i‡
EV_STAT_ENABLE


383 
ev_°©
 
°©
;

385 #i‡
EV_IDLE_ENABLE


386 
ev_idÀ
 
idÀ
;

388 
ev_¥ï¨e
 
¥ï¨e
;

389 
ev_check
 
check
;

390 #i‡
EV_FORK_ENABLE


391 
ev_f‹k
 
f‹k
;

393 #i‡
EV_EMBED_ENABLE


394 
ev_embed
 
embed
;

396 #i‡
EV_ASYNC_ENABLE


397 
ev_async
 
async
;

403 
	#EVFLAG_AUTO
 0x00000000U

	)

405 
	#EVFLAG_NOENV
 0x01000000U

	)

406 
	#EVFLAG_FORKCHECK
 0x02000000U

	)

408 
	#EVFLAG_NOINOTIFY
 0x00100000U

	)

409 
	#EVFLAG_NOSIGFD
 0

	)

410 
	#EVFLAG_SIGNALFD
 0x00200000U

	)

412 
	#EVBACKEND_SELECT
 0x00000001U

	)

413 
	#EVBACKEND_POLL
 0x00000002U

	)

414 
	#EVBACKEND_EPOLL
 0x00000004U

	)

415 
	#EVBACKEND_KQUEUE
 0x00000008U

	)

416 
	#EVBACKEND_DEVPOLL
 0x00000010U

	)

417 
	#EVBACKEND_PORT
 0x00000020U

	)

418 
	#EVBACKEND_ALL
 0x0000003FU

	)

420 #i‡
EV_PROTOTYPES


421 
ev_vîsi⁄_maj‹
 ();

422 
ev_vîsi⁄_mö‹
 ();

424 
ev_suµ‹ãd_backíds
 ();

425 
ev_ªcommíded_backíds
 ();

426 
ev_embeddabÀ_backíds
 ();

428 
ev_t°amp
 
ev_time
 ();

429 
ev_¶ìp
 (
ev_t°amp
 
dñay
);

437 
ev_£t_Æloˇt‹
 (*(*
cb
)(*
±r
, 
size
));

443 
ev_£t_sy£º_cb
 ((*
cb
)(c⁄° *
msg
));

445 #i‡
EV_MULTIPLICITY


446 
EV_INLINE
 
ev_lo›
 *

447 
ev_deÁu…_lo›_uc
 ()

449 
ev_lo›
 *
ev_deÁu…_lo›_±r
;

451  
	gev_deÁu…_lo›_±r
;

456 
EV_INLINE
 
ev_lo›
 *

457 
ev_deÁu…_lo›
 (
Êags
)

459 
ev_lo›
 *
	glo›
 = 
ev_deÁu…_lo›_uc
 ();

461 i‡(!
	glo›
)

463 
ev_lo›
 *
ev_deÁu…_lo›_öô
 (
Êags
);

465 
	glo›
 = 
ev_deÁu…_lo›_öô
 (
Êags
);

468  
	glo›
;

472 
ev_lo›
 *
ev_lo›_√w
 (
Êags
);

473 
ev_lo›_de°roy
 (
EV_P
);

474 
ev_lo›_f‹k
 (
EV_P
);

476 
ev_t°amp
 
ev_now
 (
EV_P
);

480 
ev_deÁu…_lo›
 (
Êags
);

482 
EV_INLINE
 
ev_t°amp


483 
ev_now
 ()

485 
ev_t°amp
 
ev_π_now
;

487  
	gev_π_now
;

491 
EV_INLINE
 

492 
ev_is_deÁu…_lo›
 (
EV_P
)

494 #i‡
EV_MULTIPLICITY


495 
ev_lo›
 *
ev_deÁu…_lo›_±r
;

497  !!(
	gEV_A
 =
ev_deÁu…_lo›_±r
);

503 
ev_deÁu…_de°roy
 ();

508 
ev_deÁu…_f‹k
 ();

510 
ev_backíd
 (
EV_P
);

512 
ev_now_upd©e
 (
EV_P
);

514 #i‡
EV_WALK_ENABLE


518 
ev_wÆk
 (
EV_P_
 
ty≥s
, (*
cb
)(EV_P_ 
ty≥
, *
w
));

523 
	#EVLOOP_NONBLOCK
 1

	)

524 
	#EVLOOP_ONESHOT
 2

	)

525 
	#EVUNLOOP_CANCEL
 0

	)

526 
	#EVUNLOOP_ONE
 1

	)

527 
	#EVUNLOOP_ALL
 2

	)

529 #i‡
EV_PROTOTYPES


530 
ev_lo›
 (
EV_P_
 
Êags
);

531 
ev_u∆o›
 (
EV_P_
 
how
);

538 
ev_ªf
 (
EV_P
);

539 
ev_uƒef
 (
EV_P
);

545 
ev_⁄˚
 (
EV_P_
 
fd
, 
evíts
, 
ev_t°amp
 
timeout
, (*
cb
)(
ªvíts
, *
¨g
), *arg);

547 #i‡
EV_MINIMAL
 < 2

548 
ev_lo›_cou¡
 (
EV_P
);

549 
ev_lo›_dïth
 (
EV_P
);

550 
ev_lo›_vîify
 (
EV_P
);

552 
ev_£t_io_cﬁÀ˘_öãrvÆ
 (
EV_P_
 
ev_t°amp
 
öãrvÆ
);

553 
ev_£t_timeout_cﬁÀ˘_öãrvÆ
 (
EV_P_
 
ev_t°amp
 
öãrvÆ
);

556 
ev_£t_u£rd©a
 (
EV_P_
 *
d©a
);

557 *
ev_u£rd©a
 (
EV_P
);

558 
ev_£t_övoke_≥ndög_cb
 (
EV_P_
 (*
övoke_≥ndög_cb
)(
EV_P
));

559 
ev_£t_lo›_ªÀa£_cb
 (
EV_P_
 (*
ªÀa£
)(
EV_P
), (*
acquúe
)(EV_P));

561 
ev_≥ndög_cou¡
 (
EV_P
);

562 
ev_övoke_≥ndög
 (
EV_P
);

567 
ev_su•íd
 (
EV_P
);

568 
ev_ªsume
 (
EV_P
);

575 
	#ev_öô
(
ev
,
cb_
Ëdÿ{ \

	)

576 ((
	gev_w©chî
 *)(*)(
	gev
))->
	ga˘ive
 = \

577 ((
ev_w©chî
 *)(*)(
ev
))->
≥ndög
 = 0; \

578 
ev_£t_¥i‹ôy
 ((
ev
), 0); \

579 
ev_£t_cb
 ((
ev
), 
cb_
); \

582 
	#ev_io_£t
(
ev
,
fd_
,
evíts_
Ëdÿ{ (ev)->
fd
 = (fd_); (ev)->
evíts
 = (evíts_Ë| 
EV__IOFDSET
; } 0)

	)

583 
	#ev_timî_£t
(
ev
,
a·î_
,
ª≥©_
Ëdÿ{ ((
ev_w©chî_time
 *)”v))->
©
 = (a·î_); (ev)->
ª≥©
 = (ª≥©_); } 0)

	)

584 
	#ev_≥riodic_£t
(
ev
,
ofs_
,
ivÆ_
,
rcb_
Ëdÿ{ (ev)->
off£t
 = (ofs_); (ev)->
öãrvÆ
 = (ivÆ_); (ev)->
ªscheduÀ_cb
 = (rcb_); } 0)

	)

585 
	#ev_sig«l_£t
(
ev
,
signum_
Ëdÿ{ (ev)->
signum
 = (signum_); } 0)

	)

586 
	#ev_chûd_£t
(
ev
,
pid_
,
åa˚_
Ëdÿ{ (ev)->
pid
 = (pid_); (ev)->
Êags
 = !!—ø˚_); } 0)

	)

587 
	#ev_°©_£t
(
ev
,
∑th_
,
öãrvÆ_
Ëdÿ{ (ev)->
∑th
 = (∑th_); (ev)->
öãrvÆ
 = (öãrvÆ_); (ev)->
wd
 = -2; } 0)

	)

588 
	#ev_idÀ_£t
(
ev
Ë

	)

589 
	#ev_¥ï¨e_£t
(
ev
Ë

	)

590 
	#ev_check_£t
(
ev
Ë

	)

591 
	#ev_embed_£t
(
ev
,
Ÿhî_
Ëdÿ{ (ev)->
Ÿhî
 = (Ÿhî_); } 0)

	)

592 
	#ev_f‹k_£t
(
ev
Ë

	)

593 
	#ev_async_£t
(
ev
Ëdÿ{ (ev)->
£¡
 = 0; } 0)

	)

595 
	#ev_io_öô
(
ev
,
cb
,
fd
,
evíts
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_io_£t
 (”v),(fd),”víts)); } 0)

	)

596 
	#ev_timî_öô
(
ev
,
cb
,
a·î
,
ª≥©
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_timî_£t
 (”v),◊·î),‘ïót)); } 0)

	)

597 
	#ev_≥riodic_öô
(
ev
,
cb
,
ofs
,
ivÆ
,
rcb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_≥riodic_£t
 (”v),(ofs),(ivÆ),‘cb)); } 0)

	)

598 
	#ev_sig«l_öô
(
ev
,
cb
,
signum
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_sig«l_£t
 (”v), (signum)); } 0)

	)

599 
	#ev_chûd_öô
(
ev
,
cb
,
pid
,
åa˚
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_chûd_£t
 (”v),’id),—ø˚)); } 0)

	)

600 
	#ev_°©_öô
(
ev
,
cb
,
∑th
,
öãrvÆ
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_°©_£t
 (”v),’©h),(öãrvÆ)); } 0)

	)

601 
	#ev_idÀ_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_idÀ_£t
 (”v)); } 0)

	)

602 
	#ev_¥ï¨e_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_¥ï¨e_£t
 (”v)); } 0)

	)

603 
	#ev_check_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_check_£t
 (”v)); } 0)

	)

604 
	#ev_embed_öô
(
ev
,
cb
,
Ÿhî
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_embed_£t
 (”v),(Ÿhî)); } 0)

	)

605 
	#ev_f‹k_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_f‹k_£t
 (”v)); } 0)

	)

606 
	#ev_async_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_async_£t
 (”v)); } 0)

	)

608 
	#ev_is_≥ndög
(
ev
Ë(0 + ((
ev_w©chî
 *)(*)”v))->
≥ndög
Ë

	)

609 
	#ev_is_a˘ive
(
ev
Ë(0 + ((
ev_w©chî
 *)(*)”v))->
a˘ive
Ë

	)

611 
	#ev_cb
(
ev
Ë”v)->
cb


	)

613 #i‡
EV_MINPRI
 =
EV_MAXPRI


614 
	#ev_¥i‹ôy
(
ev
Ë(”v), 
EV_MINPRI
)

	)

615 
	#ev_£t_¥i‹ôy
(
ev
,
¥i
Ë(”v), (¥i))

	)

617 
	#ev_¥i‹ôy
(
ev
Ë(+(((
ev_w©chî
 *)(*)”v))->
¥i‹ôy
))

	)

618 
	#ev_£t_¥i‹ôy
(
ev
,
¥i
Ë–(
ev_w©chî
 *)(*)”v))->
¥i‹ôy
 = (¥i)

	)

621 
	#ev_≥riodic_©
(
ev
Ë(+((
ev_w©chî_time
 *)”v))->
©
)

	)

623 #i‚de‡
ev_£t_cb


624 
	#ev_£t_cb
(
ev
,
cb_
Ë
	`ev_cb
 (evË(cb_)

	)

629 #i‡
EV_PROTOTYPES


633 
ev_„ed_evít
 (
EV_P_
 *
w
, 
ªvíts
);

634 
ev_„ed_fd_evít
 (
EV_P_
 
fd
, 
ªvíts
);

635 
ev_„ed_sig«l_evít
 (
EV_P_
 
signum
);

636 
ev_övoke
 (
EV_P_
 *
w
, 
ªvíts
);

637 
ev_˛ór_≥ndög
 (
EV_P_
 *
w
);

639 
ev_io_°¨t
 (
EV_P_
 
ev_io
 *
w
);

640 
ev_io_°›
 (
EV_P_
 
ev_io
 *
w
);

642 
ev_timî_°¨t
 (
EV_P_
 
ev_timî
 *
w
);

643 
ev_timî_°›
 (
EV_P_
 
ev_timî
 *
w
);

645 
ev_timî_agaö
 (
EV_P_
 
ev_timî
 *
w
);

647 
ev_t°amp
 
ev_timî_ªmaöög
 (
EV_P_
 
ev_timî
 *
w
);

649 #i‡
EV_PERIODIC_ENABLE


650 
ev_≥riodic_°¨t
 (
EV_P_
 
ev_≥riodic
 *
w
);

651 
ev_≥riodic_°›
 (
EV_P_
 
ev_≥riodic
 *
w
);

652 
ev_≥riodic_agaö
 (
EV_P_
 
ev_≥riodic
 *
w
);

656 
ev_sig«l_°¨t
 (
EV_P_
 
ev_sig«l
 *
w
);

657 
ev_sig«l_°›
 (
EV_P_
 
ev_sig«l
 *
w
);

660 
ev_chûd_°¨t
 (
EV_P_
 
ev_chûd
 *
w
);

661 
ev_chûd_°›
 (
EV_P_
 
ev_chûd
 *
w
);

663 #i‡
EV_STAT_ENABLE


664 
ev_°©_°¨t
 (
EV_P_
 
ev_°©
 *
w
);

665 
ev_°©_°›
 (
EV_P_
 
ev_°©
 *
w
);

666 
ev_°©_°©
 (
EV_P_
 
ev_°©
 *
w
);

669 #i‡
EV_IDLE_ENABLE


670 
ev_idÀ_°¨t
 (
EV_P_
 
ev_idÀ
 *
w
);

671 
ev_idÀ_°›
 (
EV_P_
 
ev_idÀ
 *
w
);

674 
ev_¥ï¨e_°¨t
 (
EV_P_
 
ev_¥ï¨e
 *
w
);

675 
ev_¥ï¨e_°›
 (
EV_P_
 
ev_¥ï¨e
 *
w
);

677 
ev_check_°¨t
 (
EV_P_
 
ev_check
 *
w
);

678 
ev_check_°›
 (
EV_P_
 
ev_check
 *
w
);

680 #i‡
EV_FORK_ENABLE


681 
ev_f‹k_°¨t
 (
EV_P_
 
ev_f‹k
 *
w
);

682 
ev_f‹k_°›
 (
EV_P_
 
ev_f‹k
 *
w
);

685 #i‡
EV_EMBED_ENABLE


687 
ev_embed_°¨t
 (
EV_P_
 
ev_embed
 *
w
);

688 
ev_embed_°›
 (
EV_P_
 
ev_embed
 *
w
);

689 
ev_embed_swìp
 (
EV_P_
 
ev_embed
 *
w
);

692 #i‡
EV_ASYNC_ENABLE


693 
ev_async_°¨t
 (
EV_P_
 
ev_async
 *
w
);

694 
ev_async_°›
 (
EV_P_
 
ev_async
 *
w
);

695 
ev_async_£nd
 (
EV_P_
 
ev_async
 *
w
);

700 #ifde‡
__˝lu•lus


	@libev-examples/paired-threaded-ipc/include/loop.h

1 #i‚de‡
_LOOP_H_


2 
	#_LOOP_H_


	)

4 
	~"boﬁ.h
"

5 
	#lo›
 
åue
)

	)

	@libev-examples/paired-threaded-ipc/include/rand.h

1 
ölöe
 

2 
øndom_gë
(
max
);

4 
ölöe
 

5 
øndom_ö_ønge
(
mö
, 
max
);

7 
ölöe
 

8 
øndom_ö_ønge_≥r˚¡
(
ba£
, 
≥r˚¡
);

	@libev-examples/paired-threaded-ipc/rand-test.c

1 
	~<°dio.h
>

3 
	~"ønd.h
"

5 c⁄° 
	gLOW
 = 1;

6 c⁄° 
	gHIGH
 = 6;

8 
ölöe
 

9 
	$rﬁl
()

13  
	`øndom_ö_ønge_≥r˚¡
(128, 15);

14 
	}
}

16 
	$maö
()

18 
	`¥ötf
("YouÑﬁ»[%d] [%d]\n", 
	`rﬁl
(),Ñoll());

19 
	`¥ötf
("PCÑﬁl†[%d] [%d]\n", 
	`rﬁl
(),Ñoll());

22 
	}
}

	@libev-examples/paired-threaded-ipc/rand.c

1 
	~<°dlib.h
>

2 
	~<uni°d.h
>

3 
	~<sys/time.h
>

5 
	~"ønd.h
"

7 
ölöe
 

8 
	$øndom_öô
()

10 
timevÆ
 
ç
;

11 
	`gëtimeofday
(&
ç
, 
NULL
);

12 
	`§™d
((Ë
ç
.
tv_u£c
 + (Ë
	`gëpid
());

13 
	}
}

15 
ölöe
 

16 
	$øndom_gë
(
max
) {

17  
	`øndom_ö_ønge
(0, 
max
);

18 
	}
}

20 
ölöe
 

21 
	$øndom_ö_ønge
(
mö
, 
max
)

23 
öôülized
 = 0;

25 i‡(!
öôülized
) {

26 
	`øndom_öô
();

27 
öôülized
 = 1;

30  
	`ønd
(Ë% (
max
 - 
mö
 + 1) + min;

31 
	}
}

33 
	~<°dio.h
>

34 
ölöe
 

35 
	$øndom_ö_ønge_≥r˚¡
(
ba£
, 
≥r˚¡
)

37 
≥r˚¡age
;

38 
v¨ün˚
;

40 
≥r˚¡age
 = 
≥r˚¡
 / 100.0;

41 
v¨ün˚
 = (Ë(
≥r˚¡age
 * 
ba£
);

42 
v¨ün˚
 = 
	`øndom_gë
(variance * 2) - variance;

44  
ba£
 + 
v¨ün˚
;

45 
	}
}

	@libev-examples/src/array-heap.c

1 
	~<°dlib.h
>

2 
	~<°dio.h
>

4 
	~"¨øy-hóp.h
"

6 
	$¨øy_öô
(
¨øy
* 
¨r
, 
size
) {

7 
¨r
->
d©a
 = 
	`ªÆloc
(
NULL
, (*Ë* 
size
);

8 i‡(0 =(
size_t
)
¨r
->
d©a
) {

11 
¨r
->
Àngth
 = 
size
;

12 
¨r
->
ödex
 = 0;

14 
	}
}

16 
	$¨øy_push
(
¨øy
* 
¨r
, * 
d©a
) {

17 ((
size_t
*)
¨r
->
d©a
)[¨r->
ödex
] = (size_t)data;

18 
¨r
->
ödex
 += 1;

19 i‡(
¨r
->
ödex
 >¨r->
Àngth
) {

20 i‡(-1 =
	`¨øy_grow
(
¨r
,áº->
Àngth
 * 2))

25  
¨r
->
ödex
 - 1;

26 
	}
}

28 
	$¨øy_grow
(
¨øy
* 
¨r
, 
size
) {

29 i‡(
size
 <
¨r
->
Àngth
) {

32 
¨r
->
d©a
 = 
	`ªÆloc
◊º->d©a, (*Ë* 
size
);

33 i‡(-1 =(
size_t
)
¨r
->
d©a
) {

36 
¨r
->
Àngth
 = 
size
;

38 
	}
}

40 
	$¨øy_‰ì
(
¨øy
* 
¨r
, (*
‰ì_ñemít
)(*)) {

41 
i
;

42 
i
 = 0; i < 
¨r
->
ödex
; i += 1) {

43 
	`‰ì_ñemít
((*)((
size_t
*)
¨r
->
d©a
)[
i
]);

45 
	`‰ì
(
¨r
->
d©a
);

46 
¨r
->
ödex
 = -1;

47 
¨r
->
Àngth
 = 0;

48 
¨r
->
d©a
 = 
NULL
;

49 
	}
}

	@libev-examples/src/array-test.c

1 
	~<°dio.h
>

3 
	~"¨øy_hóp.h
"

5 
‰ì_msg
(* 
msg
);

7 
	$maö
(
¨gc
, * 
¨gv
[]) {

8 
¨øy
 
¨r
;

9 * 
msg
 = "Hello World!";

10 
i
;

11 
	`¥ötf
("¥e-öô:Üígth %i, index %i\n", 
¨r
.
Àngth
,áº.
ödex
);

13 
	`¨øy_öô
(&
¨r
, 32);

14 
	`¥ötf
("po°-öô:Üígth %i, index %i\n", 
¨r
.
Àngth
,áº.
ödex
);

16 
i
 = 0; i < 64; i += 1) {

17 
	`¨øy_push
(&
¨r
, 
msg
);

19 
	`¥ötf
("po°-add:Üígth %i, index %i\n", 
¨r
.
Àngth
,áº.
ödex
);

21 
	`¨øy_‰ì
(&
¨r
, 
‰ì_msg
);

22 
	`¥ötf
("po°-‰ì:Üígth %i, index %i\n", 
¨r
.
Àngth
,áº.
ödex
);

24 
	`¥ötf
("didn't segfault\n");

26 
	}
}

28 
	$‰ì_msg
(* 
msg
) {

31 
	}
}

	@libev-examples/src/udp-echo-server.c

3 
	~<°dio.h
>

4 
	~<°rög.h
>

5 
	~<°dlib.h
>

6 
	~<ev.h
>

8 
	~<î∫o.h
>

9 
	~<sys/sockë.h
>

10 
	~<ªsﬁv.h
>

11 
	~<uni°d.h
>

13 
	#DEFAULT_PORT
 3333

	)

14 
	#BUF_SIZE
 4096

	)

17 
	gsd
;

18 
sockaddr_ö
 
	gaddr
;

19 
	gaddr_Àn
 = (
addr
);

20 
	gbuf„r
[
BUF_SIZE
];

23 
	$udp_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

24 
	`puts
("udp socket has becomeÑeadable");

25 
sockÀn_t
 
byãs
 = 
	`ªcv‰om
(
sd
, 
buf„r
, (buf„rË- 1, 0, (
sockaddr
*Ë&
addr
, (sockÀn_à*Ë&
addr_Àn
);

28 
buf„r
[
byãs
] = '\0';

30 
	`¥ötf
("ud∞˛õ¡ said: %s", 
buf„r
);

35 
	`£ndto
(
sd
, 
buf„r
, 
byãs
, 0, (
sockaddr
*Ë&
addr
, (addr));

36 
	}
}

38 
	$maö
() {

39 
p‹t
 = 
DEFAULT_PORT
;

40 
	`puts
("udp_echo server started...");

43 
sd
 = 
	`sockë
(
PF_INET
, 
SOCK_DGRAM
, 0);

44 
	`bzîo
(&
addr
, (addr));

45 
addr
.
sö_Ámûy
 = 
AF_INET
;

46 
addr
.
sö_p‹t
 = 
	`ht⁄s
(
p‹t
);

47 
addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

48 i‡(
	`böd
(
sd
, (
sockaddr
*Ë&
addr
, (addr)) != 0)

49 
	`≥º‹
("bind");

52 
ev_lo›
 *
lo›
 = 
	`ev_deÁu…_lo›
(0);

53 
ev_io
 
udp_w©chî
;

54 
	`ev_io_öô
(&
udp_w©chî
, 
udp_cb
, 
sd
, 
EV_READ
);

55 
	`ev_io_°¨t
(
lo›
, &
udp_w©chî
);

56 
	`ev_lo›
(
lo›
, 0);

59 
	`˛o£
(
sd
);

60  
EXIT_SUCCESS
;

61 
	}
}

	@libev-examples/src/unix-echo-client.c

1 
	~<°dlib.h
>

2 
	~<°dio.h
>

3 
	~<ev.h
>

4 
	~<sys/sockë.h
>

5 
	~<sys/un.h
>

6 
	~<î∫o.h
>

7 
	~<°rög.h
>

8 
	~<sys/f˙é.h
>

9 
	~<uni°d.h
>

16 
	gEV_P
;

17 
ev_io
 
	g°dö_w©chî
;

18 
ev_io
 
	gªmŸe_w
;

19 
ev_io
 
	g£nd_w
;

20 
	gªmŸe_fd
;

21 * 
	glöe
 = 
NULL
;

22 
size_t
 
	gÀn
 = 0;

24 
	$£nd_cb
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

26 i‡(
ªvíts
 & 
EV_WRITE
)

28 
	`puts
 ("remoteÑeady for writing...");

30 i‡(-1 =
	`£nd
(
ªmŸe_fd
, 
löe
, 
Àn
, 0)) {

31 
	`≥º‹
("echo send");

32 
	`exô
(
EXIT_FAILURE
);

37 
	`ev_io_°›
(
EV_A_
 &
£nd_w
);

38 
	`ev_io_£t
(&
£nd_w
, 
ªmŸe_fd
, 
EV_READ
);

39 
	`ev_io_°¨t
(
EV_A_
 &
£nd_w
);

41 i‡(
ªvíts
 & 
EV_READ
)

43 
n
;

44 
°r
[100] = ".\0";

46 
	`¥ötf
("[r,remote]");

47 
n
 = 
	`ªcv
(
ªmŸe_fd
, 
°r
, 100, 0);

48 i‡(
n
 <= 0) {

49 i‡(0 =
n
) {

51 
	`puts
("orderly disconnect");

52 
	`ev_io_°›
(
EV_A_
 &
£nd_w
);

53 
	`˛o£
(
ªmŸe_fd
);

54 } i‡(
EAGAIN
 =
î∫o
) {

55 
	`puts
("shouldÇever get inÅhis state withÜibev");

57 
	`≥º‹
("recv");

61 
	`¥ötf
("sockë clõ¡ said: %s", 
°r
);

64 
	}
}

66 
	$°dö_cb
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

68 
Àn2
;

70 
	`puts
 ("stdin writtenÅo,Ñeading...");

71 
Àn2
 = 
	`gëlöe
(&
löe
, &
Àn
, 
°dö
);

72 
	`ev_io_°›
(
EV_A_
 &
£nd_w
);

73 
	`ev_io_£t
 (&
£nd_w
, 
ªmŸe_fd
, 
EV_READ
 | 
EV_WRITE
);

74 
	`ev_io_°¨t
(
EV_A_
 &
£nd_w
);

75 
	}
}

77 
	$ªmŸe_cb
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

79 
	`puts
 ("connected,Çow watching stdin");

81 
	`ev_io_°¨t
(
EV_A_
 &
°dö_w©chî
);

83 
	`ev_io_°›
(
EV_A_
 &
ªmŸe_w
);

84 
	}
}

88 
	$£ä⁄block
(
fd
)

90 
Êags
;

92 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
);

93 
Êags
 |
O_NONBLOCK
;

94  
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
);

95 
	}
}

97 
	$c⁄√˘i⁄_√w
(
EV_P_
 * 
sock_∑th
) {

98 
Àn
;

99 
sockaddr_un
 
ªmŸe
;

101 i‡(-1 =(
ªmŸe_fd
 = 
	`sockë
(
AF_UNIX
, 
SOCK_STREAM
, 0))) {

102 
	`≥º‹
("socket");

103 
	`exô
(1);

107 i‡(-1 =
	`£ä⁄block
(
ªmŸe_fd
)) {

108 
	`≥º‹
("echo client socketÇonblock");

109 
	`exô
(
EXIT_FAILURE
);

117 
	`ev_io_öô
 (&
ªmŸe_w
, 
ªmŸe_cb
, 
ªmŸe_fd
, 
EV_WRITE
);

118 
	`ev_io_°¨t
(
EV_A_
 &
ªmŸe_w
);

120 
	`ev_io_öô
(&
£nd_w
, 
£nd_cb
, 
ªmŸe_fd
, 
EV_READ
);

121 
	`ev_io_°¨t
(
EV_A_
 &
£nd_w
);

123 
ªmŸe
.
sun_Ámûy
 = 
AF_UNIX
;

124 
	`°r˝y
(
ªmŸe
.
sun_∑th
, 
sock_∑th
);

125 
Àn
 = 
	`°æí
(
ªmŸe
.
sun_∑th
Ë+ ‘emŸe.
sun_Ámûy
);

127 i‡(-1 =
	`c⁄√˘
(
ªmŸe_fd
, (
sockaddr
 *)&
ªmŸe
, 
Àn
)) {

128 
	`≥º‹
("connect");

131 
	}
}

133 
	$maö
 ()

135 
lo›
 = 
EV_DEFAULT
;

138 
	`£ä⁄block
(0);

139 
	`ev_io_öô
(&
°dö_w©chî
, 
°dö_cb
, 0, 
EV_READ
);

141 
	`c⁄√˘i⁄_√w
(
EV_A_
 "/tmp/libev-echo.sock");

144 
	`ev_lo›
(
EV_A_
 0);

148 
	}
}

	@libev-examples/src/unix-echo-server.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<î∫o.h
>

4 
	~<°rög.h
>

5 
	~<f˙é.h
>

7 
	~<sys/ty≥s.h
>

8 
	~<sys/sockë.h
>

9 
	~<sys/un.h
>

11 
	~<ev.h
>

13 
	#g_w¨nög
 
¥ötf


	)

16 
	~<uni°d.h
>

18 
	~"¨øy-hóp.h
"

20 
	ssock_ev_£rv
 {

21 
ev_io
 
	mio
;

22 
	mfd
;

23 
sockaddr_un
 
	msockë
;

24 
	msockë_Àn
;

25 
¨øy
 
	m˛õ¡s
;

28 
	ssock_ev_˛õ¡
 {

29 
ev_io
 
	mio
;

30 
	mfd
;

31 
	mödex
;

32 
sock_ev_£rv
* 
	m£rvî
;

35 
£ä⁄block
(
fd
);

36 
nŸ_blocked
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
);

39 
	$˛õ¡_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

42 
sock_ev_˛õ¡
* 
˛õ¡
 = (sock_ev_˛õ¡*Ë
w
;

44 
n
;

45 
°r
[100] = ".\0";

47 
	`¥ötf
("[r]");

48 
n
 = 
	`ªcv
(
˛õ¡
->
fd
, 
°r
, 100, 0);

49 i‡(
n
 <= 0) {

50 i‡(0 =
n
) {

52 
	`puts
("orderly disconnect");

53 
	`ev_io_°›
(
EV_A_
 &
˛õ¡
->
io
);

54 
	`˛o£
(
˛õ¡
->
fd
);

55 } i‡(
EAGAIN
 =
î∫o
) {

56 
	`puts
("shouldÇever get inÅhis state withÜibev");

58 
	`≥º‹
("recv");

62 
	`¥ötf
("sockë clõ¡ said: %s", 
°r
);

65 i‡(
	`£nd
(
˛õ¡
->
fd
, 
°r
, 
n
, 0) < 0) {

66 
	`≥º‹
("send");

68 
	}
}

70 
ölöe
 
sock_ev_˛õ¡
* 
	$˛õ¡_√w
(
fd
) {

71 
sock_ev_˛õ¡
* 
˛õ¡
;

73 
˛õ¡
 = 
	`ªÆloc
(
NULL
, (
sock_ev_˛õ¡
));

74 
˛õ¡
->
fd
 = fd;

76 
	`£ä⁄block
(
˛õ¡
->
fd
);

77 
	`ev_io_öô
(&
˛õ¡
->
io
, 
˛õ¡_cb
, clõ¡->
fd
, 
EV_READ
);

79  
˛õ¡
;

80 
	}
}

83 
	$£rvî_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

84 
	`puts
("unix stream socket has becomeÑeadable");

86 
˛õ¡_fd
;

87 
sock_ev_˛õ¡
* 
˛õ¡
;

92 
sock_ev_£rv
* 
£rvî
 = (sock_ev_£rv*Ë
w
;

96 
˛õ¡_fd
 = 
	`ac˚±
(
£rvî
->
fd
, 
NULL
, NULL);

97 if–
˛õ¡_fd
 == -1 )

99 if–
î∫o
 !
EAGAIN
 &&Éºnÿ!
EWOULDBLOCK
 )

101 
	`g_w¨nög
("ac˚±(ËÁûedÉºno=%ò(%s)", 
î∫o
, 
	`°ªº‹
(errno));

102 
	`exô
(
EXIT_FAILURE
);

106 
	`puts
("acceptedá client");

107 
˛õ¡
 = 
	`˛õ¡_√w
(
˛õ¡_fd
);

108 
˛õ¡
->
£rvî
 = server;

109 
˛õ¡
->
ödex
 = 
	`¨øy_push
(&
£rvî
->
˛õ¡s
, client);

110 
	`ev_io_°¨t
(
EV_A_
 &
˛õ¡
->
io
);

112 
	}
}

115 
	$£ä⁄block
(
fd
)

117 
Êags
;

119 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
);

120 
Êags
 |
O_NONBLOCK
;

121  
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
);

122 
	}
}

124 
	$unix_sockë_öô
(
sockaddr_un
* 
sockë_un
, * 
sock_∑th
, 
max_queue
) {

125 
fd
;

127 
	`u∆ök
(
sock_∑th
);

130 
fd
 = 
	`sockë
(
AF_UNIX
, 
SOCK_STREAM
, 0);

131 i‡(-1 =
fd
) {

132 
	`≥º‹
("echo server socket");

133 
	`exô
(
EXIT_FAILURE
);

137 i‡(-1 =
	`£ä⁄block
(
fd
)) {

138 
	`≥º‹
("echo server socketÇonblock");

139 
	`exô
(
EXIT_FAILURE
);

143 
sockë_un
->
sun_Ámûy
 = 
AF_UNIX
;

144 
	`°r˝y
(
sockë_un
->
sun_∑th
, 
sock_∑th
);

146  
fd
;

147 
	}
}

149 
	$£rvî_öô
(
sock_ev_£rv
* 
£rvî
, * 
sock_∑th
, 
max_queue
) {

150 
£rvî
->
fd
 = 
	`unix_sockë_öô
(&£rvî->
sockë
, 
sock_∑th
, 
max_queue
);

151 
£rvî
->
sockë_Àn
 = (£rvî->
sockë
.
sun_Ámûy
Ë+ 
	`°æí
(£rvî->sockë.
sun_∑th
);

153 
	`¨øy_öô
(&
£rvî
->
˛õ¡s
, 128);

155 i‡(-1 =
	`böd
(
£rvî
->
fd
, (
sockaddr
*Ë&£rvî->
sockë
, sîvî->
sockë_Àn
))

157 
	`≥º‹
("echo server bind");

158 
	`exô
(
EXIT_FAILURE
);

161 i‡(-1 =
	`li°í
(
£rvî
->
fd
, 
max_queue
)) {

162 
	`≥º‹
("listen");

163 
	`exô
(
EXIT_FAILURE
);

166 
	}
}

168 
	$maö
() {

169 
max_queue
 = 128;

170 
sock_ev_£rv
 
£rvî
;

171 
ev_≥riodic
 
evîy_„w_£c⁄ds
;

173 
EV_P
 = 
	`ev_deÁu…_lo›
(0);

176 
	`£rvî_öô
(&
£rvî
, "/tmp/libev-echo.sock", 
max_queue
);

179 
	`ev_≥riodic_öô
(&
evîy_„w_£c⁄ds
, 
nŸ_blocked
, 0, 5, 0);

180 
	`ev_≥riodic_°¨t
(
EV_A_
 &
evîy_„w_£c⁄ds
);

183 
	`ev_io_öô
(&
£rvî
.
io
, 
£rvî_cb
, sîvî.
fd
, 
EV_READ
);

184 
	`ev_io_°¨t
(
EV_A_
 &
£rvî
.
io
);

187 
	`puts
("unix-socket-echo starting...\n");

188 
	`ev_lo›
(
EV_A_
 0);

191 
	`˛o£
(
£rvî
.
fd
);

192  
EXIT_SUCCESS
;

193 
	}
}

196 
	$nŸ_blocked
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
) {

197 
	`puts
("I'mÇot blocked");

198 
	}
}

	@libev/config.h

5 
	#HAVE_CLOCK_GETTIME
 1

	)

11 
	#HAVE_DLFCN_H
 1

	)

14 
	#HAVE_EPOLL_CTL
 1

	)

17 
	#HAVE_EVENTFD
 1

	)

20 
	#HAVE_FLOOR
 1

	)

23 
	#HAVE_INOTIFY_INIT
 1

	)

26 
	#HAVE_INTTYPES_H
 1

	)

35 
	#HAVE_MEMORY_H
 1

	)

38 
	#HAVE_NANOSLEEP
 1

	)

41 
	#HAVE_POLL
 1

	)

44 
	#HAVE_POLL_H
 1

	)

53 
	#HAVE_SELECT
 1

	)

56 
	#HAVE_SIGNALFD
 1

	)

59 
	#HAVE_STDINT_H
 1

	)

62 
	#HAVE_STDLIB_H
 1

	)

65 
	#HAVE_STRINGS_H
 1

	)

68 
	#HAVE_STRING_H
 1

	)

71 
	#HAVE_SYS_EPOLL_H
 1

	)

74 
	#HAVE_SYS_EVENTFD_H
 1

	)

80 
	#HAVE_SYS_INOTIFY_H
 1

	)

83 
	#HAVE_SYS_SELECT_H
 1

	)

86 
	#HAVE_SYS_SIGNALFD_H
 1

	)

89 
	#HAVE_SYS_STAT_H
 1

	)

92 
	#HAVE_SYS_TYPES_H
 1

	)

95 
	#HAVE_UNISTD_H
 1

	)

99 
	#LT_OBJDIR
 ".libs/"

	)

102 
	#PACKAGE
 "libev"

	)

105 
	#PACKAGE_BUGREPORT
 ""

	)

108 
	#PACKAGE_NAME
 ""

	)

111 
	#PACKAGE_STRING
 ""

	)

114 
	#PACKAGE_TARNAME
 ""

	)

117 
	#PACKAGE_URL
 ""

	)

120 
	#PACKAGE_VERSION
 ""

	)

123 
	#STDC_HEADERS
 1

	)

126 
	#VERSION
 "4.22"

	)

	@libev/ev++.h

40 #i‚de‡
EVPP_H__


41 
	#EVPP_H__


	)

43 #ifde‡
EV_H


44 #ö˛udê
EV_H


46 
	~"ev.h
"

49 #i‚de‡
EV_USE_STDEXCEPT


50 
	#EV_USE_STDEXCEPT
 1

	)

53 #i‡
EV_USE_STDEXCEPT


54 
	~<°dex˚±
>

57 
«me•a˚
 
	gev
 {

59 
ev_t°amp
 
	tt°amp
;

62 
	gUNDEF
 = 
EV_UNDEF
,

63 
	gNONE
 = 
EV_NONE
,

64 
	gREAD
 = 
EV_READ
,

65 
	gWRITE
 = 
EV_WRITE
,

66 #i‡
EV_COMPAT3


67 
	gTIMEOUT
 = 
EV_TIMEOUT
,

69 
	gTIMER
 = 
EV_TIMER
,

70 
	gPERIODIC
 = 
EV_PERIODIC
,

71 
	gSIGNAL
 = 
EV_SIGNAL
,

72 
	gCHILD
 = 
EV_CHILD
,

73 
	gSTAT
 = 
EV_STAT
,

74 
	gIDLE
 = 
EV_IDLE
,

75 
	gCHECK
 = 
EV_CHECK
,

76 
	gPREPARE
 = 
EV_PREPARE
,

77 
	gFORK
 = 
EV_FORK
,

78 
	gASYNC
 = 
EV_ASYNC
,

79 
	gEMBED
 = 
EV_EMBED
,

80 #unde‡
ERROR


81 
	gERROR
 = 
EV_ERROR


86 
	gAUTO
 = 
EVFLAG_AUTO
,

87 
	gNOENV
 = 
EVFLAG_NOENV
,

88 
	gFORKCHECK
 = 
EVFLAG_FORKCHECK
,

90 
	gSELECT
 = 
EVBACKEND_SELECT
,

91 
	gPOLL
 = 
EVBACKEND_POLL
,

92 
	gEPOLL
 = 
EVBACKEND_EPOLL
,

93 
	gKQUEUE
 = 
EVBACKEND_KQUEUE
,

94 
	gDEVPOLL
 = 
EVBACKEND_DEVPOLL
,

95 
	gPORT
 = 
EVBACKEND_PORT


100 #i‡
EV_COMPAT3


101 
	gNONBLOCK
 = 
EVLOOP_NONBLOCK
,

102 
	gONESHOT
 = 
EVLOOP_ONESHOT
,

104 
	gNOWAIT
 = 
EVRUN_NOWAIT
,

105 
	gONCE
 = 
EVRUN_ONCE


108 
	ehow_t


110 
	gONE
 = 
EVBREAK_ONE
,

111 
	gALL
 = 
EVBREAK_ALL


114 
	gbad_lo›


115 #i‡
EV_USE_STDEXCEPT


116 : 
°d
::
ru¡ime_îr‹


119 #i‡
EV_USE_STDEXCEPT


120 
bad_lo›
 ()

121 : 
°d
::
ru¡ime_îr‹
 ("libevÉventÜoop cannot be initialized, bad value of LIBEV_FLAGS?")

127 #ifde‡
EV_AX


128 #unde‡
EV_AX


131 #ifde‡
EV_AX_


132 #unde‡
EV_AX_


135 #i‡
EV_MULTIPLICITY


136 
	#EV_AX
 
øw_lo›


	)

137 
	#EV_AX_
 
øw_lo›
,

	)

139 
	#EV_AX


	)

140 
	#EV_AX_


	)

143 
	slo›_ªf


145 
lo›_ªf
 (
EV_P
Ë
throw
 ()

146 #i‡
EV_MULTIPLICITY


147 : 
EV_AX
 (
EV_A
)

152 
boﬁ
 
›î©‹
 =(c⁄° 
lo›_ªf
 &
Ÿhî
Ëc⁄° 
throw
 ()

154 #i‡
EV_MULTIPLICITY


155  
EV_AX
 =
Ÿhî
.EV_AX;

157  
	gåue
;

161 
boﬁ
 
	g›î©‹
 !(c⁄° 
lo›_ªf
 &
Ÿhî
Ëc⁄° 
throw
 ()

163 #i‡
EV_MULTIPLICITY


164  ! (*
this
 =
Ÿhî
);

166  
	gÁl£
;

170 #i‡
EV_MULTIPLICITY


171 
boﬁ
 
	g›î©‹
 =(c⁄° 
EV_P
Ëc⁄° 
throw
 ()

173  
this
->
EV_AX
 =
EV_A
;

176 
boﬁ
 
	g›î©‹
 !(c⁄° 
EV_P
Ëc⁄° 
throw
 ()

178  (*
this
 =
EV_A
);

181 
›î©‹
 
	gev_lo›
 * (Ëc⁄° 
throw
 ()

183  
	gEV_AX
;

186 
›î©‹
 c⁄° 
	gev_lo›
 * (Ëc⁄° 
throw
 ()

188  
	gEV_AX
;

191 
boﬁ
 
is_deÁu…
 (Ëc⁄° 
throw
 ()

193  
	gEV_AX
 =
ev_deÁu…_lo›
 (0);

197 #i‡
EV_COMPAT3


198 
lo›
 (
Êags
 = 0)

200 
ev_run
 (
EV_AX_
 
Êags
);

203 
u∆o›
 (
how_t
 
how
 = 
ONE
Ë
throw
 ()

205 
ev_bªak
 (
EV_AX_
 
how
);

209 
run
 (
Êags
 = 0)

211 
ev_run
 (
EV_AX_
 
Êags
);

214 
bªak_lo›
 (
how_t
 
how
 = 
ONE
Ë
throw
 ()

216 
ev_bªak
 (
EV_AX_
 
how
);

219 
po°_f‹k
 (Ë
throw
 ()

221 
ev_lo›_f‹k
 (
EV_AX
);

224 
backíd
 (Ëc⁄° 
throw
 ()

226  
ev_backíd
 (
EV_AX
);

229 
t°amp
 
now
 (Ëc⁄° 
throw
 ()

231  
ev_now
 (
EV_AX
);

234 
ªf
 (Ë
throw
 ()

236 
ev_ªf
 (
EV_AX
);

239 
uƒef
 (Ë
throw
 ()

241 
ev_uƒef
 (
EV_AX
);

244 #i‡
EV_FEATURE_API


245 
ôî©i⁄
 (Ëc⁄° 
throw
 ()

247  
ev_ôî©i⁄
 (
EV_AX
);

250 
dïth
 (Ëc⁄° 
throw
 ()

252  
ev_dïth
 (
EV_AX
);

255 
£t_io_cﬁÀ˘_öãrvÆ
 (
t°amp
 
öãrvÆ
Ë
throw
 ()

257 
ev_£t_io_cﬁÀ˘_öãrvÆ
 (
EV_AX_
 
öãrvÆ
);

260 
£t_timeout_cﬁÀ˘_öãrvÆ
 (
t°amp
 
öãrvÆ
Ë
throw
 ()

262 
ev_£t_timeout_cﬁÀ˘_öãrvÆ
 (
EV_AX_
 
öãrvÆ
);

267 
⁄˚
 (
fd
, 
evíts
, 
t°amp
 
timeout
, (*
cb
)(, *), *
¨g
 = 0Ë
throw
 ()

269 
ev_⁄˚
 (
EV_AX_
 
fd
, 
evíts
, 
timeout
, 
cb
, 
¨g
);

273 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)()>

274 
⁄˚
 (
fd
, 
evíts
, 
t°amp
 
timeout
, 
K
 *
obje˘
Ë
throw
 ()

276 
⁄˚
 (
fd
, 
evíts
, 
timeout
, 
mëhod_thunk
<
K
, 
mëhod
>, 
obje˘
);

280 
	gãm∂©e
<
˛ass
 
	gK
>

281 
⁄˚
 (
fd
, 
evíts
, 
t°amp
 
timeout
, 
K
 *
obje˘
Ë
throw
 ()

283 
⁄˚
 (
fd
, 
evíts
, 
timeout
, 
mëhod_thunk
<
K
, &K::
›î©‹
 ()>, 
obje˘
);

286 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)()>

287 
mëhod_thunk
 (
ªvíts
, *
¨g
)

289 (
	g°©ic_ˇ°
<
	gK
 *>(
	g¨g
)->*
	gmëhod
)

290 (
	gªvíts
);

294 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)()>

295 
⁄˚
 (
fd
, 
evíts
, 
t°amp
 
timeout
, 
K
 *
obje˘
Ë
throw
 ()

297 
⁄˚
 (
fd
, 
evíts
, 
timeout
, 
mëhod_nﬂrgs_thunk
<
K
, 
mëhod
>, 
obje˘
);

300 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)()>

301 
mëhod_nﬂrgs_thunk
 (
ªvíts
, *
¨g
)

303 (
	g°©ic_ˇ°
<
	gK
 *>(
	g¨g
)->*
	gmëhod
)

308 
	gãm∂©e
<(*
	gcb
)()>

309 
⁄˚
 (
fd
, 
evíts
, 
t°amp
 
timeout
Ë
throw
 ()

311 
⁄˚
 (
fd
, 
evíts
, 
timeout
, 
sim∂î_func_thunk
<
cb
>);

314 
	gãm∂©e
<(*
	gcb
)()>

315 
sim∂î_func_thunk
 (
ªvíts
, *
¨g
)

317 (*
	gcb
)

318 (
	gªvíts
);

322 
	gãm∂©e
<(*
	gcb
)()>

323 
⁄˚
 (
fd
, 
evíts
, 
t°amp
 
timeout
Ë
throw
 ()

325 
⁄˚
 (
fd
, 
evíts
, 
timeout
, 
sim∂e°_func_thunk
<
cb
>);

328 
	gãm∂©e
<(*
	gcb
)()>

329 
sim∂e°_func_thunk
 (
ªvíts
, *
¨g
)

331 (*
	gcb
)

335 
„ed_fd_evít
 (
fd
, 
ªvíts
Ë
throw
 ()

337 
ev_„ed_fd_evít
 (
EV_AX_
 
fd
, 
ªvíts
);

340 
„ed_sig«l_evít
 (
signum
Ë
throw
 ()

342 
ev_„ed_sig«l_evít
 (
EV_AX_
 
signum
);

345 #i‡
EV_MULTIPLICITY


346 
ev_lo›
* 
	gEV_AX
;

351 #i‡
EV_MULTIPLICITY


352 
	gdy«mic_lo›
 : 
lo›_ªf


355 
dy«mic_lo›
 (
Êags
 = 
AUTO
Ë
throw
 (
bad_lo›
)

356 : 
lo›_ªf
 (
ev_lo›_√w
 (
Êags
))

358 i‡(!
EV_AX
)

359 
throw
 
bad_lo›
 ();

362 ~
dy«mic_lo›
 (Ë
throw
 ()

364 
ev_lo›_de°roy
 (
EV_AX
);

365 
	gEV_AX
 = 0;

368 
	g¥iv©e
:

370 
dy«mic_lo›
 (const dynamic_loop &);

372 
	gdy«mic_lo›
 & 
	g›î©‹
(c⁄° 
dy«mic_lo›
 &);

377 
	gdeÁu…_lo›
 : 
lo›_ªf


379 
deÁu…_lo›
 (
Êags
 = 
AUTO
Ë
throw
 (
bad_lo›
)

380 #i‡
EV_MULTIPLICITY


381 : 
lo›_ªf
 (
ev_deÁu…_lo›
 (
Êags
))

385 #i‡
EV_MULTIPLICITY


386 !
EV_AX


388 !
ev_deÁu…_lo›
 (
Êags
)

391 
throw
 
bad_lo›
 ();

394 
	g¥iv©e
:

395 
deÁu…_lo›
 (const default_loop &);

396 
	gdeÁu…_lo›
 &
	g›î©‹
 = (c⁄° 
deÁu…_lo›
 &);

399 
ölöe
 
lo›_ªf
 
gë_deÁu…_lo›
 (Ë
throw
 ()

401 #i‡
EV_MULTIPLICITY


402  
ev_deÁu…_lo›
 (0);

404  
lo›_ªf
 ();

408 #unde‡
EV_AX


409 #unde‡
EV_AX_


411 #unde‡
EV_PX


412 #unde‡
EV_PX_


413 #i‡
EV_MULTIPLICITY


414 
	#EV_PX
 
lo›_ªf
 
EV_A


	)

415 
	#EV_PX_
 
lo›_ªf
 
EV_A_


	)

417 
	#EV_PX


	)

418 
	#EV_PX_


	)

421 
	gãm∂©e
<
˛ass
 
	gev_w©chî
, cœs†
	gw©chî
>

422 
	gba£
 : 
ev_w©chî


424 #i‡
EV_MULTIPLICITY


425 
EV_PX
;

428 
£t
 (
EV_P
Ë
throw
 ()

430 
	gthis
->
	gEV_A
 = 
EV_A
;

434 
ba£
 (
EV_PX
Ë
throw
 ()

435 #i‡
EV_MULTIPLICITY


436 : 
EV_A
 (EV_A)

439 
ev_öô
 (
this
, 0);

442 
£t_
 (c⁄° *
d©a
, (*
cb
)(
EV_P_
 
ev_w©chî
 *
w
, 
ªvíts
)Ë
throw
 ()

444 
	gthis
->
	gd©a
 = (*)
d©a
;

445 
ev_£t_cb
 (
°©ic_ˇ°
<
ev_w©chî
 *>(
this
), 
cb
);

449 
	gãm∂©e
<(*
	gfun˘i⁄
)(
	gw©chî
 &
	gw
, )>

450 
£t
 (*
d©a
 = 0Ë
throw
 ()

452 
£t_
 (
d©a
, 
fun˘i⁄_thunk
<
fun˘i⁄
>);

455 
	gãm∂©e
<(*
	gfun˘i⁄
)(
	gw©chî
 &
	gw
, )>

456 
fun˘i⁄_thunk
 (
EV_P_
 
ev_w©chî
 *
w
, 
ªvíts
)

458 
	gfun˘i⁄


459 (*
	g°©ic_ˇ°
<
	gw©chî
 *>(
	gw
), 
	gªvíts
);

463 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)(
w©chî
 &
w
, )>

464 
£t
 (
K
 *
obje˘
Ë
throw
 ()

466 
£t_
 (
obje˘
, 
mëhod_thunk
<
K
, 
mëhod
>);

470 
	gãm∂©e
<
˛ass
 
	gK
>

471 
£t
 (
K
 *
obje˘
Ë
throw
 ()

473 
£t_
 (
obje˘
, 
mëhod_thunk
<
K
, &K::
›î©‹
 ()>);

476 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)(
w©chî
 &
w
, )>

477 
mëhod_thunk
 (
EV_P_
 
ev_w©chî
 *
w
, 
ªvíts
)

479 (
	g°©ic_ˇ°
<
	gK
 *>(
	gw
->
	gd©a
)->*
	gmëhod
)

480 (*
	g°©ic_ˇ°
<
	gw©chî
 *>(
	gw
), 
	gªvíts
);

484 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)()>

485 
£t
 (
K
 *
obje˘
Ë
throw
 ()

487 
£t_
 (
obje˘
, 
mëhod_nﬂrgs_thunk
<
K
, 
mëhod
>);

490 
	gãm∂©e
<
˛ass
 
	gK
, (K::*
mëhod
)()>

491 
mëhod_nﬂrgs_thunk
 (
EV_P_
 
ev_w©chî
 *
w
, 
ªvíts
)

493 (
	g°©ic_ˇ°
<
	gK
 *>(
	gw
->
	gd©a
)->*
	gmëhod
)

497 
›î©‹
 ()(
	gevíts
 = 
EV_UNDEF
)

500 
ev_cb
 (
°©ic_ˇ°
<
ev_w©chî
 *>(
this
))

501 (
°©ic_ˇ°
<
ev_w©chî
 *>(
this
), 
evíts
);

504 
boﬁ
 
is_a˘ive
 (Ëc⁄° 
throw
 ()

506  
ev_is_a˘ive
 (
°©ic_ˇ°
<c⁄° 
ev_w©chî
 *>(
this
));

509 
boﬁ
 
is_≥ndög
 (Ëc⁄° 
throw
 ()

511  
ev_is_≥ndög
 (
°©ic_ˇ°
<c⁄° 
ev_w©chî
 *>(
this
));

514 
„ed_evít
 (
ªvíts
Ë
throw
 ()

516 
ev_„ed_evít
 (
EV_A_
 
°©ic_ˇ°
<
ev_w©chî
 *>(
this
), 
ªvíts
);

520 
ölöe
 
t°amp
 
now
 (
EV_P
Ë
throw
 ()

522  
ev_now
 (
EV_A
);

525 
ölöe
 
dñay
 (
t°amp
 
öãrvÆ
Ë
throw
 ()

527 
ev_¶ìp
 (
öãrvÆ
);

530 
ölöe
 
vîsi⁄_maj‹
 (Ë
throw
 ()

532  
ev_vîsi⁄_maj‹
 ();

535 
ölöe
 
vîsi⁄_mö‹
 (Ë
throw
 ()

537  
ev_vîsi⁄_mö‹
 ();

540 
ölöe
 
suµ‹ãd_backíds
 (Ë
throw
 ()

542  
ev_suµ‹ãd_backíds
 ();

545 
ölöe
 
ªcommíded_backíds
 (Ë
throw
 ()

547  
ev_ªcommíded_backíds
 ();

550 
ölöe
 
embeddabÀ_backíds
 (Ë
throw
 ()

552  
ev_embeddabÀ_backíds
 ();

555 
ölöe
 
£t_Æloˇt‹
 (*(*
cb
)(*
±r
, 
size
Ë
throw
 ())Åhrow ()

557 
ev_£t_Æloˇt‹
 (
cb
);

560 
ölöe
 
£t_sy£º_cb
 ((*
cb
)(c⁄° *
msg
Ë
throw
 ())Åhrow ()

562 
ev_£t_sy£º_cb
 (
cb
);

565 #i‡
EV_MULTIPLICITY


566 
	#EV_CONSTRUCT
(
˝p°em
,
c°em
) \

567 (
EV_PX
 = 
	`gë_deÁu…_lo›
 ()Ë
	`throw
 () \

568 : 
ba£
<
ev_
 ## 
c°em
, 
˝p°em
> (
EV_A
) \

570 }

	)

572 
	#EV_CONSTRUCT
(
˝p°em
,
c°em
) \

573 (Ë
	`throw
 () \

575 }

	)

580 
	#EV_BEGIN_WATCHER
(
˝p°em
,
c°em
) \

582 
˝p°em
 : 
ba£
<
ev_
 ## 
c°em
, cppstem> \

584 
	`°¨t
 (Ë
	`throw
 () \

586 
ev_
 ## 
c°em
 ## 
	`_°¨t
 (
EV_A_
 
°©ic_ˇ°
<ev_ ## c°em *>(
this
)); \

589 
	`°›
 (Ë
	`throw
 () \

591 
ev_
 ## 
c°em
 ## 
	`_°›
 (
EV_A_
 
°©ic_ˇ°
<ev_ ## c°em *>(
this
)); \

594 
˝p°em
 
	`EV_CONSTRUCT
(˝p°em,
c°em
) \

596 ~
	`˝p°em
 (Ë
	`throw
 () \

598 
	`°›
 (); \

601 
usög
 
ba£
<
ev_
 ## 
c°em
, 
˝p°em
>::
£t
; \

603 
¥iv©e
: \

605 
	`˝p°em
 (c⁄° 
˝p°em
 &
o
); \

607 
˝p°em
 &
›î©‹
 =(c⁄° cµ°em &
o
); \

609 
public
:

	)

611 
	#EV_END_WATCHER
(
˝p°em
,
c°em
) \

612 };

	)

614 
EV_BEGIN_WATCHER
 (
io
, io)

615 
£t
 (
fd
, 
evíts
Ë
throw
 ()

617 
	ga˘ive
 = 
is_a˘ive
 ();

618 i‡(
	ga˘ive
Ë
°›
 ();

619 
ev_io_£t
 (
°©ic_ˇ°
<
ev_io
 *>(
this
), 
fd
, 
evíts
);

620 i‡(
	ga˘ive
Ë
°¨t
 ();

623 
£t
 (
evíts
Ë
throw
 ()

625 
	ga˘ive
 = 
is_a˘ive
 ();

626 i‡(
	ga˘ive
Ë
°›
 ();

627 
ev_io_£t
 (
°©ic_ˇ°
<
ev_io
 *>(
this
), 
fd
, 
evíts
);

628 i‡(
	ga˘ive
Ë
°¨t
 ();

631 
°¨t
 (
fd
, 
evíts
Ë
throw
 ()

633 
£t
 (
fd
, 
evíts
);

634 
°¨t
 ();

636 
EV_END_WATCHER
 (
io
, io)

638 
EV_BEGIN_WATCHER
 (
timî
,Åimer)

639 
£t
 (
ev_t°amp
 
a·î
,Év_t°am∞
ª≥©
 = 0.Ë
throw
 ()

641 
a˘ive
 = 
is_a˘ive
 ();

642 i‡(
	ga˘ive
Ë
°›
 ();

643 
ev_timî_£t
 (
°©ic_ˇ°
<
ev_timî
 *>(
this
), 
a·î
, 
ª≥©
);

644 i‡(
	ga˘ive
Ë
°¨t
 ();

647 
°¨t
 (
ev_t°amp
 
a·î
,Év_t°am∞
ª≥©
 = 0.Ë
throw
 ()

649 
£t
 (
a·î
, 
ª≥©
);

650 
°¨t
 ();

653 
agaö
 (Ë
throw
 ()

655 
ev_timî_agaö
 (
EV_A_
 
°©ic_ˇ°
<
ev_timî
 *>(
this
));

658 
ev_t°amp
 
ªmaöög
 ()

660  
ev_timî_ªmaöög
 (
EV_A_
 
°©ic_ˇ°
<
ev_timî
 *>(
this
));

662 
EV_END_WATCHER
 (
timî
,Åimer)

664 #i‡
EV_PERIODIC_ENABLE


665 
EV_BEGIN_WATCHER
 (
≥riodic
,Öeriodic)

666 
£t
 (
ev_t°amp
 
©
,Év_t°am∞
öãrvÆ
 = 0.Ë
throw
 ()

668 
a˘ive
 = 
is_a˘ive
 ();

669 i‡(
	ga˘ive
Ë
°›
 ();

670 
ev_≥riodic_£t
 (
°©ic_ˇ°
<
ev_≥riodic
 *>(
this
), 
©
, 
öãrvÆ
, 0);

671 i‡(
	ga˘ive
Ë
°¨t
 ();

674 
°¨t
 (
ev_t°amp
 
©
,Év_t°am∞
öãrvÆ
 = 0.Ë
throw
 ()

676 
£t
 (
©
, 
öãrvÆ
);

677 
°¨t
 ();

680 
agaö
 (Ë
throw
 ()

682 
ev_≥riodic_agaö
 (
EV_A_
 
°©ic_ˇ°
<
ev_≥riodic
 *>(
this
));

684 
EV_END_WATCHER
 (
≥riodic
,Öeriodic)

687 #i‡
EV_SIGNAL_ENABLE


688 
EV_BEGIN_WATCHER
 (
sig
, 
sig«l
)

689 
£t
 (
signum
Ë
throw
 ()

691 
	ga˘ive
 = 
is_a˘ive
 ();

692 i‡(
	ga˘ive
Ë
°›
 ();

693 
ev_sig«l_£t
 (
°©ic_ˇ°
<
ev_sig«l
 *>(
this
), 
signum
);

694 i‡(
	ga˘ive
Ë
°¨t
 ();

697 
°¨t
 (
signum
Ë
throw
 ()

699 
£t
 (
signum
);

700 
°¨t
 ();

702 
EV_END_WATCHER
 (
sig
, 
sig«l
)

705 #i‡
EV_CHILD_ENABLE


706 
EV_BEGIN_WATCHER
 (
chûd
, child)

707 
£t
 (
pid
, 
åa˚
 = 0Ë
throw
 ()

709 
a˘ive
 = 
is_a˘ive
 ();

710 i‡(
	ga˘ive
Ë
°›
 ();

711 
ev_chûd_£t
 (
°©ic_ˇ°
<
ev_chûd
 *>(
this
), 
pid
, 
åa˚
);

712 i‡(
	ga˘ive
Ë
°¨t
 ();

715 
°¨t
 (
pid
, 
åa˚
 = 0Ë
throw
 ()

717 
£t
 (
pid
, 
åa˚
);

718 
°¨t
 ();

720 
EV_END_WATCHER
 (
chûd
, child)

723 #i‡
EV_STAT_ENABLE


724 
EV_BEGIN_WATCHER
 (
°©
, stat)

725 
£t
 (c⁄° *
∑th
, 
ev_t°amp
 
öãrvÆ
 = 0.Ë
throw
 ()

727 
a˘ive
 = 
is_a˘ive
 ();

728 i‡(
	ga˘ive
Ë
°›
 ();

729 
ev_°©_£t
 (
°©ic_ˇ°
<
ev_°©
 *>(
this
), 
∑th
, 
öãrvÆ
);

730 i‡(
	ga˘ive
Ë
°¨t
 ();

733 
°¨t
 (c⁄° *
∑th
, 
ev_t°amp
 
öãrvÆ
 = 0.Ë
throw
 ()

735 
°›
 ();

736 
£t
 (
∑th
, 
öãrvÆ
);

737 
°¨t
 ();

740 
upd©e
 (Ë
throw
 ()

742 
ev_°©_°©
 (
EV_A_
 
°©ic_ˇ°
<
ev_°©
 *>(
this
));

744 
EV_END_WATCHER
 (
°©
, stat)

747 #i‡
EV_IDLE_ENABLE


748 
EV_BEGIN_WATCHER
 (
idÀ
, idle)

749 
£t
 (Ë
throw
 () { }

750 
EV_END_WATCHER
 (
idÀ
, idle)

753 #i‡
EV_PREPARE_ENABLE


754 
EV_BEGIN_WATCHER
 (
¥ï¨e
,Örepare)

755 
£t
 (Ë
throw
 () { }

756 
EV_END_WATCHER
 (
¥ï¨e
,Örepare)

759 #i‡
EV_CHECK_ENABLE


760 
EV_BEGIN_WATCHER
 (
check
, check)

761 
£t
 (Ë
throw
 () { }

762 
EV_END_WATCHER
 (
check
, check)

765 #i‡
EV_EMBED_ENABLE


766 
EV_BEGIN_WATCHER
 (
embed
,Émbed)

767 
£t_embed
 (
ev_lo›
 *
embedded_lo›
Ë
throw
 ()

769 
	ga˘ive
 = 
is_a˘ive
 ();

770 i‡(
	ga˘ive
Ë
°›
 ();

771 
ev_embed_£t
 (
°©ic_ˇ°
<
ev_embed
 *>(
this
), 
embedded_lo›
);

772 i‡(
	ga˘ive
Ë
°¨t
 ();

775 
°¨t
 (
ev_lo›
 *
embedded_lo›
Ë
throw
 ()

777 
£t
 (
embedded_lo›
);

778 
°¨t
 ();

781 
swìp
 ()

783 
ev_embed_swìp
 (
EV_A_
 
°©ic_ˇ°
<
ev_embed
 *>(
this
));

785 
EV_END_WATCHER
 (
embed
,Émbed)

788 #i‡
EV_FORK_ENABLE


789 
EV_BEGIN_WATCHER
 (
f‹k
, fork)

790 
£t
 (Ë
throw
 () { }

791 
EV_END_WATCHER
 (
f‹k
, fork)

794 #i‡
EV_ASYNC_ENABLE


795 
EV_BEGIN_WATCHER
 (
async
,ásync)

796 
£nd
 (Ë
throw
 ()

798 
ev_async_£nd
 (
EV_A_
 
°©ic_ˇ°
<
ev_async
 *>(
this
));

801 
boﬁ
 
async_≥ndög
 (Ë
throw
 ()

803  
ev_async_≥ndög
 (
°©ic_ˇ°
<
ev_async
 *>(
this
));

805 
EV_END_WATCHER
 (
async
,ásync)

808 #unde‡
EV_PX


809 #unde‡
EV_PX_


810 #unde‡
EV_CONSTRUCT


811 #unde‡
EV_BEGIN_WATCHER


812 #unde‡
EV_END_WATCHER


	@libev/ev.c

41 #i‚de‡
EV_STANDALONE


42 #ifde‡
EV_CONFIG_H


43 #ö˛udê
EV_CONFIG_H


45 
	~"c⁄fig.h
"

48 #i‡
HAVE_FLOOR


49 #i‚de‡
EV_USE_FLOOR


50 
	#EV_USE_FLOOR
 1

	)

54 #i‡
HAVE_CLOCK_SYSCALL


55 #i‚de‡
EV_USE_CLOCK_SYSCALL


56 
	#EV_USE_CLOCK_SYSCALL
 1

	)

57 #i‚de‡
EV_USE_REALTIME


58 
	#EV_USE_REALTIME
 0

	)

60 #i‚de‡
EV_USE_MONOTONIC


61 
	#EV_USE_MONOTONIC
 1

	)

64 #ñi‡!
deföed
 
EV_USE_CLOCK_SYSCALL


65 
	#EV_USE_CLOCK_SYSCALL
 0

	)

68 #i‡
HAVE_CLOCK_GETTIME


69 #i‚de‡
EV_USE_MONOTONIC


70 
	#EV_USE_MONOTONIC
 1

	)

72 #i‚de‡
EV_USE_REALTIME


73 
	#EV_USE_REALTIME
 0

	)

76 #i‚de‡
EV_USE_MONOTONIC


77 
	#EV_USE_MONOTONIC
 0

	)

79 #i‚de‡
EV_USE_REALTIME


80 
	#EV_USE_REALTIME
 0

	)

84 #i‡
HAVE_NANOSLEEP


85 #i‚de‡
EV_USE_NANOSLEEP


86 
	#EV_USE_NANOSLEEP
 
EV_FEATURE_OS


	)

89 #unde‡
EV_USE_NANOSLEEP


90 
	#EV_USE_NANOSLEEP
 0

	)

93 #i‡
HAVE_SELECT
 && 
HAVE_SYS_SELECT_H


94 #i‚de‡
EV_USE_SELECT


95 
	#EV_USE_SELECT
 
EV_FEATURE_BACKENDS


	)

98 #unde‡
EV_USE_SELECT


99 
	#EV_USE_SELECT
 0

	)

102 #i‡
HAVE_POLL
 && 
HAVE_POLL_H


103 #i‚de‡
EV_USE_POLL


104 
	#EV_USE_POLL
 
EV_FEATURE_BACKENDS


	)

107 #unde‡
EV_USE_POLL


108 
	#EV_USE_POLL
 0

	)

111 #i‡
HAVE_EPOLL_CTL
 && 
HAVE_SYS_EPOLL_H


112 #i‚de‡
EV_USE_EPOLL


113 
	#EV_USE_EPOLL
 
EV_FEATURE_BACKENDS


	)

116 #unde‡
EV_USE_EPOLL


117 
	#EV_USE_EPOLL
 0

	)

120 #i‡
HAVE_KQUEUE
 && 
HAVE_SYS_EVENT_H


121 #i‚de‡
EV_USE_KQUEUE


122 
	#EV_USE_KQUEUE
 
EV_FEATURE_BACKENDS


	)

125 #unde‡
EV_USE_KQUEUE


126 
	#EV_USE_KQUEUE
 0

	)

129 #i‡
HAVE_PORT_H
 && 
HAVE_PORT_CREATE


130 #i‚de‡
EV_USE_PORT


131 
	#EV_USE_PORT
 
EV_FEATURE_BACKENDS


	)

134 #unde‡
EV_USE_PORT


135 
	#EV_USE_PORT
 0

	)

138 #i‡
HAVE_INOTIFY_INIT
 && 
HAVE_SYS_INOTIFY_H


139 #i‚de‡
EV_USE_INOTIFY


140 
	#EV_USE_INOTIFY
 
EV_FEATURE_OS


	)

143 #unde‡
EV_USE_INOTIFY


144 
	#EV_USE_INOTIFY
 0

	)

147 #i‡
HAVE_SIGNALFD
 && 
HAVE_SYS_SIGNALFD_H


148 #i‚de‡
EV_USE_SIGNALFD


149 
	#EV_USE_SIGNALFD
 
EV_FEATURE_OS


	)

152 #unde‡
EV_USE_SIGNALFD


153 
	#EV_USE_SIGNALFD
 0

	)

156 #i‡
HAVE_EVENTFD


157 #i‚de‡
EV_USE_EVENTFD


158 
	#EV_USE_EVENTFD
 
EV_FEATURE_OS


	)

161 #unde‡
EV_USE_EVENTFD


162 
	#EV_USE_EVENTFD
 0

	)

167 
	~<°dlib.h
>

168 
	~<°rög.h
>

169 
	~<f˙é.h
>

170 
	~<°ddef.h
>

172 
	~<°dio.h
>

174 
	~<as£π.h
>

175 
	~<î∫o.h
>

176 
	~<sys/ty≥s.h
>

177 
	~<time.h
>

178 
	~<limôs.h
>

180 
	~<sig«l.h
>

182 #ifde‡
EV_H


183 #ö˛udê
EV_H


185 
	~"ev.h
"

188 #i‡
EV_NO_THREADS


189 #unde‡
EV_NO_SMP


190 
	#EV_NO_SMP
 1

	)

191 #unde‡
ECB_NO_THREADS


192 
	#ECB_NO_THREADS
 1

	)

194 #i‡
EV_NO_SMP


195 #unde‡
EV_NO_SMP


196 
	#ECB_NO_SMP
 1

	)

199 #i‚de‡
_WIN32


200 
	~<sys/time.h
>

201 
	~<sys/waô.h
>

202 
	~<uni°d.h
>

204 
	~<io.h
>

205 
	#WIN32_LEAN_AND_MEAN


	)

206 
	~<wösock2.h
>

207 
	~<wödows.h
>

208 #i‚de‡
EV_SELECT_IS_WINSOCKET


209 
	#EV_SELECT_IS_WINSOCKET
 1

	)

211 #unde‡
EV_AVOID_STDIO


220 
	#_DARWIN_UNLIMITED_SELECT
 1

	)

225 #i‡
deföed
 
EV_NSIG


227 #ñi‡
deföed
 
NSIG


228 
	#EV_NSIG
 (
NSIG
)

	)

229 #ñi‡
deföed
 
_NSIG


230 
	#EV_NSIG
 (
_NSIG
)

	)

231 #ñi‡
deföed
 
SIGMAX


232 
	#EV_NSIG
 (
SIGMAX
+1)

	)

233 #ñi‡
deföed
 
SIG_MAX


234 
	#EV_NSIG
 (
SIG_MAX
+1)

	)

235 #ñi‡
deföed
 
_SIG_MAX


236 
	#EV_NSIG
 (
_SIG_MAX
+1)

	)

237 #ñi‡
deföed
 
MAXSIG


238 
	#EV_NSIG
 (
MAXSIG
+1)

	)

239 #ñi‡
deföed
 
MAX_SIG


240 
	#EV_NSIG
 (
MAX_SIG
+1)

	)

241 #ñi‡
deföed
 
SIGARRAYSIZE


242 
	#EV_NSIG
 (
SIGARRAYSIZE
Ë

	)

243 #ñi‡
deföed
 
_sys_nsig


244 
	#EV_NSIG
 (
_sys_nsig
Ë

	)

246 
	#EV_NSIG
 (8 *  (
sig£t_t
Ë+ 1)

	)

249 #i‚de‡
EV_USE_FLOOR


250 
	#EV_USE_FLOOR
 0

	)

253 #i‚de‡
EV_USE_CLOCK_SYSCALL


254 #i‡
__löux
 && 
__GLIBC__
 =2 && 
__GLIBC_MINOR__
 < 17

255 
	#EV_USE_CLOCK_SYSCALL
 
EV_FEATURE_OS


	)

257 
	#EV_USE_CLOCK_SYSCALL
 0

	)

261 #i‡!(
_POSIX_TIMERS
 > 0)

262 #i‚de‡
EV_USE_MONOTONIC


263 
	#EV_USE_MONOTONIC
 0

	)

265 #i‚de‡
EV_USE_REALTIME


266 
	#EV_USE_REALTIME
 0

	)

270 #i‚de‡
EV_USE_MONOTONIC


271 #i‡
deföed
 
_POSIX_MONOTONIC_CLOCK
 && _POSIX_MONOTONIC_CLOCK >= 0

272 
	#EV_USE_MONOTONIC
 
EV_FEATURE_OS


	)

274 
	#EV_USE_MONOTONIC
 0

	)

278 #i‚de‡
EV_USE_REALTIME


279 
	#EV_USE_REALTIME
 !
EV_USE_CLOCK_SYSCALL


	)

282 #i‚de‡
EV_USE_NANOSLEEP


283 #i‡
_POSIX_C_SOURCE
 >= 199309L

284 
	#EV_USE_NANOSLEEP
 
EV_FEATURE_OS


	)

286 
	#EV_USE_NANOSLEEP
 0

	)

290 #i‚de‡
EV_USE_SELECT


291 
	#EV_USE_SELECT
 
EV_FEATURE_BACKENDS


	)

294 #i‚de‡
EV_USE_POLL


295 #ifde‡
_WIN32


296 
	#EV_USE_POLL
 0

	)

298 
	#EV_USE_POLL
 
EV_FEATURE_BACKENDS


	)

302 #i‚de‡
EV_USE_EPOLL


303 #i‡
__löux
 && (
__GLIBC__
 > 2 || (__GLIBC__ =2 && 
__GLIBC_MINOR__
 >= 4))

304 
	#EV_USE_EPOLL
 
EV_FEATURE_BACKENDS


	)

306 
	#EV_USE_EPOLL
 0

	)

310 #i‚de‡
EV_USE_KQUEUE


311 
	#EV_USE_KQUEUE
 0

	)

314 #i‚de‡
EV_USE_PORT


315 
	#EV_USE_PORT
 0

	)

318 #i‚de‡
EV_USE_INOTIFY


319 #i‡
__löux
 && (
__GLIBC__
 > 2 || (__GLIBC__ =2 && 
__GLIBC_MINOR__
 >= 4))

320 
	#EV_USE_INOTIFY
 
EV_FEATURE_OS


	)

322 
	#EV_USE_INOTIFY
 0

	)

326 #i‚de‡
EV_PID_HASHSIZE


327 
	#EV_PID_HASHSIZE
 
EV_FEATURE_DATA
 ? 16 : 1

	)

330 #i‚de‡
EV_INOTIFY_HASHSIZE


331 
	#EV_INOTIFY_HASHSIZE
 
EV_FEATURE_DATA
 ? 16 : 1

	)

334 #i‚de‡
EV_USE_EVENTFD


335 #i‡
__löux
 && (
__GLIBC__
 > 2 || (__GLIBC__ =2 && 
__GLIBC_MINOR__
 >= 7))

336 
	#EV_USE_EVENTFD
 
EV_FEATURE_OS


	)

338 
	#EV_USE_EVENTFD
 0

	)

342 #i‚de‡
EV_USE_SIGNALFD


343 #i‡
__löux
 && (
__GLIBC__
 > 2 || (__GLIBC__ =2 && 
__GLIBC_MINOR__
 >= 7))

344 
	#EV_USE_SIGNALFD
 
EV_FEATURE_OS


	)

346 
	#EV_USE_SIGNALFD
 0

	)

351 
	#EV_VERIFY
 3

	)

352 
	#EV_USE_4HEAP
 1

	)

353 
	#EV_HEAP_CACHE_AT
 1

	)

356 #i‚de‡
EV_VERIFY


357 
	#EV_VERIFY
 (
EV_FEATURE_API
 ? 1 : 0)

	)

360 #i‚de‡
EV_USE_4HEAP


361 
	#EV_USE_4HEAP
 
EV_FEATURE_DATA


	)

364 #i‚de‡
EV_HEAP_CACHE_AT


365 
	#EV_HEAP_CACHE_AT
 
EV_FEATURE_DATA


	)

368 #ifde‡
ANDROID


370 #unde‡
EV_USE_SELECT


371 
	#EV_USE_SELECT
 0

	)

373 #unde‡
EV_USE_CLOCK_SYSCALL


374 
	#EV_USE_CLOCK_SYSCALL
 0

	)

378 #ifde‡
_AIX


380 #unde‡
EV_USE_POLL


381 
	#EV_USE_POLL
 0

	)

386 #i‡
EV_USE_CLOCK_SYSCALL


387 
	~<sys/sysˇŒ.h
>

388 #ifde‡
SYS_˛ock_gëtime


389 
	#˛ock_gëtime
(
id
, 
ts
Ë
	`sysˇŒ
 (
SYS_˛ock_gëtime
, (id), (ts))

	)

390 #unde‡
EV_USE_MONOTONIC


391 
	#EV_USE_MONOTONIC
 1

	)

393 #unde‡
EV_USE_CLOCK_SYSCALL


394 
	#EV_USE_CLOCK_SYSCALL
 0

	)

400 #i‚de‡
CLOCK_MONOTONIC


401 #unde‡
EV_USE_MONOTONIC


402 
	#EV_USE_MONOTONIC
 0

	)

405 #i‚de‡
CLOCK_REALTIME


406 #unde‡
EV_USE_REALTIME


407 
	#EV_USE_REALTIME
 0

	)

410 #i‡!
EV_STAT_ENABLE


411 #unde‡
EV_USE_INOTIFY


412 
	#EV_USE_INOTIFY
 0

	)

415 #i‡!
EV_USE_NANOSLEEP


417 #i‡!
deföed
 
_WIN32
 && !deföed 
__hpux


418 
	~<sys/£À˘.h
>

422 #i‡
EV_USE_INOTIFY


423 
	~<sys/°©fs.h
>

424 
	~<sys/öŸify.h
>

426 #i‚de‡
IN_DONT_FOLLOW


427 #unde‡
EV_USE_INOTIFY


428 
	#EV_USE_INOTIFY
 0

	)

432 #i‡
EV_USE_EVENTFD


434 
	~<°döt.h
>

435 #i‚de‡
EFD_NONBLOCK


436 
	#EFD_NONBLOCK
 
O_NONBLOCK


	)

438 #i‚de‡
EFD_CLOEXEC


439 #ifde‡
O_CLOEXEC


440 
	#EFD_CLOEXEC
 
O_CLOEXEC


	)

442 
	#EFD_CLOEXEC
 02000000

	)

445 
EV_CPP
("C"Ë(
evítfd
Ë(
öôvÆ
, 
Êags
);

448 #i‡
EV_USE_SIGNALFD


450 
	~<°döt.h
>

451 #i‚de‡
SFD_NONBLOCK


452 
	#SFD_NONBLOCK
 
O_NONBLOCK


	)

454 #i‚de‡
SFD_CLOEXEC


455 #ifde‡
O_CLOEXEC


456 
	#SFD_CLOEXEC
 
O_CLOEXEC


	)

458 
	#SFD_CLOEXEC
 02000000

	)

461 
	`EV_CPP
 ("C"Ë
	`sig«lfd
 (
fd
, c⁄° 
sig£t_t
 *
mask
, 
Êags
);

463 
	ssig«lfd_sigöfo


465 
uöt32_t
 
ssi_signo
;

466 
∑d
[128 -  (
uöt32_t
)];

472 #i‡
EV_VERIFY
 >= 3

473 
	#EV_FREQUENT_CHECK
 
	`ev_vîify
 (
EV_A
)

	)

475 
	#EV_FREQUENT_CHECK
 dÿ{ 
	}
} 0)

	)

482 
	#MIN_INTERVAL
 0.0001220703125

	)

485 
	#MIN_TIMEJUMP
 1.

	)

486 
	#MAX_BLOCKTIME
 59.743

	)

488 
	#EV_TV_SET
(
tv
,
t
Ëdÿ{Åv.
tv_£c
 = (È;Åv.
tv_u£c
 = ()(— -Åv.tv_£cË* 1e6); } 0)

	)

489 
	#EV_TS_SET
(
ts
,
t
Ëdÿ{Ås.
tv_£c
 = (È;Ås.
tv_n£c
 = ()(— -Ås.tv_£cË* 1e9); } 0)

	)

533 #i‚de‡
ECB_H


534 
	#ECB_H


	)

537 
	#ECB_VERSION
 0x00010005

	)

539 #ifde‡
_WIN32


540 sig√d 
	töt8_t
;

541 
	tuöt8_t
;

542 sig√d 
	töt16_t
;

543 
	tuöt16_t
;

544 sig√d 
	töt32_t
;

545 
	tuöt32_t
;

546 #i‡
__GNUC__


547 sig√d 
	töt64_t
;

548 
	tuöt64_t
;

550 sig√d 
	t__öt64
 
	töt64_t
;

551 
	t__öt64
 
	tuöt64_t
;

553 #ifde‡
_WIN64


554 
	#ECB_PTRSIZE
 8

	)

555 
uöt64_t
 
	tuöçå_t
;

556 
öt64_t
 
	töçå_t
;

558 
	#ECB_PTRSIZE
 4

	)

559 
uöt32_t
 
	tuöçå_t
;

560 
öt32_t
 
	töçå_t
;

563 
	~<öây≥s.h
>

564 #i‡(
deföed
 
INTPTR_MAX
 ? INTPTR_MAX : 
ULONG_MAX
) > 0xffffffffU

565 
	#ECB_PTRSIZE
 8

	)

567 
	#ECB_PTRSIZE
 4

	)

571 
	#ECB_GCC_AMD64
 (
__amd64
 || 
__amd64__
 || 
__x86_64
 || 
__x86_64__
)

	)

572 
	#ECB_MSVC_AMD64
 (
_M_AMD64
 || 
_M_X64
)

	)

575 #i‡
ECB_GCC_AMD64
 || 
ECB_MSVC_AMD64


576 #i‡
_ILP32


577 
	#ECB_AMD64_X32
 1

	)

579 
	#ECB_AMD64
 1

	)

590 #i‡!
deföed
 
__GNUC_MINOR__
 || deföed 
__INTEL_COMPILER
 || deföed 
__SUNPRO_C
 || deföed 
__SUNPRO_CC
 || deföed 
__Œvm__
 || deföed 
__˛™g__


591 
	#ECB_GCC_VERSION
(
maj‹
,
mö‹
Ë0

	)

593 
	#ECB_GCC_VERSION
(
maj‹
,
mö‹
Ë(
__GNUC__
 > (maj‹Ë|| (__GNUC__ =(maj‹Ë&& 
__GNUC_MINOR__
 >(mö‹)))

	)

596 
	#ECB_CLANG_VERSION
(
maj‹
,
mö‹
Ë(
__˛™g_maj‹__
 > (maj‹Ë|| (__˛™g_maj‹__ =(maj‹Ë&& 
__˛™g_mö‹__
 >(mö‹)))

	)

598 #i‡
__˛™g__
 && 
deföed
 
__has_buûtö


599 
	#ECB_CLANG_BUILTIN
(
x
Ë
	`__has_buûtö
 (x)

	)

601 
	#ECB_CLANG_BUILTIN
(
x
Ë0

	)

604 #i‡
__˛™g__
 && 
deföed
 
__has_exãnsi⁄


605 
	#ECB_CLANG_EXTENSION
(
x
Ë
	`__has_exãnsi⁄
 (x)

	)

607 
	#ECB_CLANG_EXTENSION
(
x
Ë0

	)

610 
	#ECB_CPP
 (
__˝lu•lus
+0)

	)

611 
	#ECB_CPP11
 (
__˝lu•lus
 >201103L)

	)

613 #i‡
ECB_CPP


614 
	#ECB_C
 0

	)

615 
	#ECB_STDC_VERSION
 0

	)

617 
	#ECB_C
 1

	)

618 
	#ECB_STDC_VERSION
 
__STDC_VERSION__


	)

621 
	#ECB_C99
 (
ECB_STDC_VERSION
 >199901L)

	)

622 
	#ECB_C11
 (
ECB_STDC_VERSION
 >201112L)

	)

624 #i‡
ECB_CPP


625 
	#ECB_EXTERN_C
 "C"

	)

626 
	#ECB_EXTERN_C_BEG
 
ECB_EXTERN_C
 {

	)

627 
	#ECB_EXTERN_C_END
 }

	)

629 
	#ECB_EXTERN_C
 

	)

630 
	#ECB_EXTERN_C_BEG


	)

631 
	#ECB_EXTERN_C_END


	)

639 #i‡
ECB_NO_THREADS


640 
	#ECB_NO_SMP
 1

	)

643 #i‡
ECB_NO_SMP


644 
	#ECB_MEMORY_FENCE
 dÿ{ } 0)

	)

648 #i‡
__xlC__
 && 
ECB_CPP


649 
	~<buûtös.h
>

652 #i‡1400 <
_MSC_VER


653 
	~<öåö.h
>

656 #i‚de‡
ECB_MEMORY_FENCE


657 #i‡
ECB_GCC_VERSION
(2,5Ë|| 
deföed
 
__INTEL_COMPILER
 || (
__Œvm__
 && 
__GNUC__
Ë|| 
__SUNPRO_C
 >0x5110 || 
__SUNPRO_CC
 >= 0x5110

658 #i‡
__i386
 || 
__i386__


659 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("lock; orb $0, -1(%%e•)" : : : "mem‹y")

	)

660 
	#ECB_MEMORY_FENCE_ACQUIRE
 
__asm__
 
	`__vﬁ©ûe__
 ("" : : : "mem‹y")

	)

661 
	#ECB_MEMORY_FENCE_RELEASE
 
__asm__
 
	`__vﬁ©ûe__
 ("")

	)

662 #ñi‡
ECB_GCC_AMD64


663 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("m„n˚" : : : "mem‹y")

	)

664 
	#ECB_MEMORY_FENCE_ACQUIRE
 
__asm__
 
	`__vﬁ©ûe__
 ("" : : : "mem‹y")

	)

665 
	#ECB_MEMORY_FENCE_RELEASE
 
__asm__
 
	`__vﬁ©ûe__
 ("")

	)

666 #ñi‡
__powîpc__
 || 
__µc__
 || 
__powîpc64__
 || 
__µc64__


667 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("sync" : : : "mem‹y")

	)

668 #ñi‡
deföed
 
__ARM_ARCH_2__
 \

669 || 
deföed
 
__ARM_ARCH_3__
 || deföed 
__ARM_ARCH_3M__
 \

670 || 
deföed
 
__ARM_ARCH_4__
 || deföed 
__ARM_ARCH_4T__
 \

671 || 
deföed
 
__ARM_ARCH_5__
 || deföed 
__ARM_ARCH_5E__
 \

672 || 
deföed
 
__ARM_ARCH_5T__
 || deföed 
__ARM_ARCH_5TE__
 \

673 || 
deföed
 
__ARM_ARCH_5TEJ__


675 #ñi‡
deföed
 
__ARM_ARCH_6__
 || deföed 
__ARM_ARCH_6J__
 \

676 || 
deföed
 
__ARM_ARCH_6K__
 || deföed 
__ARM_ARCH_6ZK__
 \

677 || 
deföed
 
__ARM_ARCH_6T2__


678 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("m¸Ö15,0,%0,c7,c10,5" : : "r" (0Ë: "mem‹y")

	)

679 #ñi‡
deföed
 
__ARM_ARCH_7__
 || deföed 
__ARM_ARCH_7A__
 \

680 || 
deföed
 
__ARM_ARCH_7R__
 || deföed 
__ARM_ARCH_7M__


681 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("dmb" : : : "mem‹y")

	)

682 #ñi‡
__Ørch64__


683 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("dmb ish" : : : "mem‹y")

	)

684 #ñi‡(
__•¨c
 || 
__•¨c__
Ë&& !(
__•¨c_v8__
 || 
deföed
 
__•¨cv8
)

685 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("memb¨ #LﬂdSt‹ê| #LﬂdLﬂd | #St‹eSt‹ê| #St‹eLﬂd" : : : "mem‹y")

	)

686 
	#ECB_MEMORY_FENCE_ACQUIRE
 
__asm__
 
	`__vﬁ©ûe__
 ("memb¨ #LﬂdSt‹ê| #LﬂdLﬂd" : : : "mem‹y")

	)

687 
	#ECB_MEMORY_FENCE_RELEASE
 
__asm__
 
	`__vﬁ©ûe__
 ("memb¨ #LﬂdSt‹ê | #St‹eSt‹e")

	)

688 #ñi‡
deföed
 
__s390__
 || deföed 
__s390x__


689 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("b¸ 15,0" : : : "mem‹y")

	)

690 #ñi‡
deföed
 
__mùs__


693 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 (".£àmùs2; sync; .£àmùs0" : : : "mem‹y")

	)

694 #ñi‡
deföed
 
__Æpha__


695 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("mb" : : : "mem‹y")

	)

696 #ñi‡
deföed
 
__hµa__


697 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("" : : : "mem‹y")

	)

698 
	#ECB_MEMORY_FENCE_RELEASE
 
__asm__
 
	`__vﬁ©ûe__
 ("")

	)

699 #ñi‡
deföed
 
__ü64__


700 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("mf" : : : "mem‹y")

	)

701 #ñi‡
deföed
 
__m68k__


702 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("" : : : "mem‹y")

	)

703 #ñi‡
deföed
 
__m88k__


704 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("tb1 0,%%r0,128" : : : "mem‹y")

	)

705 #ñi‡
deföed
 
__sh__


706 
	#ECB_MEMORY_FENCE
 
__asm__
 
	`__vﬁ©ûe__
 ("" : : : "mem‹y")

	)

711 #i‚de‡
ECB_MEMORY_FENCE


712 #i‡
ECB_GCC_VERSION
(4,7)

714 
	#ECB_MEMORY_FENCE
 
	`__©omic_thªad_„n˚
 (
__ATOMIC_SEQ_CST
)

	)

715 
	#ECB_MEMORY_FENCE_ACQUIRE
 
	`__©omic_thªad_„n˚
 (
__ATOMIC_ACQUIRE
)

	)

716 
	#ECB_MEMORY_FENCE_RELEASE
 
	`__©omic_thªad_„n˚
 (
__ATOMIC_RELEASE
)

	)

718 #ñi‡
ECB_CLANG_EXTENSION
(
c_©omic
)

720 
	#ECB_MEMORY_FENCE
 
	`__c11_©omic_thªad_„n˚
 (
__ATOMIC_SEQ_CST
)

	)

721 
	#ECB_MEMORY_FENCE_ACQUIRE
 
	`__c11_©omic_thªad_„n˚
 (
__ATOMIC_ACQUIRE
)

	)

722 
	#ECB_MEMORY_FENCE_RELEASE
 
	`__c11_©omic_thªad_„n˚
 (
__ATOMIC_RELEASE
)

	)

724 #ñi‡
ECB_GCC_VERSION
(4,4Ë|| 
deföed
 
__INTEL_COMPILER
 || deföed 
__˛™g__


725 
	#ECB_MEMORY_FENCE
 
	`__sync_synchr⁄ize
 ()

	)

726 #ñi‡
_MSC_VER
 >= 1500

728 #¥agm®
öåösic
(
_RódB¨rõr
,
_WrôeB¨rõr
,
_RódWrôeB¨rõr
)

729 
	#ECB_MEMORY_FENCE
 
	`_RódWrôeB¨rõr
 (); 
	`Mem‹yB¨rõr
()

	)

730 
	#ECB_MEMORY_FENCE_ACQUIRE
 
	`_RódWrôeB¨rõr
 (); 
	`Mem‹yB¨rõr
(Ë

	)

731 
	#ECB_MEMORY_FENCE_RELEASE
 
	`_WrôeB¨rõr
 (); 
	`Mem‹yB¨rõr
()

	)

732 #ñi‡
_MSC_VER
 >= 1400

733 #¥agm®
öåösic
(
_RódB¨rõr
,
_WrôeB¨rõr
,
_RódWrôeB¨rõr
)

734 
	#ECB_MEMORY_FENCE
 
	`_RódWrôeB¨rõr
 ()

	)

735 
	#ECB_MEMORY_FENCE_ACQUIRE
 
	`_RódWrôeB¨rõr
 (Ë

	)

736 
	#ECB_MEMORY_FENCE_RELEASE
 
	`_WrôeB¨rõr
 ()

	)

737 #ñi‡
deföed
 
_WIN32


738 
	~<WöNT.h
>

739 
	#ECB_MEMORY_FENCE
 
	`Mem‹yB¨rõr
 (Ë

	)

740 #ñi‡
__SUNPRO_C
 >0x5110 || 
__SUNPRO_CC
 >= 0x5110

741 
	~<mb¨rõr.h
>

742 
	#ECB_MEMORY_FENCE
 
	`__machöe_rw_b¨rõr
 ()

	)

743 
	#ECB_MEMORY_FENCE_ACQUIRE
 
	`__machöe_r_b¨rõr
 ()

	)

744 
	#ECB_MEMORY_FENCE_RELEASE
 
	`__machöe_w_b¨rõr
 ()

	)

745 #ñi‡
__xlC__


746 
	#ECB_MEMORY_FENCE
 
	`__sync
 ()

	)

750 #i‚de‡
ECB_MEMORY_FENCE


751 #i‡
ECB_C11
 && !
deföed
 
__STDC_NO_ATOMICS__


754 
	~<°d©omic.h
>

763 
	#ECB_MEMORY_FENCE
 
	`©omic_thªad_„n˚
 (
mem‹y_‹dî_£q_c°
)

	)

767 #i‚de‡
ECB_MEMORY_FENCE


768 #i‡!
ECB_AVOID_PTHREADS


776 
	~<±hªad.h
>

777 
	#ECB_NEEDS_PTHREADS
 1

	)

778 
	#ECB_MEMORY_FENCE_NEEDS_PTHREADS
 1

	)

780 
±hªad_muãx_t
 
	gecb_mf_lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

781 
	#ECB_MEMORY_FENCE
 dÿ{ 
	`±hªad_muãx_lock
 (&
ecb_mf_lock
); 
	`±hªad_muãx_u∆ock
 (&ecb_mf_lock); } 0)

	)

785 #i‡!
deföed
 
ECB_MEMORY_FENCE_ACQUIRE
 && deföed 
ECB_MEMORY_FENCE


786 
	#ECB_MEMORY_FENCE_ACQUIRE
 
ECB_MEMORY_FENCE


	)

789 #i‡!
deföed
 
ECB_MEMORY_FENCE_RELEASE
 && deföed 
ECB_MEMORY_FENCE


790 
	#ECB_MEMORY_FENCE_RELEASE
 
ECB_MEMORY_FENCE


	)

795 #i‡
ECB_CPP


796 
	#ecb_ölöe
 
ölöe


	)

797 #ñi‡
ECB_GCC_VERSION
(2,5)

798 
	#ecb_ölöe
 
__ölöe__


	)

799 #ñi‡
ECB_C99


800 
	#ecb_ölöe
 
ölöe


	)

802 
	#ecb_ölöe
 

	)

805 #i‡
ECB_GCC_VERSION
(3,3)

806 
	#ecb_ª°ri˘
 
__ª°ri˘__


	)

807 #ñi‡
ECB_C99


808 
	#ecb_ª°ri˘
 
ª°ri˘


	)

810 
	#ecb_ª°ri˘


	)

813 
	tecb_boﬁ
;

815 
	#ECB_CONCAT_
(
a
, 
b
Ë®## 
	)
b

816 
	#ECB_CONCAT
(
a
, 
b
Ë
	`ECB_CONCAT_
◊, b)

	)

817 
	#ECB_STRINGIFY_
(
a
Ë#a

	)

818 
	#ECB_STRINGIFY
(
a
Ë
	`ECB_STRINGIFY_
◊)

	)

819 
	#ECB_STRINGIFY_EXPR
(
ex¥
Ë(”x¥), 
	`ECB_STRINGIFY_
 (ex¥))

	)

821 
	#ecb_fun˘i⁄_
 
ecb_ölöe


	)

823 #i‡
ECB_GCC_VERSION
(3,1Ë|| 
ECB_CLANG_VERSION
(2,8)

824 
	#ecb_©åibuã
(
©åli°
Ë
	`__©åibuã__
 (©åli°)

	)

826 
	#ecb_©åibuã
(
©åli°
)

	)

829 #i‡
ECB_GCC_VERSION
(3,1Ë|| 
ECB_CLANG_BUILTIN
(
__buûtö_c⁄°™t_p
)

830 
	#ecb_is_c⁄°™t
(
ex¥
Ë
	`__buûtö_c⁄°™t_p
 (ex¥)

	)

836 
	#ecb_is_c⁄°™t
(
ex¥
Ë0

	)

839 #i‡
ECB_GCC_VERSION
(3,1Ë|| 
ECB_CLANG_BUILTIN
(
__buûtö_ex≥˘
)

840 
	#ecb_ex≥˘
(
ex¥
,
vÆue
Ë
	`__buûtö_ex≥˘
 (”x¥),(vÆue))

	)

842 
	#ecb_ex≥˘
(
ex¥
,
vÆue
Ë”x¥)

	)

845 #i‡
ECB_GCC_VERSION
(3,1Ë|| 
ECB_CLANG_BUILTIN
(
__buûtö_¥e„tch
)

846 
	#ecb_¥e„tch
(
addr
,
rw
,
loˇlôy
Ë
	`__buûtö_¥e„tch
 (addr,Ñw,Üoˇlôy)

	)

848 
	#ecb_¥e„tch
(
addr
,
rw
,
loˇlôy
)

	)

852 #i‡
ECB_CPP11


854 
	gãm∂©e
<
˛ass
 
	gT
> 
	secb_de˛ty≥_t
 { 
T
 
	tty≥
; };

855 
	#ecb_de˛ty≥
(
x
Ë
ecb_de˛ty≥_t
<
	`de˛ty≥
 (x)>::
ty≥


	)

856 #ñi‡
ECB_GCC_VERSION
(3,0Ë|| 
ECB_CLANG_VERSION
(2,8)

857 
	#ecb_de˛ty≥
(
x
Ë
	`__ty≥of__
 (x)

	)

860 #i‡
_MSC_VER
 >= 1300

861 
	#ecb_dïªˇãd
 
	`__de˛•ec
 (
dïªˇãd
)

	)

863 
	#ecb_dïªˇãd
 
	`ecb_©åibuã
 ((
__dïªˇãd__
))

	)

866 #i‡
_MSC_VER
 >= 1500

867 
	#ecb_dïªˇãd_mesßge
(
msg
Ë
	`__de˛•ec
 (
	`dïªˇãd
 (msg))

	)

868 #ñi‡
ECB_GCC_VERSION
(4,5)

869 
	#ecb_dïªˇãd_mesßge
(
msg
Ë
	`ecb_©åibuã
 ((
	`__dïªˇãd__
 (msg))

	)

871 
	#ecb_dïªˇãd_mesßge
(
msg
Ë
ecb_dïªˇãd


	)

874 #i‡
_MSC_VER
 >= 1400

875 
	#ecb_noölöe
 
	`__de˛•ec
 (
noölöe
)

	)

877 
	#ecb_noölöe
 
	`ecb_©åibuã
 ((
__noölöe__
))

	)

880 
	#ecb_unu£d
 
	`ecb_©åibuã
 ((
__unu£d__
))

	)

881 
	#ecb_c⁄°
 
	`ecb_©åibuã
 ((
__c⁄°__
))

	)

882 
	#ecb_puª
 
	`ecb_©åibuã
 ((
__puª__
))

	)

884 #i‡
ECB_C11
 || 
__IBMC_NORETURN


886 
	#ecb_n‹ëu∫
 
_N‹ëu∫


	)

887 #ñi‡
ECB_CPP11


888 
	#ecb_n‹ëu∫
 [[
n‹ëu∫
]]

	)

889 #ñi‡
_MSC_VER
 >= 1200

891 
	#ecb_n‹ëu∫
 
	`__de˛•ec
 (
n‹ëu∫
)

	)

893 
	#ecb_n‹ëu∫
 
	`ecb_©åibuã
 ((
__n‹ëu∫__
))

	)

896 #i‡
ECB_GCC_VERSION
(4,3)

897 
	#ecb_¨tificül
 
	`ecb_©åibuã
 ((
__¨tificül__
))

	)

898 
	#ecb_hŸ
 
	`ecb_©åibuã
 ((
__hŸ__
))

	)

899 
	#ecb_cﬁd
 
	`ecb_©åibuã
 ((
__cﬁd__
))

	)

901 
	#ecb_¨tificül


	)

902 
	#ecb_hŸ


	)

903 
	#ecb_cﬁd


	)

909 
	#ecb_ex≥˘_Ál£
(
ex¥
Ë
	`ecb_ex≥˘
 (!!”x¥), 0)

	)

910 
	#ecb_ex≥˘_åue
(
ex¥
Ë
	`ecb_ex≥˘
 (!!”x¥), 1)

	)

912 
	#ecb_likñy
(
ex¥
Ë
	`ecb_ex≥˘_åue
 (ex¥)

	)

913 
	#ecb_u∆ikñy
(
ex¥
Ë
	`ecb_ex≥˘_Ál£
 (ex¥)

	)

916 #i‡
ECB_GCC_VERSION
(3,4) \

917 || (
ECB_CLANG_BUILTIN
(
__buûtö_˛z
Ë&& ECB_CLANG_BUILTIN(
__buûtö_˛zŒ
) \

918 && 
ECB_CLANG_BUILTIN
(
__buûtö_˘z
Ë&& ECB_CLANG_BUILTIN(
__buûtö_˘zŒ
) \

919 && 
	$ECB_CLANG_BUILTIN
(
__buûtö_p›cou¡
))

921 
	#ecb_ld32
(
x
Ë(
	`__buûtö_˛z
 (xË^ 31)

	)

922 
	#ecb_ld64
(
x
Ë(
	`__buûtö_˛zŒ
 (xË^ 63)

	)

923 
	#ecb_˘z32
(
x
Ë
	`__buûtö_˘z
 (x)

	)

924 
	#ecb_˘z64
(
x
Ë
	`__buûtö_˘zŒ
 (x)

	)

925 
	#ecb_p›cou¡32
(
x
Ë
	`__buûtö_p›cou¡
 (x)

	)

928 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
	`ecb_˘z32
 (
uöt32_t
 
x
);

929 
ecb_fun˘i⁄_
 
ecb_c⁄°
 

930 
	$ecb_˘z32
 (
uöt32_t
 
x
)

932 #i‡1400 <
_MSC_VER
 && (
_M_IX86
 || 
_M_X64
 || 
_M_IA64
 || 
_M_ARM
)

933 
r
;

934 
	`_BôSˇnF‹w¨d
 (&
r
, 
x
);

935  ()
r
;

937 
r
 = 0;

939 
x
 &= ~x + 1;

941 #i‡
ECB_bønchÀss_⁄_i386


942 
r
 +!!(
x
 & 0xaaaaaaaa) << 0;

943 
r
 +!!(
x
 & 0xcccccccc) << 1;

944 
r
 +!!(
x
 & 0xf0f0f0f0) << 2;

945 
r
 +!!(
x
 & 0xff00ff00) << 3;

946 
r
 +!!(
x
 & 0xffff0000) << 4;

948 i‡(
x
 & 0xØØØØË
r
 += 1;

949 i‡(
x
 & 0xccccccccË
r
 += 2;

950 i‡(
x
 & 0xf0f0f0f0Ë
r
 += 4;

951 i‡(
x
 & 0xff00ff00Ë
r
 += 8;

952 i‡(
x
 & 0xffff0000Ë
r
 += 16;

955  
r
;

957 
	}
}

959 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_˘z64
 (
uöt64_t
 
x
);

960 
ecb_fun˘i⁄_
 
ecb_c⁄°
 

961 
	$ecb_˘z64
 (
uöt64_t
 
x
)

963 #i‡1400 <
_MSC_VER
 && (
_M_X64
 || 
_M_IA64
 || 
_M_ARM
)

964 
r
;

965 
	`_BôSˇnF‹w¨d64
 (&
r
, 
x
);

966  ()
r
;

968 
shi·
 = 
x
 & 0xffffffff ? 0 : 32;

969  
	`ecb_˘z32
 (
x
 >> 
shi·
) + shift;

971 
	}
}

973 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_p›cou¡32
 (
uöt32_t
 
x
);

974 
ecb_fun˘i⁄_
 
ecb_c⁄°
 

975 
	$ecb_p›cou¡32
 (
uöt32_t
 
x
)

977 
x
 -= (x >> 1) & 0x55555555;

978 
x
 = ((x >> 2) & 0x33333333) + (x & 0x33333333);

979 
x
 = ((x >> 4) + x) & 0x0f0f0f0f;

980 
x
 *= 0x01010101;

982  
x
 >> 24;

983 
	}
}

985 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_ld32
 (
uöt32_t
 
x
);

986 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
	$ecb_ld32
 (
uöt32_t
 
x
)

988 #i‡1400 <
_MSC_VER
 && (
_M_IX86
 || 
_M_X64
 || 
_M_IA64
 || 
_M_ARM
)

989 
r
;

990 
	`_BôSˇnRevî£
 (&
r
, 
x
);

991  ()
r
;

993 
r
 = 0;

995 i‡(
x
 >> 16Ë{ x >>16; 
r
 += 16; }

996 i‡(
x
 >> 8Ë{ x >>8; 
r
 += 8; }

997 i‡(
x
 >> 4Ë{ x >>4; 
r
 += 4; }

998 i‡(
x
 >> 2Ë{ x >>2; 
r
 += 2; }

999 i‡(
x
 >> 1Ë{ 
r
 += 1; }

1001  
r
;

1003 
	}
}

1005 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_ld64
 (
uöt64_t
 
x
);

1006 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
	$ecb_ld64
 (
uöt64_t
 
x
)

1008 #i‡1400 <
_MSC_VER
 && (
_M_X64
 || 
_M_IA64
 || 
_M_ARM
)

1009 
r
;

1010 
	`_BôSˇnRevî£64
 (&
r
, 
x
);

1011  ()
r
;

1013 
r
 = 0;

1015 i‡(
x
 >> 32Ë{ x >>32; 
r
 += 32; }

1017  
r
 + 
	`ecb_ld32
 (
x
);

1019 
	}
}

1022 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_boﬁ
 
ecb_is_pŸ32
 (
uöt32_t
 
x
);

1023 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_boﬁ
 
	$ecb_is_pŸ32
 (
uöt32_t
 
x
Ë{  !(x & (x - 1)); 
	}
}

1024 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_boﬁ
 
ecb_is_pŸ64
 (
uöt64_t
 
x
);

1025 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_boﬁ
 
	$ecb_is_pŸ64
 (
uöt64_t
 
x
Ë{  !(x & (x - 1)); 
	}
}

1027 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt8_t
 
ecb_bôªv8
 (uöt8_à
x
);

1028 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt8_t
 
	$ecb_bôªv8
 (
uöt8_t
 
x
)

1030  ( (
x
 * 0x0802U & 0x22110U)

1031 | (
x
 * 0x8020U & 0x88440U)) * 0x10101U >> 16;

1032 
	}
}

1034 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t
 
ecb_bôªv16
 (uöt16_à
x
);

1035 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t
 
	$ecb_bôªv16
 (
uöt16_t
 
x
)

1037 
x
 = ((x >> 1) & 0x5555) | ((x & 0x5555) << 1);

1038 
x
 = ((x >> 2) & 0x3333) | ((x & 0x3333) << 2);

1039 
x
 = ((x >> 4) & 0x0f0f) | ((x & 0x0f0f) << 4);

1040 
x
 = ( x >> 8 ) | ( x << 8);

1042  
x
;

1043 
	}
}

1045 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t
 
ecb_bôªv32
 (uöt32_à
x
);

1046 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t
 
	$ecb_bôªv32
 (
uöt32_t
 
x
)

1048 
x
 = ((x >> 1) & 0x55555555) | ((x & 0x55555555) << 1);

1049 
x
 = ((x >> 2) & 0x33333333) | ((x & 0x33333333) << 2);

1050 
x
 = ((x >> 4) & 0x0f0f0f0f) | ((x & 0x0f0f0f0f) << 4);

1051 
x
 = ((x >> 8) & 0x00ff00ff) | ((x & 0x00ff00ff) << 8);

1052 
x
 = ( x >> 16 ) | ( x << 16);

1054  
x
;

1055 
	}
}

1059 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_p›cou¡64
 (
uöt64_t
 
x
);

1060 
ecb_fun˘i⁄_
 
ecb_c⁄°
 

1061 
	$ecb_p›cou¡64
 (
uöt64_t
 
x
)

1063  
	`ecb_p›cou¡32
 (
x
) +Écb_popcount32 (x >> 32);

1064 
	}
}

1066 
ecb_ölöe
 
ecb_c⁄°
 
uöt8_t
 
ecb_rŸl8
 (uöt8_à
x
, 
cou¡
);

1067 
ecb_ölöe
 
ecb_c⁄°
 
uöt8_t
 
ecb_rŸr8
 (uöt8_à
x
, 
cou¡
);

1068 
ecb_ölöe
 
ecb_c⁄°
 
uöt16_t
 
ecb_rŸl16
 (uöt16_à
x
, 
cou¡
);

1069 
ecb_ölöe
 
ecb_c⁄°
 
uöt16_t
 
ecb_rŸr16
 (uöt16_à
x
, 
cou¡
);

1070 
ecb_ölöe
 
ecb_c⁄°
 
uöt32_t
 
ecb_rŸl32
 (uöt32_à
x
, 
cou¡
);

1071 
ecb_ölöe
 
ecb_c⁄°
 
uöt32_t
 
ecb_rŸr32
 (uöt32_à
x
, 
cou¡
);

1072 
ecb_ölöe
 
ecb_c⁄°
 
uöt64_t
 
ecb_rŸl64
 (uöt64_à
x
, 
cou¡
);

1073 
ecb_ölöe
 
ecb_c⁄°
 
uöt64_t
 
ecb_rŸr64
 (uöt64_à
x
, 
cou¡
);

1075 
ecb_ölöe
 
ecb_c⁄°
 
uöt8_t
 
	$ecb_rŸl8
 (
uöt8_t
 
x
, 
cou¡
Ë{  (x >> ( 8 - cou¡)Ë| (x << cou¡); 
	}
}

1076 
ecb_ölöe
 
ecb_c⁄°
 
uöt8_t
 
	$ecb_rŸr8
 (
uöt8_t
 
x
, 
cou¡
Ë{  (x << ( 8 - cou¡)Ë| (x >> cou¡); 
	}
}

1077 
ecb_ölöe
 
ecb_c⁄°
 
uöt16_t
 
	$ecb_rŸl16
 (
uöt16_t
 
x
, 
cou¡
Ë{  (x >> (16 - cou¡)Ë| (x << cou¡); 
	}
}

1078 
ecb_ölöe
 
ecb_c⁄°
 
uöt16_t
 
	$ecb_rŸr16
 (
uöt16_t
 
x
, 
cou¡
Ë{  (x << (16 - cou¡)Ë| (x >> cou¡); 
	}
}

1079 
ecb_ölöe
 
ecb_c⁄°
 
uöt32_t
 
	$ecb_rŸl32
 (
uöt32_t
 
x
, 
cou¡
Ë{  (x >> (32 - cou¡)Ë| (x << cou¡); 
	}
}

1080 
ecb_ölöe
 
ecb_c⁄°
 
uöt32_t
 
	$ecb_rŸr32
 (
uöt32_t
 
x
, 
cou¡
Ë{  (x << (32 - cou¡)Ë| (x >> cou¡); 
	}
}

1081 
ecb_ölöe
 
ecb_c⁄°
 
uöt64_t
 
	$ecb_rŸl64
 (
uöt64_t
 
x
, 
cou¡
Ë{  (x >> (64 - cou¡)Ë| (x << cou¡); 
	}
}

1082 
ecb_ölöe
 
ecb_c⁄°
 
uöt64_t
 
	$ecb_rŸr64
 (
uöt64_t
 
x
, 
cou¡
Ë{  (x << (64 - cou¡)Ë| (x >> cou¡); 
	}
}

1084 #i‡
ECB_GCC_VERSION
(4,3Ë|| (
ECB_CLANG_BUILTIN
(
__buûtö_bsw≠32
Ë&& ECB_CLANG_BUILTIN(
__buûtö_bsw≠64
))

1085 #i‡
ECB_GCC_VERSION
(4,8Ë|| 
ECB_CLANG_BUILTIN
(
__buûtö_bsw≠16
)

1086 
	#ecb_bsw≠16
(
x
Ë
	`__buûtö_bsw≠16
 (x)

	)

1088 
	#ecb_bsw≠16
(
x
Ë(
	`__buûtö_bsw≠32
 (xË>> 16)

	)

1090 
	#ecb_bsw≠32
(
x
Ë
	`__buûtö_bsw≠32
 (x)

	)

1091 
	#ecb_bsw≠64
(
x
Ë
	`__buûtö_bsw≠64
 (x)

	)

1092 #ñi‡
_MSC_VER


1093 
	~<°dlib.h
>

1094 
	#ecb_bsw≠16
(
x
Ë((
uöt16_t
)
	`_byãsw≠_ush‹t
 ((uöt16_t)(x)))

	)

1095 
	#ecb_bsw≠32
(
x
Ë((
uöt32_t
)
	`_byãsw≠_ul⁄g
 ((uöt32_t)(x)))

	)

1096 
	#ecb_bsw≠64
(
x
Ë((
uöt64_t
)
	`_byãsw≠_uöt64
 ((uöt64_t)(x)))

	)

1098 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t
 
ecb_bsw≠16
 (uöt16_à
x
);

1099 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t


1100 
	$ecb_bsw≠16
 (
uöt16_t
 
x
)

1102  
	`ecb_rŸl16
 (
x
, 8);

1103 
	}
}

1105 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t
 
ecb_bsw≠32
 (uöt32_à
x
);

1106 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t


1107 
	$ecb_bsw≠32
 (
uöt32_t
 
x
)

1109  (((
uöt32_t
)
	`ecb_bsw≠16
 (
x
)) << 16) |Écb_bswap16 (x >> 16);

1110 
	}
}

1112 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt64_t
 
ecb_bsw≠64
 (uöt64_à
x
);

1113 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt64_t


1114 
	$ecb_bsw≠64
 (
uöt64_t
 
x
)

1116  (((
uöt64_t
)
	`ecb_bsw≠32
 (
x
)) << 32) |Écb_bswap32 (x >> 32);

1117 
	}
}

1120 #i‡
ECB_GCC_VERSION
(4,5Ë|| 
ECB_CLANG_BUILTIN
(
__buûtö_uƒóchabÀ
)

1121 
	#ecb_uƒóchabÀ
(Ë
	`__buûtö_uƒóchabÀ
 ()

	)

1124 
ecb_ölöe
 
ecb_n‹ëu∫
 
ecb_uƒóchabÀ
 ();

1125 
ecb_ölöe
 
ecb_n‹ëu∫
 
	$ecb_uƒóchabÀ
 (Ë{ 
	}
}

1129 
	#ecb_assume
(
c⁄d
Ëi‡(!(c⁄d)Ë
	`ecb_uƒóchabÀ
 (); 0

	)

1131 
ecb_ölöe
 
ecb_c⁄°
 
uöt32_t
 
ecb_byã‹dî_hñ≥r
 ();

1132 
ecb_ölöe
 
ecb_c⁄°
 
uöt32_t


1133 
	$ecb_byã‹dî_hñ≥r
 ()

1141 #i‡(
deföed
 
__BYTE_ORDER__
 && __BYTE_ORDER__ =
__ORDER_LITTLE_ENDIAN__
) \

1142 || ((
__i386
 || 
__i386__
 || 
_M_IX86
 || 
ECB_GCC_AMD64
 || 
ECB_MSVC_AMD64
Ë&& !
__VOS__
)

1143 
	#ECB_LITTLE_ENDIAN
 1

	)

1145 #ñi‡(
deföed
 
__BYTE_ORDER__
 && __BYTE_ORDER__ =
__ORDER_BIG_ENDIAN__
) \

1146 || ((
__AARCH64EB__
 || 
__MIPSEB__
 || 
__ARMEB__
Ë&& !
__VOS__
)

1147 
	#ECB_BIG_ENDIAN
 1

	)

1152 
uöt8_t
 
c
[4];

1153 
uöt32_t
 
u
;

1154 } 
u
 = { 0x11, 0x22, 0x33, 0x44 };

1155  
u
.u;

1157 
	}
}

1159 
ecb_ölöe
 
ecb_c⁄°
 
ecb_boﬁ
 
ecb_big_ídün
 ();

1160 
ecb_ölöe
 
ecb_c⁄°
 
ecb_boﬁ
 
	$ecb_big_ídün
 (Ë{  
	`ecb_byã‹dî_hñ≥r
 (Ë=0x11223344; 
	}
}

1161 
ecb_ölöe
 
ecb_c⁄°
 
ecb_boﬁ
 
ecb_lôée_ídün
 ();

1162 
ecb_ölöe
 
ecb_c⁄°
 
ecb_boﬁ
 
	$ecb_lôée_ídün
 (Ë{  
	`ecb_byã‹dî_hñ≥r
 (Ë=0x44332211; 
	}
}

1164 #i‡
ECB_GCC_VERSION
(3,0Ë|| 
ECB_C99


1165 
	#ecb_mod
(
m
,
n
Ë((mË% (nË+ ((mË% (nË< 0 ? (nË: 0))

	)

1167 
	#ecb_mod
(
m
,
n
Ë((mË< 0 ? (“Ë- 1 - ((-1 - (m)Ë% (n))Ë: ((mË% (n)))

	)

1170 #i‡
ECB_CPP


1171 
	gãm∂©e
<
ty≥«me
 
	gT
>

1172 
ölöe
 
T
 
	$ecb_div_rd
 (
T
 
vÆ
, T 
div
)

1174  
vÆ
 < 0 ? - ((-vÆ + 
div
 - 1) / div) : (val ) / div;

1175 
	}
}

1176 
	gãm∂©e
<
ty≥«me
 
	gT
>

1177 
ölöe
 
T
 
	$ecb_div_ru
 (
T
 
vÆ
, T 
div
)

1179  
vÆ
 < 0 ? - ((-vÆ ) / 
div
) : (val + div - 1) / div;

1180 
	}
}

1182 
	#ecb_div_rd
(
vÆ
,
div
Ë((vÆË< 0 ? - ((-(vÆË+ (divË- 1Ë/ (div)Ë: ((vÆËË/ (div))

	)

1183 
	#ecb_div_ru
(
vÆ
,
div
Ë((vÆË< 0 ? - ((-(vÆËË/ (div)Ë: ((vÆË+ (divË- 1Ë/ (div))

	)

1186 #i‡
ecb_˝lu•lus_d€s_nŸ_suck


1188 
	gãm∂©e
<
ty≥«me
 
	gT
, 
	gN
>

1189 
ölöe
 
ecb_¨øy_Àngth
 (c⁄° 
T
 (&
¨r
)[
N
])

1191  
	gN
;

1194 
	#ecb_¨øy_Àngth
(
«me
Ë( («meË/  («mê[0]))

	)

1197 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t
 
ecb_bö¨y16_to_bö¨y32
 (uöt32_à
x
);

1198 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t


1199 
	$ecb_bö¨y16_to_bö¨y32
 (
uöt32_t
 
x
)

1201 
s
 = (
x
 & 0x8000) << (31 - 15);

1202 
e
 = (
x
 >> 10) & 0x001f;

1203 
m
 = 
x
 & 0x03ff;

1205 i‡(
	`ecb_ex≥˘_Ál£
 (
e
 == 31))

1207 
e
 = 255 - (127 - 15);

1208 i‡(
	`ecb_ex≥˘_Ál£
 (!
e
))

1210 i‡(
	`ecb_ex≥˘_åue
 (!
m
))

1212 
e
 = 0 - (127 - 15);

1216 
s
 = 10 - 
	`ecb_ld32
 (
m
);

1218 
m
 = (m << 
s
) & 0x3ff;

1219 
e
 -
s
 - 1;

1224 
e
 += 127 - 15;

1226  
s
 | (
e
 << 23Ë| (
m
 << (23 - 10));

1227 
	}
}

1229 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t
 
ecb_bö¨y32_to_bö¨y16
 (
uöt32_t
 
x
);

1230 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t


1231 
	$ecb_bö¨y32_to_bö¨y16
 (
uöt32_t
 
x
)

1233 
s
 = (
x
 >> 16) & 0x00008000;

1234 
e
 = ((
x
 >> 23) & 0x000000ff) - (127 - 15);

1235 
m
 = 
x
 & 0x007fffff;

1237 
x
 &= 0x7fffffff;

1240 i‡(
	`ecb_ex≥˘_åue
 (0x38800000 <
x
 && x <= 0x477fefff))

1243 
m
 += 0x00000fff + ((m >> (23 - 10)) & 1);

1246 i‡(
	`ecb_ex≥˘_Ál£
 (
m
 >= 0x00800000))

1248 
m
 >>= 1;

1249 
e
 += 1;

1252  
s
 | (
e
 << 10Ë| (
m
 >> (23 - 10));

1256 i‡(
	`ecb_ex≥˘_åue
 (0x477„ff‡< 
x
 && x <= 0x7f800000))

1257  
s
 | 0x7c00;

1260 i‡(
	`ecb_ex≥˘_åue
 (
x
 < 0x38800000))

1263 i‡(
	`ecb_ex≥˘_åue
 (!
x
))

1264  
s
;

1269 i‡(
e
 < (14 - 24))

1270  
s
;

1272 
m
 |= 0x00800000;

1276 
bôs
 = 14 - 
e
;

1277 
hÆf
 = (1 << (
bôs
 - 1)) - 1;

1278 
eví
 = (
m
 >> 
bôs
) & 1;

1281 
m
 = (m + 
hÆf
 + 
eví
Ë>> 
bôs
;

1284  
s
 | 
m
;

1288 
m
 >>= 13;

1290  
s
 | 0x7c00 | 
m
 | !m;

1291 
	}
}

1299 || 
	g__i386
 || 
	g__i386__
 \

1300 || 
	gECB_GCC_AMD64
 \

1301 || 
	g__powîpc__
 || 
	g__µc__
 || 
	g__powîpc64__
 || 
	g__µc64__
 \

1302 || 
deföed
 
	g__s390__
 || deföed 
	g__s390x__
 \

1303 || 
deföed
 
	g__mùs__
 \

1304 || 
deföed
 
	g__Æpha__
 \

1305 || 
deföed
 
	g__hµa__
 \

1306 || 
deföed
 
	g__ü64__
 \

1307 || 
deföed
 
	g__m68k__
 \

1308 || 
deföed
 
	g__m88k__
 \

1309 || 
deföed
 
	g__sh__
 \

1310 || 
deföed
 
	g_M_IX86
 || deföed 
	gECB_MSVC_AMD64
 || deföed 
	g_M_IA64
 \

1311 || (
deföed
 
	g__¨m__
 && (deföed 
	g__ARM_EABI__
 || deföed 
	g__EABI__
 || deföed 
	g__VFP_FP__
 || deföed 
	g_WIN32_WCE
 || deföed 
	g__ANDROID__
)) \

1312 || 
deföed
 
	g__Ørch64__


1313 
	#ECB_STDFP
 1

	)

1314 
	~<°rög.h
>

1316 
	#ECB_STDFP
 0

	)

1319 #i‚de‡
ECB_NO_LIBM


1321 
	~<m©h.h
>

1324 #ifde‡
INFINITY


1325 
	#ECB_INFINITY
 
INFINITY


	)

1327 
	#ECB_INFINITY
 
HUGE_VAL


	)

1330 #ifde‡
NAN


1331 
	#ECB_NAN
 
NAN


	)

1333 
	#ECB_NAN
 
ECB_INFINITY


	)

1336 #i‡
ECB_C99
 || 
_XOPEN_VERSION
 >600 || 
_POSIX_VERSION
 >= 200112L

1337 
	#ecb_ldexpf
(
x
,
e
Ë
	`ldexpf
 ((x), (e))

	)

1338 
	#ecb_‰expf
(
x
,
e
Ë
	`‰expf
 ((x), (e))

	)

1340 
	#ecb_ldexpf
(
x
,
e
Ë(Ë
	`ldexp
 ((Ë(x), (e))

	)

1341 
	#ecb_‰expf
(
x
,
e
Ë(Ë
	`‰exp
 ((Ë(x), (e))

	)

1345 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t
 
ecb_Êﬂt_to_bö¨y32
 (
x
);

1346 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt32_t


1347 
	$ecb_Êﬂt_to_bö¨y32
 (
x
)

1349 
uöt32_t
 
r
;

1351 #i‡
ECB_STDFP


1352 
	`mem˝y
 (&
r
, &
x
, 4);

1355 
uöt32_t
 
m
;

1356 
e
;

1358 i‡(
x
 == 0e0f )  0x00000000U;

1359 i‡(
x
 > +3.40282346638528860e+38f)  0x7f800000U;

1360 i‡(
x
 < -3.40282346638528860e+38f)  0xff800000U;

1361 i‡(
x
 != x )  0x7fbfffffU;

1363 
m
 = 
	`ecb_‰expf
 (
x
, &
e
) * 0x1000000U;

1365 
r
 = 
m
 & 0x80000000U;

1367 i‡(
r
)

1368 
m
 = -m;

1370 i‡(
e
 <= -126)

1372 
m
 &= 0xffffffU;

1373 
m
 >>(-125 - 
e
);

1374 
e
 = -126;

1377 
r
 |(
e
 + 126) << 23;

1378 
r
 |
m
 & 0x7fffffU;

1381  
r
;

1382 
	}
}

1385 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_bö¨y32_to_Êﬂt
 (
uöt32_t
 
x
);

1386 
ecb_fun˘i⁄_
 
ecb_c⁄°
 

1387 
	$ecb_bö¨y32_to_Êﬂt
 (
uöt32_t
 
x
)

1389 
r
;

1391 #i‡
ECB_STDFP


1392 
	`mem˝y
 (&
r
, &
x
, 4);

1395 
√g
 = 
x
 >> 31;

1396 
e
 = (
x
 >> 23) & 0xffU;

1398 
x
 &= 0x7fffffU;

1400 i‡(
e
)

1401 
x
 |= 0x800000U;

1403 
e
 = 1;

1406 
r
 = 
	`ecb_ldexpf
 (
x
 * (0.5‡/ 0x800000U), 
e
 - 126);

1408 
r
 = 
√g
 ? -r :Ñ;

1411  
r
;

1412 
	}
}

1415 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt64_t
 
ecb_doubÀ_to_bö¨y64
 (
x
);

1416 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt64_t


1417 
	$ecb_doubÀ_to_bö¨y64
 (
x
)

1419 
uöt64_t
 
r
;

1421 #i‡
ECB_STDFP


1422 
	`mem˝y
 (&
r
, &
x
, 8);

1425 
uöt64_t
 
m
;

1426 
e
;

1428 i‡(
x
 == 0e0 )  0x0000000000000000U;

1429 i‡(
x
 > +1.79769313486231470e+308)  0x7ff0000000000000U;

1430 i‡(
x
 < -1.79769313486231470e+308)  0xfff0000000000000U;

1431 i‡(
x
 != x )  0X7ff7ffffffffffffU;

1433 
m
 = 
	`‰exp
 (
x
, &
e
) * 0x20000000000000U;

1435 
r
 = 
m
 & 0x8000000000000000;;

1437 i‡(
r
)

1438 
m
 = -m;

1440 i‡(
e
 <= -1022)

1442 
m
 &= 0x1fffffffffffffU;

1443 
m
 >>(-1021 - 
e
);

1444 
e
 = -1022;

1447 
r
 |((
uöt64_t
)(
e
 + 1022)) << 52;

1448 
r
 |
m
 & 0xfffffffffffffU;

1451  
r
;

1452 
	}
}

1455 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_bö¨y64_to_doubÀ
 (
uöt64_t
 
x
);

1456 
ecb_fun˘i⁄_
 
ecb_c⁄°
 

1457 
	$ecb_bö¨y64_to_doubÀ
 (
uöt64_t
 
x
)

1459 
r
;

1461 #i‡
ECB_STDFP


1462 
	`mem˝y
 (&
r
, &
x
, 8);

1465 
√g
 = 
x
 >> 63;

1466 
e
 = (
x
 >> 52) & 0x7ffU;

1468 
x
 &= 0xfffffffffffffU;

1470 i‡(
e
)

1471 
x
 |= 0x10000000000000U;

1473 
e
 = 1;

1476 
r
 = 
	`ldexp
 (
x
 * (0.5 / 0x10000000000000U), 
e
 - 1022);

1478 
r
 = 
√g
 ? -r :Ñ;

1481  
r
;

1482 
	}
}

1485 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t
 
ecb_Êﬂt_to_bö¨y16
 (
x
);

1486 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
uöt16_t


1487 
	$ecb_Êﬂt_to_bö¨y16
 (
x
)

1489  
	`ecb_bö¨y32_to_bö¨y16
 (
	`ecb_Êﬂt_to_bö¨y32
 (
x
));

1490 
	}
}

1493 
ecb_fun˘i⁄_
 
ecb_c⁄°
 
ecb_bö¨y16_to_Êﬂt
 (
uöt16_t
 
x
);

1494 
ecb_fun˘i⁄_
 
ecb_c⁄°
 

1495 
	$ecb_bö¨y16_to_Êﬂt
 (
uöt16_t
 
x
)

1497  
	`ecb_bö¨y32_to_Êﬂt
 (
	`ecb_bö¨y16_to_bö¨y32
 (
x
));

1498 
	}
}

1506 #i‡
ECB_MEMORY_FENCE_NEEDS_PTHREADS


1517 #i‚de‡
ECB_MEMORY_FENCE


1518 
	#ECB_MEMORY_FENCE
 dÿ{ } 0)

	)

1519 
	#ECB_MEMORY_FENCE_ACQUIRE
 
ECB_MEMORY_FENCE


	)

1520 
	#ECB_MEMORY_FENCE_RELEASE
 
ECB_MEMORY_FENCE


	)

1523 
	#ex≥˘_Ál£
(
c⁄d
Ë
	`ecb_ex≥˘_Ál£
 (c⁄d)

	)

1524 
	#ex≥˘_åue
(
c⁄d
Ë
	`ecb_ex≥˘_åue
 (c⁄d)

	)

1525 
	#noölöe
 
ecb_noölöe


	)

1527 
	#ölöe_size
 
ecb_ölöe


	)

1529 #i‡
EV_FEATURE_CODE


1530 
	#ölöe_•ìd
 
ecb_ölöe


	)

1532 
	#ölöe_•ìd
 
noölöe


	)

1535 
	#NUMPRI
 (
EV_MAXPRI
 - 
EV_MINPRI
 + 1)

	)

1537 #i‡
EV_MINPRI
 =
EV_MAXPRI


1538 
	#ABSPRI
(
w
Ë(((
W
)w), 0)

	)

1540 
	#ABSPRI
(
w
Ë(((
W
)w)->
¥i‹ôy
 - 
EV_MINPRI
)

	)

1543 
	#EMPTY


	)

1544 
	#EMPTY2
(
a
,
b
Ë

	)

1546 
ev_w©chî
 *
	tW
;

1547 
ev_w©chî_li°
 *
	tWL
;

1548 
ev_w©chî_time
 *
	tWT
;

1550 
	#ev_a˘ive
(
w
Ë((
W
)(w))->
a˘ive


	)

1551 
	#ev_©
(
w
Ë((
WT
)(w))->
©


	)

1553 #i‡
EV_USE_REALTIME


1556 
EV_ATOMIC_T
 
	ghave_ªÆtime
;

1559 #i‡
EV_USE_MONOTONIC


1560 
EV_ATOMIC_T
 
	ghave_m⁄Ÿ⁄ic
;

1563 #i‚de‡
EV_FD_TO_WIN32_HANDLE


1564 
	#EV_FD_TO_WIN32_HANDLE
(
fd
Ë
	`_gë_osfh™dÀ
 (fd)

	)

1566 #i‚de‡
EV_WIN32_HANDLE_TO_FD


1567 
	#EV_WIN32_HANDLE_TO_FD
(
h™dÀ
Ë
	`_›í_osfh™dÀ
 (h™dÀ, 0)

	)

1569 #i‚de‡
EV_WIN32_CLOSE_FD


1570 
	#EV_WIN32_CLOSE_FD
(
fd
Ë
	`˛o£
 (fd)

	)

1573 #ifde‡
_WIN32


1574 
	~"ev_wö32.c
"

1581 #i‡
EV_USE_FLOOR


1582 
	~<m©h.h
>

1583 
	#ev_Êo‹
(
v
Ë
	`Êo‹
 (v)

	)

1586 
	~<Êﬂt.h
>

1589 
ev_t°amp
 
noölöe


1590 
	$ev_Êo‹
 (
ev_t°amp
 
v
)

1593 #i‡
FLT_RADIX
 != 2

1594 c⁄° 
ev_t°amp
 
shi·
 =  () >= 8 ? 10000000000000000000. : 1000000000.;

1596 c⁄° 
ev_t°amp
 
shi·
 =  () >= 8 ? 18446744073709551616. : 4294967296.;

1600 i‡(
	`ex≥˘_Ál£
 (
v
 >
shi·
))

1602 
ev_t°amp
 
f
;

1604 i‡(
v
 == v - 1.)

1605  
v
;

1607 
f
 = 
shi·
 * 
	`ev_Êo‹
 (
v
 * (1. / shift));

1608  
f
 + 
	`ev_Êo‹
 (
v
 - f);

1612 i‡(
	`ex≥˘_Ál£
 (
v
 < 0.))

1614 
ev_t°amp
 
f
 = -
	`ev_Êo‹
 (-
v
);

1616  
f
 - (‡=
v
 ? 0 : 1);

1620  ()
v
;

1621 
	}
}

1627 #ifde‡
__löux


1628 
	~<sys/ut¢ame.h
>

1631 
noölöe
 
ecb_cﬁd


1632 
	$ev_löux_vîsi⁄
 ()

1634 #ifde‡
__löux


1635 
v
 = 0;

1636 
ut¢ame
 
buf
;

1637 
i
;

1638 *
p
 = 
buf
.
ªÀa£
;

1640 i‡(
	`u«me
 (&
buf
))

1643 
i
 = 3+1; --i; )

1645 
c
 = 0;

1649 i‡(*
p
 >= '0' && *p <= '9')

1650 
c
 = c * 10 + *
p
++ - '0';

1653 
p
 += *p == '.';

1658 
v
 = (v << 8Ë| 
c
;

1661  
v
;

1665 
	}
}

1669 #i‡
EV_AVOID_STDIO


1670 
noölöe
 
ecb_cﬁd


1671 
	$ev_¥öãº
 (c⁄° *
msg
)

1673 
	`wrôe
 (
STDERR_FILENO
, 
msg
, 
	`°æí
 (msg));

1674 
	}
}

1677 (*
sy£º_cb
)(c⁄° *
msg
Ë
EV_THROW
;

1679 
ecb_cﬁd


1680 
	$ev_£t_sy£º_cb
 ((*
cb
)(c⁄° *
msg
Ë
EV_THROW
) EV_THROW

1682 
sy£º_cb
 = 
cb
;

1683 
	}
}

1685 
noölöe
 
ecb_cﬁd


1686 
	$ev_sy£º
 (c⁄° *
msg
)

1688 i‡(!
msg
)

1689 
msg
 = "(libev) systemÉrror";

1691 i‡(
sy£º_cb
)

1692 
	`sy£º_cb
 (
msg
);

1695 #i‡
EV_AVOID_STDIO


1696 
	`ev_¥öãº
 (
msg
);

1697 
	`ev_¥öãº
 (": ");

1698 
	`ev_¥öãº
 (
	`°ªº‹
 (
î∫o
));

1699 
	`ev_¥öãº
 ("\n");

1701 
	`≥º‹
 (
msg
);

1703 
	`ab‹t
 ();

1705 
	}
}

1708 
	$ev_ªÆloc_emul
 (*
±r
, 
size
Ë
EV_THROW


1717 i‡(
size
)

1718  
	`ªÆloc
 (
±r
, 
size
);

1720 
	`‰ì
 (
±r
);

1722 
	}
}

1724 *(*
	gÆloc
)(*
	g±r
, 
	gsize
Ë
	gEV_THROW
 = 
ev_ªÆloc_emul
;

1726 
ecb_cﬁd


1727 
	$ev_£t_Æloˇt‹
 (*(*
cb
)(*
±r
, 
size
Ë
EV_THROW
) EV_THROW

1729 
Æloc
 = 
cb
;

1730 
	}
}

1732 
ölöe_•ìd
 *

1733 
	$ev_ªÆloc
 (*
±r
, 
size
)

1735 
±r
 = 
	`Æloc
 (±r, 
size
);

1737 i‡(!
±r
 && 
size
)

1739 #i‡
EV_AVOID_STDIO


1740 
	`ev_¥öãº
 ("(libev) memoryállocation failed,áborting.\n");

1742 
	`Ârötf
 (
°dîr
, "÷ibevËˇ¬ŸáŒoˇã %ld byãs,áb‹tög.", 
size
);

1744 
	`ab‹t
 ();

1747  
±r
;

1748 
	}
}

1750 
	#ev_mÆloc
(
size
Ë
	`ev_ªÆloc
 (0, (size))

	)

1751 
	#ev_‰ì
(
±r
Ë
	`ev_ªÆloc
 (’å), 0)

	)

1756 
	#EV_ANFD_REIFY
 1

	)

1761 
WL
 
	mhód
;

1762 
	mevíts
;

1763 
	mªify
;

1764 
	memask
;

1765 
	munu£d
;

1766 #i‡
EV_USE_EPOLL


1767 
	megí
;

1769 #i‡
EV_SELECT_IS_WINSOCKET
 || 
EV_USE_IOCP


1770 
SOCKET
 
	mh™dÀ
;

1772 #i‡
EV_USE_IOCP


1773 
OVERLAPPED
 
	m‹
, 
	mow
;

1775 } 
	tANFD
;

1780 
W
 
	mw
;

1781 
	mevíts
;

1782 } 
	tANPENDING
;

1784 #i‡
EV_USE_INOTIFY


1788 
WL
 
	mhód
;

1789 } 
	tANFS
;

1793 #i‡
EV_HEAP_CACHE_AT


1796 
ev_t°amp
 
	m©
;

1797 
WT
 
	mw
;

1798 } 
	tANHE
;

1800 
	#ANHE_w
(
he
Ë(he).
w


	)

1801 
	#ANHE_©
(
he
Ë(he).
©


	)

1802 
	#ANHE_©_ˇche
(
he
Ë(he).
©
 = (he).
w
->©

	)

1805 
WT
 
	tANHE
;

1807 
	#ANHE_w
(
he
Ë(he)

	)

1808 
	#ANHE_©
(
he
Ë(he)->
©


	)

1809 
	#ANHE_©_ˇche
(
he
)

	)

1812 #i‡
EV_MULTIPLICITY


1814 
	sev_lo›


1816 
ev_t°amp
 
	mev_π_now
;

1817 
	#ev_π_now
 ((
lo›
)->
ev_π_now
)

	)

1818 
	#VAR
(
«me
,
de˛
Ëde˛;

	)

1819 
	~"ev_v¨s.h
"

1820 #unde‡
VAR


1822 
	~"ev_wøp.h
"

1824 
ev_lo›
 
	gdeÁu…_lo›_°ru˘
;

1825 
EV_API_DECL
 
ev_lo›
 *
	gev_deÁu…_lo›_±r
 = 0;

1829 
EV_API_DECL
 
ev_t°amp
 
	gev_π_now
 = 0;

1830 
	#VAR
(
«me
,
de˛
Ëde˛;

	)

1831 
	~"ev_v¨s.h
"

1832 #unde‡
VAR


1834 
	gev_deÁu…_lo›_±r
;

1838 #i‡
EV_FEATURE_API


1839 
	#EV_RELEASE_CB
 i‡(
	`ex≥˘_Ál£
 (
ªÀa£_cb
)Ë
	`ªÀa£_cb
 (
EV_A
)

	)

1840 
	#EV_ACQUIRE_CB
 i‡(
	`ex≥˘_Ál£
 (
acquúe_cb
)Ë
	`acquúe_cb
 (
EV_A
)

	)

1841 
	#EV_INVOKE_PENDING
 
	`övoke_cb
 (
EV_A
)

	)

1843 
	#EV_RELEASE_CB
 ()0

	)

1844 
	#EV_ACQUIRE_CB
 ()0

	)

1845 
	#EV_INVOKE_PENDING
 
	`ev_övoke_≥ndög
 (
EV_A
)

	)

1848 
	#EVBREAK_RECURSE
 0x80

	)

1852 #i‚de‡
EV_HAVE_EV_TIME


1853 
ev_t°amp


1854 
	$ev_time
 (Ë
EV_THROW


1856 #i‡
EV_USE_REALTIME


1857 i‡(
	`ex≥˘_åue
 (
have_ªÆtime
))

1859 
time•ec
 
ts
;

1860 
	`˛ock_gëtime
 (
CLOCK_REALTIME
, &
ts
);

1861  
ts
.
tv_£c
 +Ås.
tv_n£c
 * 1e-9;

1865 
timevÆ
 
tv
;

1866 
	`gëtimeofday
 (&
tv
, 0);

1867  
tv
.
tv_£c
 +Åv.
tv_u£c
 * 1e-6;

1868 
	}
}

1871 
ölöe_size
 
ev_t°amp


1872 
	$gë_˛ock
 ()

1874 #i‡
EV_USE_MONOTONIC


1875 i‡(
	`ex≥˘_åue
 (
have_m⁄Ÿ⁄ic
))

1877 
time•ec
 
ts
;

1878 
	`˛ock_gëtime
 (
CLOCK_MONOTONIC
, &
ts
);

1879  
ts
.
tv_£c
 +Ås.
tv_n£c
 * 1e-9;

1883  
	`ev_time
 ();

1884 
	}
}

1886 #i‡
EV_MULTIPLICITY


1887 
ev_t°amp


1888 
	$ev_now
 (
EV_P
Ë
EV_THROW


1890  
ev_π_now
;

1891 
	}
}

1895 
	$ev_¶ìp
 (
ev_t°amp
 
dñay
Ë
EV_THROW


1897 i‡(
dñay
 > 0.)

1899 #i‡
EV_USE_NANOSLEEP


1900 
time•ec
 
ts
;

1902 
	`EV_TS_SET
 (
ts
, 
dñay
);

1903 
	`«no¶ìp
 (&
ts
, 0);

1904 #ñi‡
deföed
 
_WIN32


1905 
	`SÀï
 (()(
dñay
 * 1e3));

1907 
timevÆ
 
tv
;

1912 
	`EV_TV_SET
 (
tv
, 
dñay
);

1913 
	`£À˘
 (0, 0, 0, 0, &
tv
);

1916 
	}
}

1920 
	#MALLOC_ROUND
 4096

	)

1924 
ölöe_size
 

1925 
	$¨øy_√xtsize
 (
ñem
, 
cur
, 
˙t
)

1927 
ncur
 = 
cur
 + 1;

1930 
ncur
 <<= 1;

1931 
˙t
 > 
ncur
);

1934 i‡(
ñem
 * 
ncur
 > 
MALLOC_ROUND
 -  (*) * 4)

1936 
ncur
 *
ñem
;

1937 
ncur
 = (ncu∏+ 
ñem
 + (
MALLOC_ROUND
 - 1) +  (*) * 4) & ~(MALLOC_ROUND - 1);

1938 
ncur
 =Çcur -  (*) * 4;

1939 
ncur
 /
ñem
;

1942  
ncur
;

1943 
	}
}

1945 * 
noölöe
 
ecb_cﬁd


1946 
	$¨øy_ªÆloc
 (
ñem
, *
ba£
, *
cur
, 
˙t
)

1948 *
cur
 = 
	`¨øy_√xtsize
 (
ñem
, *cur, 
˙t
);

1949  
	`ev_ªÆloc
 (
ba£
, 
ñem
 * *
cur
);

1950 
	}
}

1952 
	#¨øy_öô_zîo
(
ba£
,
cou¡
) \

1953 
	`mem£t
 ((*)(
ba£
), 0,  (*(ba£)Ë* (
cou¡
))

	)

1955 
	#¨øy_√edsize
(
ty≥
,
ba£
,
cur
,
˙t
,
öô
) \

1956 i‡(
	`ex≥˘_Ál£
 ((
˙t
Ë> (
cur
))) \

1958 
ecb_unu£d
 
ocur_
 = (
cur
); \

1959 (
ba£
Ë(
ty≥
 *)
¨øy_ªÆloc
 \

1960 ( (
ty≥
), (
ba£
), &(
cur
), (
˙t
)); \

1961 
	`öô
 ((
ba£
Ë+ (
ocur_
), (
cur
) - ocur_); \

1962 }

	)

1965 
	#¨øy_¶im
(
ty≥
,
°em
) \

1966 i‡(
°em
 ## 
max
 < 
	`¨øy_roundsize
 (°em ## 
˙t
 >> 2)) \

1968 
°em
 ## 
max
 = 
	`¨øy_roundsize
 (°em ## 
˙t
 >> 1); \

1969 
ba£
 = (
ty≥
 *)
	`ev_ªÆloc
 (ba£,  (ty≥Ë* (
°em
 ## 
max
));\

1970 
	`Ârötf
 (
°dîr
, "¶immed dow¿" #°em "Åÿ%d\n", 
°em
 ## 
max
); \

1971 }

	)

1974 
	#¨øy_‰ì
(
°em
, 
idx
) \

1975 
	`ev_‰ì
 (
°em
 ## 
s
 
idx
); sãm ## 
˙t
 idx = sãm ## 
max
 idx = 0; sãm ## s idx = 0

	)

1980 
noölöe


1981 
	$≥ndögcb
 (
EV_P_
 
ev_¥ï¨e
 *
w
, 
ªvíts
)

1983 
	}
}

1985 
noölöe


1986 
	$ev_„ed_evít
 (
EV_P_
 *
w
, 
ªvíts
Ë
EV_THROW


1988 
W
 
w_
 = (W)
w
;

1989 
¥i
 = 
	`ABSPRI
 (
w_
);

1991 i‡(
	`ex≥˘_Ál£
 (
w_
->
≥ndög
))

1992 
≥ndögs
 [
¥i
][
w_
->
≥ndög
 - 1].
evíts
 |
ªvíts
;

1995 
w_
->
≥ndög
 = ++
≥ndög˙t
 [
¥i
];

1996 
	`¨øy_√edsize
 (
ANPENDING
, 
≥ndögs
 [
¥i
], 
≥ndögmax
 [¥i], 
w_
->
≥ndög
, 
EMPTY2
);

1997 
≥ndögs
 [
¥i
][
w_
->
≥ndög
 - 1].
w
 = w_;

1998 
≥ndögs
 [
¥i
][
w_
->
≥ndög
 - 1].
evíts
 = 
ªvíts
;

2001 
≥ndög¥i
 = 
NUMPRI
 - 1;

2002 
	}
}

2004 
ölöe_•ìd
 

2005 
	$„ed_ªvî£
 (
EV_P_
 
W
 
w
)

2007 
	`¨øy_√edsize
 (
W
, 
r„eds
, 
r„edmax
, 
r„ed˙t
 + 1, 
EMPTY2
);

2008 
r„eds
 [
r„ed˙t
++] = 
w
;

2009 
	}
}

2011 
ölöe_size
 

2012 
	$„ed_ªvî£_d⁄e
 (
EV_P_
 
ªvíts
)

2015 
	`ev_„ed_evít
 (
EV_A_
 
r„eds
 [--
r„ed˙t
], 
ªvíts
);

2016 
r„ed˙t
);

2017 
	}
}

2019 
ölöe_•ìd
 

2020 
	$queue_evíts
 (
EV_P_
 
W
 *
evíts
, 
evít˙t
, 
ty≥
)

2022 
i
;

2024 
i
 = 0; i < 
evít˙t
; ++i)

2025 
	`ev_„ed_evít
 (
EV_A_
 
evíts
 [
i
], 
ty≥
);

2026 
	}
}

2030 
ölöe_•ìd
 

2031 
	$fd_evít_nocheck
 (
EV_P_
 
fd
, 
ªvíts
)

2033 
ANFD
 *
™fd
 = 
™fds
 + 
fd
;

2034 
ev_io
 *
w
;

2036 
w
 = (
ev_io
 *)
™fd
->
hód
; w; w = (ev_iÿ*)((
WL
)w)->
√xt
)

2038 
ev
 = 
w
->
evíts
 & 
ªvíts
;

2040 i‡(
ev
)

2041 
	`ev_„ed_evít
 (
	`EV_A_
 (
W
)
w
, 
ev
);

2043 
	}
}

2047 
ölöe_•ìd
 

2048 
	$fd_evít
 (
EV_P_
 
fd
, 
ªvíts
)

2050 
ANFD
 *
™fd
 = 
™fds
 + 
fd
;

2052 i‡(
	`ex≥˘_åue
 (!
™fd
->
ªify
))

2053 
	`fd_evít_nocheck
 (
EV_A_
 
fd
, 
ªvíts
);

2054 
	}
}

2057 
	$ev_„ed_fd_evít
 (
EV_P_
 
fd
, 
ªvíts
Ë
EV_THROW


2059 i‡(
fd
 >0 && fd < 
™fdmax
)

2060 
	`fd_evít_nocheck
 (
EV_A_
 
fd
, 
ªvíts
);

2061 
	}
}

2065 
ölöe_size
 

2066 
	$fd_ªify
 (
EV_P
)

2068 
i
;

2070 #i‡
EV_SELECT_IS_WINSOCKET
 || 
EV_USE_IOCP


2071 
i
 = 0; i < 
fdch™ge˙t
; ++i)

2073 
fd
 = 
fdch™ges
 [
i
];

2074 
ANFD
 *
™fd
 = 
™fds
 + 
fd
;

2076 i‡(
™fd
->
ªify
 & 
EV__IOFDSET
 &&ánfd->
hód
)

2078 
SOCKET
 
h™dÀ
 = 
	`EV_FD_TO_WIN32_HANDLE
 (
fd
);

2080 i‡(
h™dÀ
 !
™fd
->handle)

2082 
¨g
;

2084 
	`as£π
 (("libev: o∆y sockë fd†suµ‹ãd i¿thi†c⁄figuøti⁄", 
	`io˘lsockë
 (
h™dÀ
, 
FIONREAD
, &
¨g
) == 0));

2087 
	`backíd_modify
 (
EV_A_
 
fd
, 
™fd
->
evíts
, 0);

2088 
™fd
->
evíts
 = 0;

2089 
™fd
->
h™dÀ
 = handle;

2095 
i
 = 0; i < 
fdch™ge˙t
; ++i)

2097 
fd
 = 
fdch™ges
 [
i
];

2098 
ANFD
 *
™fd
 = 
™fds
 + 
fd
;

2099 
ev_io
 *
w
;

2101 
o_evíts
 = 
™fd
->
evíts
;

2102 
o_ªify
 = 
™fd
->
ªify
;

2104 
™fd
->
ªify
 = 0;

2108 
™fd
->
evíts
 = 0;

2110 
w
 = (
ev_io
 *)
™fd
->
hód
; w; w = (ev_iÿ*)((
WL
)w)->
√xt
)

2111 
™fd
->
evíts
 |()
w
->events;

2113 i‡(
o_evíts
 !
™fd
->
evíts
)

2114 
o_ªify
 = 
EV__IOFDSET
;

2117 i‡(
o_ªify
 & 
EV__IOFDSET
)

2118 
	`backíd_modify
 (
EV_A_
 
fd
, 
o_evíts
, 
™fd
->
evíts
);

2121 
fdch™ge˙t
 = 0;

2122 
	}
}

2125 
ölöe_size
 

2126 
	$fd_ch™ge
 (
EV_P_
 
fd
, 
Êags
)

2128 
ªify
 = 
™fds
 [
fd
].reify;

2129 
™fds
 [
fd
].
ªify
 |
Êags
;

2131 i‡(
	`ex≥˘_åue
 (!
ªify
))

2133 ++
fdch™ge˙t
;

2134 
	`¨øy_√edsize
 (, 
fdch™ges
, 
fdch™gemax
, 
fdch™ge˙t
, 
EMPTY2
);

2135 
fdch™ges
 [
fdch™ge˙t
 - 1] = 
fd
;

2137 
	}
}

2140 
ölöe_•ìd
 
ecb_cﬁd


2141 
	$fd_kûl
 (
EV_P_
 
fd
)

2143 
ev_io
 *
w
;

2145 (
w
 = (
ev_io
 *)
™fds
 [
fd
].
hód
))

2147 
	`ev_io_°›
 (
EV_A_
 
w
);

2148 
	`ev_„ed_evít
 (
	`EV_A_
 (
W
)
w
, 
EV_ERROR
 | 
EV_READ
 | 
EV_WRITE
);

2150 
	}
}

2153 
ölöe_size
 
ecb_cﬁd


2154 
	$fd_vÆid
 (
fd
)

2156 #ifde‡
_WIN32


2157  
	`EV_FD_TO_WIN32_HANDLE
 (
fd
) != -1;

2159  
	`f˙é
 (
fd
, 
F_GETFD
) != -1;

2161 
	}
}

2164 
noölöe
 
ecb_cﬁd


2165 
	$fd_ebadf
 (
EV_P
)

2167 
fd
;

2169 
fd
 = 0; fd < 
™fdmax
; ++fd)

2170 i‡(
™fds
 [
fd
].
evíts
)

2171 i‡(!
	`fd_vÆid
 (
fd
Ë&& 
î∫o
 =
EBADF
)

2172 
	`fd_kûl
 (
EV_A_
 
fd
);

2173 
	}
}

2176 
noölöe
 
ecb_cﬁd


2177 
	$fd_íomem
 (
EV_P
)

2179 
fd
;

2181 
fd
 = 
™fdmax
; fd--; )

2182 i‡(
™fds
 [
fd
].
evíts
)

2184 
	`fd_kûl
 (
EV_A_
 
fd
);

2187 
	}
}

2190 
noölöe


2191 
	$fd_ª¨m_Æl
 (
EV_P
)

2193 
fd
;

2195 
fd
 = 0; fd < 
™fdmax
; ++fd)

2196 i‡(
™fds
 [
fd
].
evíts
)

2198 
™fds
 [
fd
].
evíts
 = 0;

2199 
™fds
 [
fd
].
emask
 = 0;

2200 
	`fd_ch™ge
 (
EV_A_
 
fd
, 
EV__IOFDSET
 | 
EV_ANFD_REIFY
);

2202 
	}
}

2206 
ölöe_•ìd
 

2207 
	$fd_öã∫
 (
fd
)

2209 #ifde‡
_WIN32


2210 
¨g
 = 1;

2211 
	`io˘lsockë
 (
	`EV_FD_TO_WIN32_HANDLE
 (
fd
), 
FIONBIO
, &
¨g
);

2213 
	`f˙é
 (
fd
, 
F_SETFD
, 
FD_CLOEXEC
);

2214 
	`f˙é
 (
fd
, 
F_SETFL
, 
O_NONBLOCK
);

2216 
	}
}

2232 #i‡
EV_USE_4HEAP


2234 
	#DHEAP
 4

	)

2235 
	#HEAP0
 (
DHEAP
 - 1Ë

	)

2236 
	#HPARENT
(
k
Ë((((kË- 
HEAP0
 - 1Ë/ 
DHEAP
Ë+ HEAP0)

	)

2237 
	#UPHEAP_DONE
(
p
,
k
Ë(’Ë=(k))

	)

2240 
ölöe_•ìd
 

2241 
	$downhóp
 (
ANHE
 *
hóp
, 
N
, 
k
)

2243 
ANHE
 
he
 = 
hóp
 [
k
];

2244 
ANHE
 *
E
 = 
hóp
 + 
N
 + 
HEAP0
;

2248 
ev_t°amp
 
mö©
;

2249 
ANHE
 *
möpos
;

2250 
ANHE
 *
pos
 = 
hóp
 + 
DHEAP
 * (
k
 - 
HEAP0
) + HEAP0 + 1;

2253 i‡(
	`ex≥˘_åue
 (
pos
 + 
DHEAP
 - 1 < 
E
))

2255  (
möpos
 = 
pos
 + 0), (
mö©
 = 
	`ANHE_©
 (*minpos));

2256 i‡–
	`ANHE_©
 (
pos
 [1]Ë< 
mö©
Ë(
möpos
 =Öos + 1), (minat = ANHE_at (*minpos));

2257 i‡–
	`ANHE_©
 (
pos
 [2]Ë< 
mö©
Ë(
möpos
 =Öos + 2), (minat = ANHE_at (*minpos));

2258 i‡–
	`ANHE_©
 (
pos
 [3]Ë< 
mö©
Ë(
möpos
 =Öos + 3), (minat = ANHE_at (*minpos));

2260 i‡(
pos
 < 
E
)

2262  (
möpos
 = 
pos
 + 0), (
mö©
 = 
	`ANHE_©
 (*minpos));

2263 i‡(
pos
 + 1 < 
E
 && 
	`ANHE_©
 (po†[1]Ë< 
mö©
Ë(
möpos
 =Öos + 1), (minat = ANHE_at (*minpos));

2264 i‡(
pos
 + 2 < 
E
 && 
	`ANHE_©
 (po†[2]Ë< 
mö©
Ë(
möpos
 =Öos + 2), (minat = ANHE_at (*minpos));

2265 i‡(
pos
 + 3 < 
E
 && 
	`ANHE_©
 (po†[3]Ë< 
mö©
Ë(
möpos
 =Öos + 3), (minat = ANHE_at (*minpos));

2270 i‡(
	`ANHE_©
 (
he
Ë<
mö©
)

2273 
hóp
 [
k
] = *
möpos
;

2274 
	`ev_a˘ive
 (
	`ANHE_w
 (*
möpos
)Ë
k
;

2276 
k
 = 
möpos
 - 
hóp
;

2279 
hóp
 [
k
] = 
he
;

2280 
	`ev_a˘ive
 (
	`ANHE_w
 (
he
)Ë
k
;

2281 
	}
}

2285 
	#HEAP0
 1

	)

2286 
	#HPARENT
(
k
Ë((kË>> 1)

	)

2287 
	#UPHEAP_DONE
(
p
,
k
Ë(!’))

	)

2290 
ölöe_•ìd
 

2291 
	$downhóp
 (
ANHE
 *
hóp
, 
N
, 
k
)

2293 
ANHE
 
he
 = 
hóp
 [
k
];

2297 
c
 = 
k
 << 1;

2299 i‡(
c
 >
N
 + 
HEAP0
)

2302 
c
 +¯+ 1 < 
N
 + 
HEAP0
 && 
	`ANHE_©
 (
hóp
 [c]) > ANHE_at (heap [c + 1])

2305 i‡(
	`ANHE_©
 (
he
Ë<ANHE_© (
hóp
 [
c
]))

2308 
hóp
 [
k
] = hó∞[
c
];

2309 
	`ev_a˘ive
 (
	`ANHE_w
 (
hóp
 [
k
])) = k;

2311 
k
 = 
c
;

2314 
hóp
 [
k
] = 
he
;

2315 
	`ev_a˘ive
 (
	`ANHE_w
 (
he
)Ë
k
;

2316 
	}
}

2320 
ölöe_•ìd
 

2321 
	$uphóp
 (
ANHE
 *
hóp
, 
k
)

2323 
ANHE
 
he
 = 
hóp
 [
k
];

2327 
p
 = 
	`HPARENT
 (
k
);

2329 i‡(
	`UPHEAP_DONE
 (
p
, 
k
Ë|| 
	`ANHE_©
 (
hóp
 [p]Ë<ANHE_© (
he
))

2332 
hóp
 [
k
] = hó∞[
p
];

2333 
	`ev_a˘ive
 (
	`ANHE_w
 (
hóp
 [
k
])) = k;

2334 
k
 = 
p
;

2337 
hóp
 [
k
] = 
he
;

2338 
	`ev_a˘ive
 (
	`ANHE_w
 (
he
)Ë
k
;

2339 
	}
}

2342 
ölöe_size
 

2343 
	$adju°hóp
 (
ANHE
 *
hóp
, 
N
, 
k
)

2345 i‡(
k
 > 
HEAP0
 && 
	`ANHE_©
 (
hóp
 [k]Ë<ANHE_© (hó∞[
	`HPARENT
 (k)]))

2346 
	`uphóp
 (
hóp
, 
k
);

2348 
	`downhóp
 (
hóp
, 
N
, 
k
);

2349 
	}
}

2352 
ölöe_size
 

2353 
	$ªhóp
 (
ANHE
 *
hóp
, 
N
)

2355 
i
;

2359 
i
 = 0; i < 
N
; ++i)

2360 
	`uphóp
 (
hóp
, 
i
 + 
HEAP0
);

2361 
	}
}

2368 
EV_ATOMIC_T
 
	m≥ndög
;

2369 #i‡
EV_MULTIPLICITY


2370 
	mEV_P
;

2372 
WL
 
	mhód
;

2373 } 
	tANSIG
;

2375 
ANSIG
 
	gsig«ls
 [
EV_NSIG
 - 1];

2379 #i‡
EV_SIGNAL_ENABLE
 || 
EV_ASYNC_ENABLE


2381 
noölöe
 
ecb_cﬁd


2382 
	$evpùe_öô
 (
EV_P
)

2384 i‡(!
	`ev_is_a˘ive
 (&
pùe_w
))

2386 
fds
 [2];

2388 #i‡
EV_USE_EVENTFD


2389 
fds
 [0] = -1;

2390 
fds
 [1] = 
	`evítfd
 (0, 
EFD_NONBLOCK
 | 
EFD_CLOEXEC
);

2391 i‡(
fds
 [1] < 0 && 
î∫o
 =
EINVAL
)

2392 
fds
 [1] = 
	`evítfd
 (0, 0);

2394 i‡(
fds
 [1] < 0)

2397 
	`pùe
 (
fds
))

2398 
	`ev_sy£º
 ("(libev)Érror creating signal/asyncÖipe");

2400 
	`fd_öã∫
 (
fds
 [0]);

2403 
evpùe
 [0] = 
fds
 [0];

2405 i‡(
evpùe
 [1] < 0)

2406 
evpùe
 [1] = 
fds
 [1];

2414 
	`dup2
 (
fds
 [1], 
evpùe
 [1]);

2415 
	`˛o£
 (
fds
 [1]);

2418 
	`fd_öã∫
 (
evpùe
 [1]);

2420 
	`ev_io_£t
 (&
pùe_w
, 
evpùe
 [0] < 0 ?Évpùê[1] :Évpùê[0], 
EV_READ
);

2421 
	`ev_io_°¨t
 (
EV_A_
 &
pùe_w
);

2422 
	`ev_uƒef
 (
EV_A
);

2424 
	}
}

2426 
ölöe_•ìd
 

2427 
	$evpùe_wrôe
 (
EV_P_
 
EV_ATOMIC_T
 *
Êag
)

2429 
ECB_MEMORY_FENCE
;

2431 i‡(
	`ex≥˘_åue
 (*
Êag
))

2434 *
Êag
 = 1;

2435 
ECB_MEMORY_FENCE_RELEASE
;

2437 
pùe_wrôe_skù≥d
 = 1;

2439 
ECB_MEMORY_FENCE
;

2441 i‡(
pùe_wrôe_w™ãd
)

2443 
ﬁd_î∫o
;

2445 
pùe_wrôe_skù≥d
 = 0;

2446 
ECB_MEMORY_FENCE_RELEASE
;

2448 
ﬁd_î∫o
 = 
î∫o
;

2450 #i‡
EV_USE_EVENTFD


2451 i‡(
evpùe
 [0] < 0)

2453 
uöt64_t
 
cou¡î
 = 1;

2454 
	`wrôe
 (
evpùe
 [1], &
cou¡î
,  (
uöt64_t
));

2459 #ifde‡
_WIN32


2460 
WSABUF
 
buf
;

2461 
DWORD
 
£¡
;

2462 
buf
.buf = &buf;

2463 
buf
.
Àn
 = 1;

2464 
	`WSASíd
 (
	`EV_FD_TO_WIN32_HANDLE
 (
evpùe
 [1]), &
buf
, 1, &
£¡
, 0, 0, 0);

2466 
	`wrôe
 (
evpùe
 [1], &(evpipe [1]), 1);

2470 
î∫o
 = 
ﬁd_î∫o
;

2472 
	}
}

2477 
	$pùecb
 (
EV_P_
 
ev_io
 *
iow
, 
ªvíts
)

2479 
i
;

2481 i‡(
ªvíts
 & 
EV_READ
)

2483 #i‡
EV_USE_EVENTFD


2484 i‡(
evpùe
 [0] < 0)

2486 
uöt64_t
 
cou¡î
;

2487 
	`ªad
 (
evpùe
 [1], &
cou¡î
,  (
uöt64_t
));

2492 
dummy
[4];

2493 #ifde‡
_WIN32


2494 
WSABUF
 
buf
;

2495 
DWORD
 
ªcvd
;

2496 
DWORD
 
Êags
 = 0;

2497 
buf
.bu‡
dummy
;

2498 
buf
.
Àn
 =  (
dummy
);

2499 
	`WSARecv
 (
	`EV_FD_TO_WIN32_HANDLE
 (
evpùe
 [0]), &
buf
, 1, &
ªcvd
, &
Êags
, 0, 0);

2501 
	`ªad
 (
evpùe
 [0], &
dummy
,  (dummy));

2506 
pùe_wrôe_skù≥d
 = 0;

2508 
ECB_MEMORY_FENCE
;

2510 #i‡
EV_SIGNAL_ENABLE


2511 i‡(
sig_≥ndög
)

2513 
sig_≥ndög
 = 0;

2515 
ECB_MEMORY_FENCE
;

2517 
i
 = 
EV_NSIG
 - 1; i--; )

2518 i‡(
	`ex≥˘_Ál£
 (
sig«ls
 [
i
].
≥ndög
))

2519 
	`ev_„ed_sig«l_evít
 (
EV_A_
 
i
 + 1);

2523 #i‡
EV_ASYNC_ENABLE


2524 i‡(
async_≥ndög
)

2526 
async_≥ndög
 = 0;

2528 
ECB_MEMORY_FENCE
;

2530 
i
 = 
async˙t
; i--; )

2531 i‡(
asyncs
 [
i
]->
£¡
)

2533 
asyncs
 [
i
]->
£¡
 = 0;

2534 
ECB_MEMORY_FENCE_RELEASE
;

2535 
	`ev_„ed_evít
 (
EV_A_
 
asyncs
 [
i
], 
EV_ASYNC
);

2539 
	}
}

2544 
	$ev_„ed_sig«l
 (
signum
Ë
EV_THROW


2546 #i‡
EV_MULTIPLICITY


2547 
EV_P
;

2548 
ECB_MEMORY_FENCE_ACQUIRE
;

2549 
EV_A
 = 
sig«ls
 [
signum
 - 1].
lo›
;

2551 i‡(!
EV_A
)

2555 
sig«ls
 [
signum
 - 1].
≥ndög
 = 1;

2556 
	`evpùe_wrôe
 (
EV_A_
 &
sig_≥ndög
);

2557 
	}
}

2560 
	$ev_sigh™dÀr
 (
signum
)

2562 #ifde‡
_WIN32


2563 
	`sig«l
 (
signum
, 
ev_sigh™dÀr
);

2566 
	`ev_„ed_sig«l
 (
signum
);

2567 
	}
}

2569 
noölöe


2570 
	$ev_„ed_sig«l_evít
 (
EV_P_
 
signum
Ë
EV_THROW


2572 
WL
 
w
;

2574 i‡(
	`ex≥˘_Ál£
 (
signum
 <0 || signum >
EV_NSIG
))

2577 --
signum
;

2579 #i‡
EV_MULTIPLICITY


2583 i‡(
	`ex≥˘_Ál£
 (
sig«ls
 [
signum
].
lo›
 !
EV_A
))

2587 
sig«ls
 [
signum
].
≥ndög
 = 0;

2588 
ECB_MEMORY_FENCE_RELEASE
;

2590 
w
 = 
sig«ls
 [
signum
].
hód
; w; w = w->
√xt
)

2591 
	`ev_„ed_evít
 (
	`EV_A_
 (
W
)
w
, 
EV_SIGNAL
);

2592 
	}
}

2594 #i‡
EV_USE_SIGNALFD


2596 
	$sigfdcb
 (
EV_P_
 
ev_io
 *
iow
, 
ªvíts
)

2598 
sig«lfd_sigöfo
 
si
[2], *
sù
;

2602 
ssize_t
 
ªs
 = 
	`ªad
 (
sigfd
, 
si
,  (si));

2605 
sù
 = 
si
; (*)sù < (*)sò+ 
ªs
; ++sip)

2606 
	`ev_„ed_sig«l_evít
 (
EV_A_
 
sù
->
ssi_signo
);

2608 i‡(
ªs
 < (
ssize_t
) (
si
))

2611 
	}
}

2618 #i‡
EV_CHILD_ENABLE


2619 
WL
 
	gchûds
 [
EV_PID_HASHSIZE
];

2621 
ev_sig«l
 
	gchûdev
;

2623 #i‚de‡
WIFCONTINUED


2624 
	#WIFCONTINUED
(
°©us
Ë0

	)

2628 
ölöe_•ìd
 

2629 
	$chûd_ª≠
 (
EV_P_
 
chaö
, 
pid
, 
°©us
)

2631 
ev_chûd
 *
w
;

2632 
åa˚d
 = 
	`WIFSTOPPED
 (
°©us
Ë|| 
	`WIFCONTINUED
 (status);

2634 
w
 = (
ev_chûd
 *)
chûds
 [
chaö
 & ((
EV_PID_HASHSIZE
Ë- 1)]; w; w = (ev_chûd *)((
WL
)w)->
√xt
)

2636 i‡((
w
->
pid
 ==Öid || !w->pid)

2637 && (!
åa˚d
 || (
w
->
Êags
 & 1)))

2639 
	`ev_£t_¥i‹ôy
 (
w
, 
EV_MAXPRI
);

2640 
w
->
Ωid
 = 
pid
;

2641 
w
->
r°©us
 = 
°©us
;

2642 
	`ev_„ed_evít
 (
	`EV_A_
 (
W
)
w
, 
EV_CHILD
);

2645 
	}
}

2647 #i‚de‡
WCONTINUED


2648 
	#WCONTINUED
 0

	)

2653 
	$chûdcb
 (
EV_P_
 
ev_sig«l
 *
sw
, 
ªvíts
)

2655 
pid
, 
°©us
;

2658 i‡(0 >(
pid
 = 
	`waôpid
 (-1, &
°©us
, 
WNOHANG
 | 
WUNTRACED
 | 
WCONTINUED
)))

2659 i‡(!
WCONTINUED


2660 || 
î∫o
 !
EINVAL


2661 || 0 >(
pid
 = 
	`waôpid
 (-1, &
°©us
, 
WNOHANG
 | 
WUNTRACED
)))

2666 
	`ev_„ed_evít
 (
	`EV_A_
 (
W
)
sw
, 
EV_SIGNAL
);

2668 
	`chûd_ª≠
 (
EV_A_
 
pid
,Öid, 
°©us
);

2669 i‡((
EV_PID_HASHSIZE
) > 1)

2670 
	`chûd_ª≠
 (
EV_A_
 0, 
pid
, 
°©us
);

2671 
	}
}

2677 #i‡
EV_USE_IOCP


2678 
	~"ev_io˝.c
"

2680 #i‡
EV_USE_PORT


2681 
	~"ev_p‹t.c
"

2683 #i‡
EV_USE_KQUEUE


2684 
	~"ev_kqueue.c
"

2686 #i‡
EV_USE_EPOLL


2687 
	~"ev_ïﬁl.c
"

2689 #i‡
EV_USE_POLL


2690 
	~"ev_pﬁl.c
"

2692 #i‡
EV_USE_SELECT


2693 
	~"ev_£À˘.c
"

2696 
ecb_cﬁd


2697 
	$ev_vîsi⁄_maj‹
 (Ë
EV_THROW


2699  
EV_VERSION_MAJOR
;

2700 
	}
}

2702 
ecb_cﬁd


2703 
	$ev_vîsi⁄_mö‹
 (Ë
EV_THROW


2705  
EV_VERSION_MINOR
;

2706 
	}
}

2709 
ölöe_size
 
ecb_cﬁd


2710 
	$íabÀ_£cuª
 ()

2712 #ifde‡
_WIN32


2715  
	`gëuid
 (Ë!
	`gëeuid
 ()

2716 || 
	`gëgid
 (Ë!
	`gëegid
 ();

2718 
	}
}

2720 
ecb_cﬁd


2721 
	$ev_suµ‹ãd_backíds
 (Ë
EV_THROW


2723 
Êags
 = 0;

2725 i‡(
EV_USE_PORT
 ) 
Êags
 |
EVBACKEND_PORT
;

2726 i‡(
EV_USE_KQUEUE
Ë
Êags
 |
EVBACKEND_KQUEUE
;

2727 i‡(
EV_USE_EPOLL
 ) 
Êags
 |
EVBACKEND_EPOLL
;

2728 i‡(
EV_USE_POLL
 ) 
Êags
 |
EVBACKEND_POLL
;

2729 i‡(
EV_USE_SELECT
Ë
Êags
 |
EVBACKEND_SELECT
;

2731  
Êags
;

2732 
	}
}

2734 
ecb_cﬁd


2735 
	$ev_ªcommíded_backíds
 (Ë
EV_THROW


2737 
Êags
 = 
	`ev_suµ‹ãd_backíds
 ();

2739 #i‚de‡
__NëBSD__


2742 
Êags
 &~
EVBACKEND_KQUEUE
;

2744 #ifde‡
__APPLE__


2746 
Êags
 &~
EVBACKEND_KQUEUE
;

2747 
Êags
 &~
EVBACKEND_POLL
;

2749 #ifde‡
__FªeBSD__


2750 
Êags
 &~
EVBACKEND_POLL
;

2753  
Êags
;

2754 
	}
}

2756 
ecb_cﬁd


2757 
	$ev_embeddabÀ_backíds
 (Ë
EV_THROW


2759 
Êags
 = 
EVBACKEND_EPOLL
 | 
EVBACKEND_KQUEUE
 | 
EVBACKEND_PORT
;

2762 i‡(
	`ev_löux_vîsi⁄
 () < 0x020620)

2763 
Êags
 &~
EVBACKEND_EPOLL
;

2765  
Êags
;

2766 
	}
}

2769 
	$ev_backíd
 (
EV_P
Ë
EV_THROW


2771  
backíd
;

2772 
	}
}

2774 #i‡
EV_FEATURE_API


2776 
	$ev_ôî©i⁄
 (
EV_P
Ë
EV_THROW


2778  
lo›_cou¡
;

2779 
	}
}

2782 
	$ev_dïth
 (
EV_P
Ë
EV_THROW


2784  
lo›_dïth
;

2785 
	}
}

2788 
	$ev_£t_io_cﬁÀ˘_öãrvÆ
 (
EV_P_
 
ev_t°amp
 
öãrvÆ
Ë
EV_THROW


2790 
io_blocktime
 = 
öãrvÆ
;

2791 
	}
}

2794 
	$ev_£t_timeout_cﬁÀ˘_öãrvÆ
 (
EV_P_
 
ev_t°amp
 
öãrvÆ
Ë
EV_THROW


2796 
timeout_blocktime
 = 
öãrvÆ
;

2797 
	}
}

2800 
	$ev_£t_u£rd©a
 (
EV_P_
 *
d©a
Ë
EV_THROW


2802 
u£rd©a
 = 
d©a
;

2803 
	}
}

2806 
	$ev_u£rd©a
 (
EV_P
Ë
EV_THROW


2808  
u£rd©a
;

2809 
	}
}

2812 
	$ev_£t_övoke_≥ndög_cb
 (
EV_P_
 
ev_lo›_ˇŒback
 
övoke_≥ndög_cb
Ë
EV_THROW


2814 
övoke_cb
 = 
övoke_≥ndög_cb
;

2815 
	}
}

2818 
	$ev_£t_lo›_ªÀa£_cb
 (
EV_P_
 (*
ªÀa£
)(
EV_P
Ë
EV_THROW
, (*
acquúe
)(EV_P) EV_THROW) EV_THROW

2820 
ªÀa£_cb
 = 
ªÀa£
;

2821 
acquúe_cb
 = 
acquúe
;

2822 
	}
}

2826 
noölöe
 
ecb_cﬁd


2827 
	$lo›_öô
 (
EV_P_
 
Êags
Ë
EV_THROW


2829 i‡(!
backíd
)

2831 
‹igÊags
 = 
Êags
;

2833 #i‡
EV_USE_REALTIME


2834 i‡(!
have_ªÆtime
)

2836 
time•ec
 
ts
;

2838 i‡(!
	`˛ock_gëtime
 (
CLOCK_REALTIME
, &
ts
))

2839 
have_ªÆtime
 = 1;

2843 #i‡
EV_USE_MONOTONIC


2844 i‡(!
have_m⁄Ÿ⁄ic
)

2846 
time•ec
 
ts
;

2848 i‡(!
	`˛ock_gëtime
 (
CLOCK_MONOTONIC
, &
ts
))

2849 
have_m⁄Ÿ⁄ic
 = 1;

2854 #i‚de‡
_WIN32


2855 i‡(
Êags
 & 
EVFLAG_FORKCHECK
)

2856 
cuΩid
 = 
	`gëpid
 ();

2859 i‡(!(
Êags
 & 
EVFLAG_NOENV
)

2860 && !
	`íabÀ_£cuª
 ()

2861 && 
	`gëív
 ("LIBEV_FLAGS"))

2862 
Êags
 = 
	`©oi
 (
	`gëív
 ("LIBEV_FLAGS"));

2864 
ev_π_now
 = 
	`ev_time
 ();

2865 
mn_now
 = 
	`gë_˛ock
 ();

2866 
now_Êo‹
 = 
mn_now
;

2867 
πmn_diff
 = 
ev_π_now
 - 
mn_now
;

2868 #i‡
EV_FEATURE_API


2869 
övoke_cb
 = 
ev_övoke_≥ndög
;

2872 
io_blocktime
 = 0.;

2873 
timeout_blocktime
 = 0.;

2874 
backíd
 = 0;

2875 
backíd_fd
 = -1;

2876 
sig_≥ndög
 = 0;

2877 #i‡
EV_ASYNC_ENABLE


2878 
async_≥ndög
 = 0;

2880 
pùe_wrôe_skù≥d
 = 0;

2881 
pùe_wrôe_w™ãd
 = 0;

2882 
evpùe
 [0] = -1;

2883 
evpùe
 [1] = -1;

2884 #i‡
EV_USE_INOTIFY


2885 
fs_fd
 = 
Êags
 & 
EVFLAG_NOINOTIFY
 ? -1 : -2;

2887 #i‡
EV_USE_SIGNALFD


2888 
sigfd
 = 
Êags
 & 
EVFLAG_SIGNALFD
 ? -2 : -1;

2891 i‡(!(
Êags
 & 
EVBACKEND_MASK
))

2892 
Êags
 |
	`ev_ªcommíded_backíds
 ();

2894 #i‡
EV_USE_IOCP


2895 i‡(!
backíd
 && (
Êags
 & 
EVBACKEND_IOCP
 )Ëbackíd = 
	`io˝_öô
 (
EV_A_
 flags);

2897 #i‡
EV_USE_PORT


2898 i‡(!
backíd
 && (
Êags
 & 
EVBACKEND_PORT
 )Ëbackíd = 
	`p‹t_öô
 (
EV_A_
 flags);

2900 #i‡
EV_USE_KQUEUE


2901 i‡(!
backíd
 && (
Êags
 & 
EVBACKEND_KQUEUE
)Ëbackíd = 
	`kqueue_öô
 (
EV_A_
 flags);

2903 #i‡
EV_USE_EPOLL


2904 i‡(!
backíd
 && (
Êags
 & 
EVBACKEND_EPOLL
 )Ëbackíd = 
	`ïﬁl_öô
 (
EV_A_
 flags);

2906 #i‡
EV_USE_POLL


2907 i‡(!
backíd
 && (
Êags
 & 
EVBACKEND_POLL
 )Ëbackíd = 
	`pﬁl_öô
 (
EV_A_
 flags);

2909 #i‡
EV_USE_SELECT


2910 i‡(!
backíd
 && (
Êags
 & 
EVBACKEND_SELECT
)Ëbackíd = 
	`£À˘_öô
 (
EV_A_
 flags);

2913 
	`ev_¥ï¨e_öô
 (&
≥ndög_w
, 
≥ndögcb
);

2915 #i‡
EV_SIGNAL_ENABLE
 || 
EV_ASYNC_ENABLE


2916 
	`ev_öô
 (&
pùe_w
, 
pùecb
);

2917 
	`ev_£t_¥i‹ôy
 (&
pùe_w
, 
EV_MAXPRI
);

2920 
	}
}

2923 
ecb_cﬁd


2924 
	$ev_lo›_de°roy
 (
EV_P
)

2926 
i
;

2928 #i‡
EV_MULTIPLICITY


2930 i‡(!
EV_A
)

2934 #i‡
EV_CLEANUP_ENABLE


2936 i‡(
	`ex≥˘_Ál£
 (
˛ónup˙t
))

2938 
	`queue_evíts
 (
	`EV_A_
 (
W
 *)
˛ónups
, 
˛ónup˙t
, 
EV_CLEANUP
);

2939 
EV_INVOKE_PENDING
;

2943 #i‡
EV_CHILD_ENABLE


2944 i‡(
	`ev_is_deÁu…_lo›
 (
EV_A
Ë&& 
	`ev_is_a˘ive
 (&
chûdev
))

2946 
	`ev_ªf
 (
EV_A
);

2947 
	`ev_sig«l_°›
 (
EV_A_
 &
chûdev
);

2951 i‡(
	`ev_is_a˘ive
 (&
pùe_w
))

2956 i‡(
evpùe
 [0] >0Ë
	`EV_WIN32_CLOSE_FD
 (evpipe [0]);

2957 i‡(
evpùe
 [1] >0Ë
	`EV_WIN32_CLOSE_FD
 (evpipe [1]);

2960 #i‡
EV_USE_SIGNALFD


2961 i‡(
	`ev_is_a˘ive
 (&
sigfd_w
))

2962 
	`˛o£
 (
sigfd
);

2965 #i‡
EV_USE_INOTIFY


2966 i‡(
fs_fd
 >= 0)

2967 
	`˛o£
 (
fs_fd
);

2970 i‡(
backíd_fd
 >= 0)

2971 
	`˛o£
 (
backíd_fd
);

2973 #i‡
EV_USE_IOCP


2974 i‡(
backíd
 =
EVBACKEND_IOCP
 ) 
	`io˝_de°roy
 (
EV_A
);

2976 #i‡
EV_USE_PORT


2977 i‡(
backíd
 =
EVBACKEND_PORT
 ) 
	`p‹t_de°roy
 (
EV_A
);

2979 #i‡
EV_USE_KQUEUE


2980 i‡(
backíd
 =
EVBACKEND_KQUEUE
Ë
	`kqueue_de°roy
 (
EV_A
);

2982 #i‡
EV_USE_EPOLL


2983 i‡(
backíd
 =
EVBACKEND_EPOLL
 ) 
	`ïﬁl_de°roy
 (
EV_A
);

2985 #i‡
EV_USE_POLL


2986 i‡(
backíd
 =
EVBACKEND_POLL
 ) 
	`pﬁl_de°roy
 (
EV_A
);

2988 #i‡
EV_USE_SELECT


2989 i‡(
backíd
 =
EVBACKEND_SELECT
Ë
	`£À˘_de°roy
 (
EV_A
);

2992 
i
 = 
NUMPRI
; i--; )

2994 
	`¨øy_‰ì
 (
≥ndög
, [
i
]);

2995 #i‡
EV_IDLE_ENABLE


2996 
	`¨øy_‰ì
 (
idÀ
, [
i
]);

3000 
	`ev_‰ì
 (
™fds
);ánfd†0; 
™fdmax
 = 0;

3003 
	`¨øy_‰ì
 (
r„ed
, 
EMPTY
);

3004 
	`¨øy_‰ì
 (
fdch™ge
, 
EMPTY
);

3005 
	`¨øy_‰ì
 (
timî
, 
EMPTY
);

3006 #i‡
EV_PERIODIC_ENABLE


3007 
	`¨øy_‰ì
 (
≥riodic
, 
EMPTY
);

3009 #i‡
EV_FORK_ENABLE


3010 
	`¨øy_‰ì
 (
f‹k
, 
EMPTY
);

3012 #i‡
EV_CLEANUP_ENABLE


3013 
	`¨øy_‰ì
 (
˛ónup
, 
EMPTY
);

3015 
	`¨øy_‰ì
 (
¥ï¨e
, 
EMPTY
);

3016 
	`¨øy_‰ì
 (
check
, 
EMPTY
);

3017 #i‡
EV_ASYNC_ENABLE


3018 
	`¨øy_‰ì
 (
async
, 
EMPTY
);

3021 
backíd
 = 0;

3023 #i‡
EV_MULTIPLICITY


3024 i‡(
	`ev_is_deÁu…_lo›
 (
EV_A
))

3026 
ev_deÁu…_lo›_±r
 = 0;

3027 #i‡
EV_MULTIPLICITY


3029 
	`ev_‰ì
 (
EV_A
);

3031 
	}
}

3033 #i‡
EV_USE_INOTIFY


3034 
ölöe_size
 
öfy_f‹k
 (
EV_P
);

3037 
ölöe_size
 

3038 
	$lo›_f‹k
 (
EV_P
)

3040 #i‡
EV_USE_PORT


3041 i‡(
backíd
 =
EVBACKEND_PORT
 ) 
	`p‹t_f‹k
 (
EV_A
);

3043 #i‡
EV_USE_KQUEUE


3044 i‡(
backíd
 =
EVBACKEND_KQUEUE
Ë
	`kqueue_f‹k
 (
EV_A
);

3046 #i‡
EV_USE_EPOLL


3047 i‡(
backíd
 =
EVBACKEND_EPOLL
 ) 
	`ïﬁl_f‹k
 (
EV_A
);

3049 #i‡
EV_USE_INOTIFY


3050 
	`öfy_f‹k
 (
EV_A
);

3053 #i‡
EV_SIGNAL_ENABLE
 || 
EV_ASYNC_ENABLE


3054 i‡(
	`ev_is_a˘ive
 (&
pùe_w
Ë&& 
po°f‹k
 != 2)

3058 
	`ev_ªf
 (
EV_A
);

3059 
	`ev_io_°›
 (
EV_A_
 &
pùe_w
);

3061 i‡(
evpùe
 [0] >= 0)

3062 
	`EV_WIN32_CLOSE_FD
 (
evpùe
 [0]);

3064 
	`evpùe_öô
 (
EV_A
);

3066 
	`ev_„ed_evít
 (
EV_A_
 &
pùe_w
, 
EV_CUSTOM
);

3070 
po°f‹k
 = 0;

3071 
	}
}

3073 #i‡
EV_MULTIPLICITY


3075 
ev_lo›
 * 
ecb_cﬁd


3076 
	$ev_lo›_√w
 (
Êags
Ë
EV_THROW


3078 
EV_P
 = (
ev_lo›
 *)
	`ev_mÆloc
 ( (ev_loop));

3080 
	`mem£t
 (
EV_A
, 0,  (
ev_lo›
));

3081 
	`lo›_öô
 (
EV_A_
 
Êags
);

3083 i‡(
	`ev_backíd
 (
EV_A
))

3084  
EV_A
;

3086 
	`ev_‰ì
 (
EV_A
);

3088 
	}
}

3092 #i‡
EV_VERIFY


3093 
noölöe
 
ecb_cﬁd


3094 
	$vîify_w©chî
 (
EV_P_
 
W
 
w
)

3096 
	`as£π
 (("libev: w©chî ha†övÆidÖri‹ôy", 
	`ABSPRI
 (
w
Ë>0 && ABSPRI (wË< 
NUMPRI
));

3098 i‡(
w
->
≥ndög
)

3099 
	`as£π
 (("libev:Öídög w©chîÇŸ o¿≥ndög queue", 
≥ndögs
 [
	`ABSPRI
 (
w
)][w->
≥ndög
 - 1].w == w));

3100 
	}
}

3102 
noölöe
 
ecb_cﬁd


3103 
	$vîify_hóp
 (
EV_P_
 
ANHE
 *
hóp
, 
N
)

3105 
i
;

3107 
i
 = 
HEAP0
; i < 
N
 + HEAP0; ++i)

3109 
	`as£π
 (("libev:á˘ivêödex mism©ch i¿hóp", 
	`ev_a˘ive
 (
	`ANHE_w
 (
hóp
 [
i
])) == i));

3110 
	`as£π
 (("libev: hó∞c⁄dôi⁄ viﬁ©ed", 
i
 =
HEAP0
 || 
	`ANHE_©
 (
hóp
 [
	`HPARENT
 (i)]) <= ANHE_at (heap [i])));

3111 
	`as£π
 (("libev: hó∞© cachêmism©ch", 
	`ANHE_©
 (
hóp
 [
i
]Ë=
	`ev_©
 (
	`ANHE_w
 (heap [i]))));

3113 
	`vîify_w©chî
 (
	`EV_A_
 (
W
)
	`ANHE_w
 (
hóp
 [
i
]));

3115 
	}
}

3117 
noölöe
 
ecb_cﬁd


3118 
	$¨øy_vîify
 (
EV_P_
 
W
 *
ws
, 
˙t
)

3120 
˙t
--)

3122 
	`as£π
 (("libev:á˘ivêödex mism©ch", 
	`ev_a˘ive
 (
ws
 [
˙t
]) == cnt + 1));

3123 
	`vîify_w©chî
 (
EV_A_
 
ws
 [
˙t
]);

3125 
	}
}

3128 #i‡
EV_FEATURE_API


3129 
ecb_cﬁd


3130 
	$ev_vîify
 (
EV_P
Ë
EV_THROW


3132 #i‡
EV_VERIFY


3133 
i
;

3134 
WL
 
w
, 
w2
;

3136 
	`as£π
 (
a˘ive˙t
 >= -1);

3138 
	`as£π
 (
fdch™gemax
 >
fdch™ge˙t
);

3139 
i
 = 0; i < 
fdch™ge˙t
; ++i)

3140 
	`as£π
 (("libev:Çeg©ivêfd i¿fdch™ges", 
fdch™ges
 [
i
] >= 0));

3142 
	`as£π
 (
™fdmax
 >= 0);

3143 
i
 = 0; i < 
™fdmax
; ++i)

3145 
j
 = 0;

3147 
w
 = 
w2
 = 
™fds
 [
i
].
hód
; w; w = w->
√xt
)

3149 
	`vîify_w©chî
 (
	`EV_A_
 (
W
)
w
);

3151 i‡(
j
++ & 1)

3153 
	`as£π
 (("libev: iÿw©chîÜi° c⁄èö†®lo›", 
w
 !
w2
));

3154 
w2
 = w2->
√xt
;

3157 
	`as£π
 (("libev: i«˘ivêfd w©chî o¿™fdÜi°", 
	`ev_a˘ive
 (
w
) == 1));

3158 
	`as£π
 (("libev: fd mism©ch bëwì¿w©chîándánfd", ((
ev_io
 *)
w
)->
fd
 =
i
));

3162 
	`as£π
 (
timîmax
 >
timî˙t
);

3163 
	`vîify_hóp
 (
EV_A_
 
timîs
, 
timî˙t
);

3165 #i‡
EV_PERIODIC_ENABLE


3166 
	`as£π
 (
≥riodicmax
 >
≥riodic˙t
);

3167 
	`vîify_hóp
 (
EV_A_
 
≥riodics
, 
≥riodic˙t
);

3170 
i
 = 
NUMPRI
; i--; )

3172 
	`as£π
 (
≥ndögmax
 [
i
] >
≥ndög˙t
 [i]);

3173 #i‡
EV_IDLE_ENABLE


3174 
	`as£π
 (
idÀÆl
 >= 0);

3175 
	`as£π
 (
idÀmax
 [
i
] >
idÀ˙t
 [i]);

3176 
	`¨øy_vîify
 (
	`EV_A_
 (
W
 *)
idÀs
 [
i
], 
idÀ˙t
 [i]);

3180 #i‡
EV_FORK_ENABLE


3181 
	`as£π
 (
f‹kmax
 >
f‹k˙t
);

3182 
	`¨øy_vîify
 (
	`EV_A_
 (
W
 *)
f‹ks
, 
f‹k˙t
);

3185 #i‡
EV_CLEANUP_ENABLE


3186 
	`as£π
 (
˛ónupmax
 >
˛ónup˙t
);

3187 
	`¨øy_vîify
 (
	`EV_A_
 (
W
 *)
˛ónups
, 
˛ónup˙t
);

3190 #i‡
EV_ASYNC_ENABLE


3191 
	`as£π
 (
asyncmax
 >
async˙t
);

3192 
	`¨øy_vîify
 (
	`EV_A_
 (
W
 *)
asyncs
, 
async˙t
);

3195 #i‡
EV_PREPARE_ENABLE


3196 
	`as£π
 (
¥ï¨emax
 >
¥ï¨e˙t
);

3197 
	`¨øy_vîify
 (
	`EV_A_
 (
W
 *)
¥ï¨es
, 
¥ï¨e˙t
);

3200 #i‡
EV_CHECK_ENABLE


3201 
	`as£π
 (
checkmax
 >
check˙t
);

3202 
	`¨øy_vîify
 (
	`EV_A_
 (
W
 *)
checks
, 
check˙t
);

3206 #i‡
EV_CHILD_ENABLE


3207 
w
 = (
ev_chûd
 *)
chûds
 [
chaö
 & ((
EV_PID_HASHSIZE
Ë- 1)]; w; w = (ev_chûd *)((
WL
)w)->
√xt
)

3208 
signum
 = 
EV_NSIG
; signum--; ) i‡(
sig«ls
 [signum].
≥ndög
)

3212 
	}
}

3215 #i‡
EV_MULTIPLICITY


3216 
ev_lo›
 * 
	gecb_cﬁd


3220 
	$ev_deÁu…_lo›
 (
Êags
Ë
EV_THROW


3222 i‡(!
ev_deÁu…_lo›_±r
)

3224 #i‡
EV_MULTIPLICITY


3225 
EV_P
 = 
ev_deÁu…_lo›_±r
 = &
deÁu…_lo›_°ru˘
;

3227 
ev_deÁu…_lo›_±r
 = 1;

3230 
	`lo›_öô
 (
EV_A_
 
Êags
);

3232 i‡(
	`ev_backíd
 (
EV_A
))

3234 #i‡
EV_CHILD_ENABLE


3235 
	`ev_sig«l_öô
 (&
chûdev
, 
chûdcb
, 
SIGCHLD
);

3236 
	`ev_£t_¥i‹ôy
 (&
chûdev
, 
EV_MAXPRI
);

3237 
	`ev_sig«l_°¨t
 (
EV_A_
 &
chûdev
);

3238 
	`ev_uƒef
 (
EV_A
);

3242 
ev_deÁu…_lo›_±r
 = 0;

3245  
ev_deÁu…_lo›_±r
;

3246 
	}
}

3249 
	$ev_lo›_f‹k
 (
EV_P
Ë
EV_THROW


3251 
po°f‹k
 = 1;

3252 
	}
}

3257 
	$ev_övoke
 (
EV_P_
 *
w
, 
ªvíts
)

3259 
	`EV_CB_INVOKE
 ((
W
)
w
, 
ªvíts
);

3260 
	}
}

3263 
	$ev_≥ndög_cou¡
 (
EV_P
Ë
EV_THROW


3265 
¥i
;

3266 
cou¡
 = 0;

3268 
¥i
 = 
NUMPRI
;Öri--; )

3269 
cou¡
 +
≥ndög˙t
 [
¥i
];

3271  
cou¡
;

3272 
	}
}

3274 
noölöe


3275 
	$ev_övoke_≥ndög
 (
EV_P
)

3277 
≥ndög¥i
 = 
NUMPRI
;

3279 
≥ndög¥i
)

3281 --
≥ndög¥i
;

3283 
≥ndög˙t
 [
≥ndög¥i
])

3285 
ANPENDING
 *
p
 = 
≥ndögs
 [
≥ndög¥i
] + --
≥ndög˙t
 [pendingpri];

3287 
p
->
w
->
≥ndög
 = 0;

3288 
	`EV_CB_INVOKE
 (
p
->
w
,Ö->
evíts
);

3289 
EV_FREQUENT_CHECK
;

3292 
	}
}

3294 #i‡
EV_IDLE_ENABLE


3297 
ölöe_size
 

3298 
	$idÀ_ªify
 (
EV_P
)

3300 i‡(
	`ex≥˘_Ál£
 (
idÀÆl
))

3302 
¥i
;

3304 
¥i
 = 
NUMPRI
;Öri--; )

3306 i‡(
≥ndög˙t
 [
¥i
])

3309 i‡(
idÀ˙t
 [
¥i
])

3311 
	`queue_evíts
 (
	`EV_A_
 (
W
 *)
idÀs
 [
¥i
], 
idÀ˙t
 [¥i], 
EV_IDLE
);

3316 
	}
}

3320 
ölöe_size
 

3321 
	$timîs_ªify
 (
EV_P
)

3323 
EV_FREQUENT_CHECK
;

3325 i‡(
timî˙t
 && 
	`ANHE_©
 (
timîs
 [
HEAP0
]Ë< 
mn_now
)

3329 
ev_timî
 *
w
 = (ev_timî *)
	`ANHE_w
 (
timîs
 [
HEAP0
]);

3334 i‡(
w
->
ª≥©
)

3336 
	`ev_©
 (
w
Ë+w->
ª≥©
;

3337 i‡(
	`ev_©
 (
w
Ë< 
mn_now
)

3338 
	`ev_©
 (
w
Ë
mn_now
;

3340 
	`as£π
 (("libev:Çeg©ivêev_timîÑïóàvÆuêfound whûê¥o˚ssögÅimîs", 
w
->
ª≥©
 > 0.));

3342 
	`ANHE_©_ˇche
 (
timîs
 [
HEAP0
]);

3343 
	`downhóp
 (
timîs
, 
timî˙t
, 
HEAP0
);

3346 
	`ev_timî_°›
 (
EV_A_
 
w
);

3348 
EV_FREQUENT_CHECK
;

3349 
	`„ed_ªvî£
 (
	`EV_A_
 (
W
)
w
);

3351 
timî˙t
 && 
	`ANHE_©
 (
timîs
 [
HEAP0
]Ë< 
mn_now
);

3353 
	`„ed_ªvî£_d⁄e
 (
EV_A_
 
EV_TIMER
);

3355 
	}
}

3357 #i‡
EV_PERIODIC_ENABLE


3359 
noölöe


3360 
	$≥riodic_ªˇlc
 (
EV_P_
 
ev_≥riodic
 *
w
)

3362 
ev_t°amp
 
öãrvÆ
 = 
w
->öãrvÆ > 
MIN_INTERVAL
 ? w->interval : MIN_INTERVAL;

3363 
ev_t°amp
 
©
 = 
w
->
off£t
 + 
öãrvÆ
 * 
	`ev_Êo‹
 ((
ev_π_now
 - w->offset) / interval);

3366 
©
 <
ev_π_now
)

3368 
ev_t°amp
 
«t
 = 
©
 + 
w
->
öãrvÆ
;

3371 i‡(
	`ex≥˘_Ál£
 (
«t
 =
©
))

3373 
©
 = 
ev_π_now
;

3377 
©
 = 
«t
;

3380 
	`ev_©
 (
w
Ë
©
;

3381 
	}
}

3384 
ölöe_size
 

3385 
	$≥riodics_ªify
 (
EV_P
)

3387 
EV_FREQUENT_CHECK
;

3389 
≥riodic˙t
 && 
	`ANHE_©
 (
≥riodics
 [
HEAP0
]Ë< 
ev_π_now
)

3393 
ev_≥riodic
 *
w
 = (ev_≥riodi¯*)
	`ANHE_w
 (
≥riodics
 [
HEAP0
]);

3398 i‡(
w
->
ªscheduÀ_cb
)

3400 
	`ev_©
 (
w
Ëw->
	`ªscheduÀ_cb
 (w, 
ev_π_now
);

3402 
	`as£π
 (("libev:Év_≥riodi¯ªscheduÀ cÆlbackÑëu∫edÅimêöÅhê∑°", 
	`ev_©
 (
w
Ë>
ev_π_now
));

3404 
	`ANHE_©_ˇche
 (
≥riodics
 [
HEAP0
]);

3405 
	`downhóp
 (
≥riodics
, 
≥riodic˙t
, 
HEAP0
);

3407 i‡(
w
->
öãrvÆ
)

3409 
	`≥riodic_ªˇlc
 (
EV_A_
 
w
);

3410 
	`ANHE_©_ˇche
 (
≥riodics
 [
HEAP0
]);

3411 
	`downhóp
 (
≥riodics
, 
≥riodic˙t
, 
HEAP0
);

3414 
	`ev_≥riodic_°›
 (
EV_A_
 
w
);

3416 
EV_FREQUENT_CHECK
;

3417 
	`„ed_ªvî£
 (
	`EV_A_
 (
W
)
w
);

3419 
≥riodic˙t
 && 
	`ANHE_©
 (
≥riodics
 [
HEAP0
]Ë< 
ev_π_now
);

3421 
	`„ed_ªvî£_d⁄e
 (
EV_A_
 
EV_PERIODIC
);

3423 
	}
}

3427 
noölöe
 
ecb_cﬁd


3428 
	$≥riodics_ªscheduÀ
 (
EV_P
)

3430 
i
;

3433 
i
 = 
HEAP0
; i < 
≥riodic˙t
 + HEAP0; ++i)

3435 
ev_≥riodic
 *
w
 = (ev_≥riodi¯*)
	`ANHE_w
 (
≥riodics
 [
i
]);

3437 i‡(
w
->
ªscheduÀ_cb
)

3438 
	`ev_©
 (
w
Ëw->
	`ªscheduÀ_cb
 (w, 
ev_π_now
);

3439 i‡(
w
->
öãrvÆ
)

3440 
	`≥riodic_ªˇlc
 (
EV_A_
 
w
);

3442 
	`ANHE_©_ˇche
 (
≥riodics
 [
i
]);

3445 
	`ªhóp
 (
≥riodics
, 
≥riodic˙t
);

3446 
	}
}

3450 
noölöe
 
ecb_cﬁd


3451 
	$timîs_ªscheduÀ
 (
EV_P_
 
ev_t°amp
 
adju°
)

3453 
i
;

3455 
i
 = 0; i < 
timî˙t
; ++i)

3457 
ANHE
 *
he
 = 
timîs
 + 
i
 + 
HEAP0
;

3458 
	`ANHE_w
 (*
he
)->
©
 +
adju°
;

3459 
	`ANHE_©_ˇche
 (*
he
);

3461 
	}
}

3465 
ölöe_•ìd
 

3466 
	$time_upd©e
 (
EV_P_
 
ev_t°amp
 
max_block
)

3468 #i‡
EV_USE_MONOTONIC


3469 i‡(
	`ex≥˘_åue
 (
have_m⁄Ÿ⁄ic
))

3471 
i
;

3472 
ev_t°amp
 
odiff
 = 
πmn_diff
;

3474 
mn_now
 = 
	`gë_˛ock
 ();

3478 i‡(
	`ex≥˘_åue
 (
mn_now
 - 
now_Êo‹
 < 
MIN_TIMEJUMP
 * .5))

3480 
ev_π_now
 = 
πmn_diff
 + 
mn_now
;

3484 
now_Êo‹
 = 
mn_now
;

3485 
ev_π_now
 = 
	`ev_time
 ();

3495 
i
 = 4; --i; )

3497 
ev_t°amp
 
diff
;

3498 
πmn_diff
 = 
ev_π_now
 - 
mn_now
;

3500 
diff
 = 
odiff
 - 
πmn_diff
;

3502 i‡(
	`ex≥˘_åue
 ((
diff
 < 0. ? -dif‡: diffË< 
MIN_TIMEJUMP
))

3505 
ev_π_now
 = 
	`ev_time
 ();

3506 
mn_now
 = 
	`gë_˛ock
 ();

3507 
now_Êo‹
 = 
mn_now
;

3512 #i‡
EV_PERIODIC_ENABLE


3513 
	`≥riodics_ªscheduÀ
 (
EV_A
);

3519 
ev_π_now
 = 
	`ev_time
 ();

3521 i‡(
	`ex≥˘_Ál£
 (
mn_now
 > 
ev_π_now
 ||Év_π_now > mn_now + 
max_block
 + 
MIN_TIMEJUMP
))

3524 
	`timîs_ªscheduÀ
 (
EV_A_
 
ev_π_now
 - 
mn_now
);

3525 #i‡
EV_PERIODIC_ENABLE


3526 
	`≥riodics_ªscheduÀ
 (
EV_A
);

3530 
mn_now
 = 
ev_π_now
;

3532 
	}
}

3535 
	$ev_run
 (
EV_P_
 
Êags
)

3537 #i‡
EV_FEATURE_API


3538 ++
lo›_dïth
;

3541 
	`as£π
 (("libev:Év_lo›Ñecursi⁄ durögÑñó£ dëe˘ed", 
lo›_d⁄e
 !
EVBREAK_RECURSE
));

3543 
lo›_d⁄e
 = 
EVBREAK_CANCEL
;

3545 
EV_INVOKE_PENDING
;

3549 #i‡
EV_VERIFY
 >= 2

3550 
	`ev_vîify
 (
EV_A
);

3553 #i‚de‡
_WIN32


3554 i‡(
	`ex≥˘_Ál£
 (
cuΩid
))

3555 i‡(
	`ex≥˘_Ál£
 (
	`gëpid
 (Ë!
cuΩid
))

3557 
cuΩid
 = 
	`gëpid
 ();

3558 
po°f‹k
 = 1;

3562 #i‡
EV_FORK_ENABLE


3564 i‡(
	`ex≥˘_Ál£
 (
po°f‹k
))

3565 i‡(
f‹k˙t
)

3567 
	`queue_evíts
 (
	`EV_A_
 (
W
 *)
f‹ks
, 
f‹k˙t
, 
EV_FORK
);

3568 
EV_INVOKE_PENDING
;

3572 #i‡
EV_PREPARE_ENABLE


3574 i‡(
	`ex≥˘_Ál£
 (
¥ï¨e˙t
))

3576 
	`queue_evíts
 (
	`EV_A_
 (
W
 *)
¥ï¨es
, 
¥ï¨e˙t
, 
EV_PREPARE
);

3577 
EV_INVOKE_PENDING
;

3581 i‡(
	`ex≥˘_Ál£
 (
lo›_d⁄e
))

3585 i‡(
	`ex≥˘_Ál£
 (
po°f‹k
))

3586 
	`lo›_f‹k
 (
EV_A
);

3589 
	`fd_ªify
 (
EV_A
);

3593 
ev_t°amp
 
waôtime
 = 0.;

3594 
ev_t°amp
 
¶ì±ime
 = 0.;

3597 
ev_t°amp
 
¥ev_mn_now
 = 
mn_now
;

3600 
	`time_upd©e
 (
EV_A_
 1e100);

3603 
pùe_wrôe_w™ãd
 = 1;

3605 
ECB_MEMORY_FENCE
;

3607 i‡(
	`ex≥˘_åue
 (!(
Êags
 & 
EVRUN_NOWAIT
 || 
idÀÆl
 || !
a˘ive˙t
 || 
pùe_wrôe_skù≥d
)))

3609 
waôtime
 = 
MAX_BLOCKTIME
;

3611 i‡(
timî˙t
)

3613 
ev_t°amp
 
to
 = 
	`ANHE_©
 (
timîs
 [
HEAP0
]Ë- 
mn_now
;

3614 i‡(
waôtime
 > 
to
) waittime =Åo;

3617 #i‡
EV_PERIODIC_ENABLE


3618 i‡(
≥riodic˙t
)

3620 
ev_t°amp
 
to
 = 
	`ANHE_©
 (
≥riodics
 [
HEAP0
]Ë- 
ev_π_now
;

3621 i‡(
waôtime
 > 
to
) waittime =Åo;

3626 i‡(
	`ex≥˘_Ál£
 (
waôtime
 < 
timeout_blocktime
))

3627 
waôtime
 = 
timeout_blocktime
;

3631 i‡(
	`ex≥˘_Ál£
 (
waôtime
 < 
backíd_mötime
))

3632 
waôtime
 = 
backíd_mötime
;

3635 i‡(
	`ex≥˘_Ál£
 (
io_blocktime
))

3637 
¶ì±ime
 = 
io_blocktime
 - (
mn_now
 - 
¥ev_mn_now
);

3639 i‡(
¶ì±ime
 > 
waôtime
 - 
backíd_mötime
)

3640 
¶ì±ime
 = 
waôtime
 - 
backíd_mötime
;

3642 i‡(
	`ex≥˘_åue
 (
¶ì±ime
 > 0.))

3644 
	`ev_¶ìp
 (
¶ì±ime
);

3645 
waôtime
 -
¶ì±ime
;

3650 #i‡
EV_FEATURE_API


3651 ++
lo›_cou¡
;

3653 
	`as£π
 ((
lo›_d⁄e
 = 
EVBREAK_RECURSE
, 1));

3654 
	`backíd_pﬁl
 (
EV_A_
 
waôtime
);

3655 
	`as£π
 ((
lo›_d⁄e
 = 
EVBREAK_CANCEL
, 1));

3657 
pùe_wrôe_w™ãd
 = 0;

3659 
ECB_MEMORY_FENCE_ACQUIRE
;

3660 i‡(
pùe_wrôe_skù≥d
)

3662 
	`as£π
 (("libev:Öùe_wÇŸá˘ive, buàpùênŸ wrôãn", 
	`ev_is_a˘ive
 (&
pùe_w
)));

3663 
	`ev_„ed_evít
 (
EV_A_
 &
pùe_w
, 
EV_CUSTOM
);

3668 
	`time_upd©e
 (
EV_A_
 
waôtime
 + 
¶ì±ime
);

3672 
	`timîs_ªify
 (
EV_A
);

3673 #i‡
EV_PERIODIC_ENABLE


3674 
	`≥riodics_ªify
 (
EV_A
);

3677 #i‡
EV_IDLE_ENABLE


3679 
	`idÀ_ªify
 (
EV_A
);

3682 #i‡
EV_CHECK_ENABLE


3684 i‡(
	`ex≥˘_Ál£
 (
check˙t
))

3685 
	`queue_evíts
 (
	`EV_A_
 (
W
 *)
checks
, 
check˙t
, 
EV_CHECK
);

3688 
EV_INVOKE_PENDING
;

3690 
	`ex≥˘_åue
 (

3691 
a˘ive˙t


3692 && !
lo›_d⁄e


3693 && !(
Êags
 & (
EVRUN_ONCE
 | 
EVRUN_NOWAIT
))

3696 i‡(
lo›_d⁄e
 =
EVBREAK_ONE
)

3697 
lo›_d⁄e
 = 
EVBREAK_CANCEL
;

3699 #i‡
EV_FEATURE_API


3700 --
lo›_dïth
;

3703  
a˘ive˙t
;

3704 
	}
}

3707 
	$ev_bªak
 (
EV_P_
 
how
Ë
EV_THROW


3709 
lo›_d⁄e
 = 
how
;

3710 
	}
}

3713 
	$ev_ªf
 (
EV_P
Ë
EV_THROW


3715 ++
a˘ive˙t
;

3716 
	}
}

3719 
	$ev_uƒef
 (
EV_P
Ë
EV_THROW


3721 --
a˘ive˙t
;

3722 
	}
}

3725 
	$ev_now_upd©e
 (
EV_P
Ë
EV_THROW


3727 
	`time_upd©e
 (
EV_A_
 1e100);

3728 
	}
}

3731 
	$ev_su•íd
 (
EV_P
Ë
EV_THROW


3733 
	`ev_now_upd©e
 (
EV_A
);

3734 
	}
}

3737 
	$ev_ªsume
 (
EV_P
Ë
EV_THROW


3739 
ev_t°amp
 
mn_¥ev
 = 
mn_now
;

3741 
	`ev_now_upd©e
 (
EV_A
);

3742 
	`timîs_ªscheduÀ
 (
EV_A_
 
mn_now
 - 
mn_¥ev
);

3743 #i‡
EV_PERIODIC_ENABLE


3745 
	`≥riodics_ªscheduÀ
 (
EV_A
);

3747 
	}
}

3752 
ölöe_size
 

3753 
	$wli°_add
 (
WL
 *
hód
, WL 
ñem
)

3755 
ñem
->
√xt
 = *
hód
;

3756 *
hód
 = 
ñem
;

3757 
	}
}

3759 
ölöe_size
 

3760 
	$wli°_dñ
 (
WL
 *
hód
, WL 
ñem
)

3762 *
hód
)

3764 i‡(
	`ex≥˘_åue
 (*
hód
 =
ñem
))

3766 *
hód
 = 
ñem
->
√xt
;

3770 
hód
 = &(*hód)->
√xt
;

3772 
	}
}

3775 
ölöe_•ìd
 

3776 
	$˛ór_≥ndög
 (
EV_P_
 
W
 
w
)

3778 i‡(
w
->
≥ndög
)

3780 
≥ndögs
 [
	`ABSPRI
 (
w
)][w->
≥ndög
 - 1].w = (
W
)&
≥ndög_w
;

3781 
w
->
≥ndög
 = 0;

3783 
	}
}

3786 
	$ev_˛ór_≥ndög
 (
EV_P_
 *
w
Ë
EV_THROW


3788 
W
 
w_
 = (W)
w
;

3789 
≥ndög
 = 
w_
->pending;

3791 i‡(
	`ex≥˘_åue
 (
≥ndög
))

3793 
ANPENDING
 *
p
 = 
≥ndögs
 [
	`ABSPRI
 (
w_
)] + 
≥ndög
 - 1;

3794 
p
->
w
 = (
W
)&
≥ndög_w
;

3795 
w_
->
≥ndög
 = 0;

3796  
p
->
evíts
;

3800 
	}
}

3802 
ölöe_size
 

3803 
	$¥i_adju°
 (
EV_P_
 
W
 
w
)

3805 
¥i
 = 
	`ev_¥i‹ôy
 (
w
);

3806 
¥i
 =Örò< 
EV_MINPRI
 ? EV_MINPRI :Öri;

3807 
¥i
 =Örò> 
EV_MAXPRI
 ? EV_MAXPRI :Öri;

3808 
	`ev_£t_¥i‹ôy
 (
w
, 
¥i
);

3809 
	}
}

3811 
ölöe_•ìd
 

3812 
	$ev_°¨t
 (
EV_P_
 
W
 
w
, 
a˘ive
)

3814 
	`¥i_adju°
 (
EV_A_
 
w
);

3815 
w
->
a˘ive
 =áctive;

3816 
	`ev_ªf
 (
EV_A
);

3817 
	}
}

3819 
ölöe_size
 

3820 
	$ev_°›
 (
EV_P_
 
W
 
w
)

3822 
	`ev_uƒef
 (
EV_A
);

3823 
w
->
a˘ive
 = 0;

3824 
	}
}

3828 
noölöe


3829 
	$ev_io_°¨t
 (
EV_P_
 
ev_io
 *
w
Ë
EV_THROW


3831 
fd
 = 
w
->fd;

3833 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

3836 
	`as£π
 (("libev:Év_io_°¨àˇŒed wôhÇeg©ivêfd", 
fd
 >= 0));

3837 
	`as£π
 (("libev:Év_io_°¨àˇŒed wôh iŒegÆÉvíàmask", !(
w
->
evíts
 & ~(
EV__IOFDSET
 | 
EV_READ
 | 
EV_WRITE
))));

3839 
EV_FREQUENT_CHECK
;

3841 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 1);

3842 
	`¨øy_√edsize
 (
ANFD
, 
™fds
, 
™fdmax
, 
fd
 + 1, 
¨øy_öô_zîo
);

3843 
	`wli°_add
 (&
™fds
[
fd
].
hód
, (
WL
)
w
);

3846 
	`as£π
 (("libev:Év_io_°¨àˇŒed wôh c‹ru±ed w©chî", ((
WL
)
w
)->
√xt
 != (WL)w));

3848 
	`fd_ch™ge
 (
EV_A_
 
fd
, 
w
->
evíts
 & 
EV__IOFDSET
 | 
EV_ANFD_REIFY
);

3849 
w
->
evíts
 &~
EV__IOFDSET
;

3851 
EV_FREQUENT_CHECK
;

3852 
	}
}

3854 
noölöe


3855 
	$ev_io_°›
 (
EV_P_
 
ev_io
 *
w
Ë
EV_THROW


3857 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

3858 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

3861 
	`as£π
 (("libev:Év_io_°› cÆÀd wôh iŒegÆ fd (mu° sèy c⁄°™àa·î sèπ!)", 
w
->
fd
 >0 && w->fd < 
™fdmax
));

3863 
EV_FREQUENT_CHECK
;

3865 
	`wli°_dñ
 (&
™fds
[
w
->
fd
].
hód
, (
WL
)w);

3866 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

3868 
	`fd_ch™ge
 (
EV_A_
 
w
->
fd
, 
EV_ANFD_REIFY
);

3870 
EV_FREQUENT_CHECK
;

3871 
	}
}

3873 
noölöe


3874 
	$ev_timî_°¨t
 (
EV_P_
 
ev_timî
 *
w
Ë
EV_THROW


3876 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

3879 
	`ev_©
 (
w
Ë+
mn_now
;

3881 
	`as£π
 (("libev:Év_timî_°¨àˇŒed wôhÇeg©ivêtimîÑïóàvÆue", 
w
->
ª≥©
 >= 0.));

3883 
EV_FREQUENT_CHECK
;

3885 ++
timî˙t
;

3886 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 
timî˙t
 + 
HEAP0
 - 1);

3887 
	`¨øy_√edsize
 (
ANHE
, 
timîs
, 
timîmax
, 
	`ev_a˘ive
 (
w
Ë+ 1, 
EMPTY2
);

3888 
	`ANHE_w
 (
timîs
 [
	`ev_a˘ive
 (
w
)]Ë(
WT
)w;

3889 
	`ANHE_©_ˇche
 (
timîs
 [
	`ev_a˘ive
 (
w
)]);

3890 
	`uphóp
 (
timîs
, 
	`ev_a˘ive
 (
w
));

3892 
EV_FREQUENT_CHECK
;

3895 
	}
}

3897 
noölöe


3898 
	$ev_timî_°›
 (
EV_P_
 
ev_timî
 *
w
Ë
EV_THROW


3900 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

3901 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

3904 
EV_FREQUENT_CHECK
;

3907 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

3909 
	`as£π
 (("libev: i¡î«»timî hó∞c‹ru±i⁄", 
	`ANHE_w
 (
timîs
 [
a˘ive
]Ë=(
WT
)
w
));

3911 --
timî˙t
;

3913 i‡(
	`ex≥˘_åue
 (
a˘ive
 < 
timî˙t
 + 
HEAP0
))

3915 
timîs
 [
a˘ive
] =Åimî†[
timî˙t
 + 
HEAP0
];

3916 
	`adju°hóp
 (
timîs
, 
timî˙t
, 
a˘ive
);

3920 
	`ev_©
 (
w
Ë-
mn_now
;

3922 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

3924 
EV_FREQUENT_CHECK
;

3925 
	}
}

3927 
noölöe


3928 
	$ev_timî_agaö
 (
EV_P_
 
ev_timî
 *
w
Ë
EV_THROW


3930 
EV_FREQUENT_CHECK
;

3932 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

3934 i‡(
	`ev_is_a˘ive
 (
w
))

3936 i‡(
w
->
ª≥©
)

3938 
	`ev_©
 (
w
Ë
mn_now
 + w->
ª≥©
;

3939 
	`ANHE_©_ˇche
 (
timîs
 [
	`ev_a˘ive
 (
w
)]);

3940 
	`adju°hóp
 (
timîs
, 
timî˙t
, 
	`ev_a˘ive
 (
w
));

3943 
	`ev_timî_°›
 (
EV_A_
 
w
);

3945 i‡(
w
->
ª≥©
)

3947 
	`ev_©
 (
w
Ëw->
ª≥©
;

3948 
	`ev_timî_°¨t
 (
EV_A_
 
w
);

3951 
EV_FREQUENT_CHECK
;

3952 
	}
}

3954 
ev_t°amp


3955 
	$ev_timî_ªmaöög
 (
EV_P_
 
ev_timî
 *
w
Ë
EV_THROW


3957  
	`ev_©
 (
w
Ë- (
	`ev_is_a˘ive
 (wË? 
mn_now
 : 0.);

3958 
	}
}

3960 #i‡
EV_PERIODIC_ENABLE


3961 
noölöe


3962 
	$ev_≥riodic_°¨t
 (
EV_P_
 
ev_≥riodic
 *
w
Ë
EV_THROW


3964 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

3967 i‡(
w
->
ªscheduÀ_cb
)

3968 
	`ev_©
 (
w
Ëw->
	`ªscheduÀ_cb
 (w, 
ev_π_now
);

3969 i‡(
w
->
öãrvÆ
)

3971 
	`as£π
 (("libev:Év_≥riodic_°¨àˇŒed wôhÇeg©ivêöãrvÆ vÆue", 
w
->
öãrvÆ
 >= 0.));

3972 
	`≥riodic_ªˇlc
 (
EV_A_
 
w
);

3975 
	`ev_©
 (
w
Ëw->
off£t
;

3977 
EV_FREQUENT_CHECK
;

3979 ++
≥riodic˙t
;

3980 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 
≥riodic˙t
 + 
HEAP0
 - 1);

3981 
	`¨øy_√edsize
 (
ANHE
, 
≥riodics
, 
≥riodicmax
, 
	`ev_a˘ive
 (
w
Ë+ 1, 
EMPTY2
);

3982 
	`ANHE_w
 (
≥riodics
 [
	`ev_a˘ive
 (
w
)]Ë(
WT
)w;

3983 
	`ANHE_©_ˇche
 (
≥riodics
 [
	`ev_a˘ive
 (
w
)]);

3984 
	`uphóp
 (
≥riodics
, 
	`ev_a˘ive
 (
w
));

3986 
EV_FREQUENT_CHECK
;

3989 
	}
}

3991 
noölöe


3992 
	$ev_≥riodic_°›
 (
EV_P_
 
ev_≥riodic
 *
w
Ë
EV_THROW


3994 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

3995 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

3998 
EV_FREQUENT_CHECK
;

4001 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

4003 
	`as£π
 (("libev: i¡î«»≥riodi¯hó∞c‹ru±i⁄", 
	`ANHE_w
 (
≥riodics
 [
a˘ive
]Ë=(
WT
)
w
));

4005 --
≥riodic˙t
;

4007 i‡(
	`ex≥˘_åue
 (
a˘ive
 < 
≥riodic˙t
 + 
HEAP0
))

4009 
≥riodics
 [
a˘ive
] =Öîiodic†[
≥riodic˙t
 + 
HEAP0
];

4010 
	`adju°hóp
 (
≥riodics
, 
≥riodic˙t
, 
a˘ive
);

4014 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4016 
EV_FREQUENT_CHECK
;

4017 
	}
}

4019 
noölöe


4020 
	$ev_≥riodic_agaö
 (
EV_P_
 
ev_≥riodic
 *
w
Ë
EV_THROW


4023 
	`ev_≥riodic_°›
 (
EV_A_
 
w
);

4024 
	`ev_≥riodic_°¨t
 (
EV_A_
 
w
);

4025 
	}
}

4028 #i‚de‡
SA_RESTART


4029 
	#SA_RESTART
 0

	)

4032 #i‡
EV_SIGNAL_ENABLE


4034 
noölöe


4035 
	$ev_sig«l_°¨t
 (
EV_P_
 
ev_sig«l
 *
w
Ë
EV_THROW


4037 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4040 
	`as£π
 (("libev:Év_sig«l_°¨àˇŒed wôh iŒegÆ sig«»numbî", 
w
->
signum
 > 0 && w->signum < 
EV_NSIG
));

4042 #i‡
EV_MULTIPLICITY


4043 
	`as£π
 (("libev:á signal mustÇot beáttachedÅoÅwo differentÜoops",

4044 !
sig«ls
 [
w
->
signum
 - 1].
lo›
 || signals [w->signum - 1].loop ==Üoop));

4046 
sig«ls
 [
w
->
signum
 - 1].
lo›
 = 
EV_A
;

4047 
ECB_MEMORY_FENCE_RELEASE
;

4050 
EV_FREQUENT_CHECK
;

4052 #i‡
EV_USE_SIGNALFD


4053 i‡(
sigfd
 == -2)

4055 
sigfd
 = 
	`sig«lfd
 (-1, &
sigfd_£t
, 
SFD_NONBLOCK
 | 
SFD_CLOEXEC
);

4056 i‡(
sigfd
 < 0 && 
î∫o
 =
EINVAL
)

4057 
sigfd
 = 
	`sig«lfd
 (-1, &
sigfd_£t
, 0);

4059 i‡(
sigfd
 >= 0)

4061 
	`fd_öã∫
 (
sigfd
);

4063 
	`sigem±y£t
 (&
sigfd_£t
);

4065 
	`ev_io_öô
 (&
sigfd_w
, 
sigfdcb
, 
sigfd
, 
EV_READ
);

4066 
	`ev_£t_¥i‹ôy
 (&
sigfd_w
, 
EV_MAXPRI
);

4067 
	`ev_io_°¨t
 (
EV_A_
 &
sigfd_w
);

4068 
	`ev_uƒef
 (
EV_A
);

4072 i‡(
sigfd
 >= 0)

4075 
	`sigadd£t
 (&
sigfd_£t
, 
w
->
signum
);

4076 
	`sig¥ocmask
 (
SIG_BLOCK
, &
sigfd_£t
, 0);

4078 
	`sig«lfd
 (
sigfd
, &
sigfd_£t
, 0);

4082 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 1);

4083 
	`wli°_add
 (&
sig«ls
 [
w
->
signum
 - 1].
hód
, (
WL
)w);

4085 i‡(!((
WL
)
w
)->
√xt
)

4086 #i‡
EV_USE_SIGNALFD


4087 i‡(
sigfd
 < 0)

4090 #ifde‡
_WIN32


4091 
	`evpùe_öô
 (
EV_A
);

4093 
	`sig«l
 (
w
->
signum
, 
ev_sigh™dÀr
);

4095 
siga˘i⁄
 
ß
;

4097 
	`evpùe_öô
 (
EV_A
);

4099 
ß
.
ß_h™dÀr
 = 
ev_sigh™dÀr
;

4100 
	`sigfûl£t
 (&
ß
.
ß_mask
);

4101 
ß
.
ß_Êags
 = 
SA_RESTART
;

4102 
	`siga˘i⁄
 (
w
->
signum
, &
ß
, 0);

4104 i‡(
‹igÊags
 & 
EVFLAG_NOSIGMASK
)

4106 
	`sigem±y£t
 (&
ß
.
ß_mask
);

4107 
	`sigadd£t
 (&
ß
.
ß_mask
, 
w
->
signum
);

4108 
	`sig¥ocmask
 (
SIG_UNBLOCK
, &
ß
.
ß_mask
, 0);

4113 
EV_FREQUENT_CHECK
;

4114 
	}
}

4116 
noölöe


4117 
	$ev_sig«l_°›
 (
EV_P_
 
ev_sig«l
 *
w
Ë
EV_THROW


4119 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4120 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4123 
EV_FREQUENT_CHECK
;

4125 
	`wli°_dñ
 (&
sig«ls
 [
w
->
signum
 - 1].
hód
, (
WL
)w);

4126 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4128 i‡(!
sig«ls
 [
w
->
signum
 - 1].
hód
)

4130 #i‡
EV_MULTIPLICITY


4131 
sig«ls
 [
w
->
signum
 - 1].
lo›
 = 0;

4133 #i‡
EV_USE_SIGNALFD


4134 i‡(
sigfd
 >= 0)

4136 
sig£t_t
 
ss
;

4138 
	`sigem±y£t
 (&
ss
);

4139 
	`sigadd£t
 (&
ss
, 
w
->
signum
);

4140 
	`sigdñ£t
 (&
sigfd_£t
, 
w
->
signum
);

4142 
	`sig«lfd
 (
sigfd
, &
sigfd_£t
, 0);

4143 
	`sig¥ocmask
 (
SIG_UNBLOCK
, &
ss
, 0);

4147 
	`sig«l
 (
w
->
signum
, 
SIG_DFL
);

4150 
EV_FREQUENT_CHECK
;

4151 
	}
}

4155 #i‡
EV_CHILD_ENABLE


4158 
	$ev_chûd_°¨t
 (
EV_P_
 
ev_chûd
 *
w
Ë
EV_THROW


4160 #i‡
EV_MULTIPLICITY


4161 
	`as£π
 (("libev: chûd w©chî†¨ê⁄ly suµ‹ãd i¿thêdeÁu…Üo›", 
lo›
 =
ev_deÁu…_lo›_±r
));

4163 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4166 
EV_FREQUENT_CHECK
;

4168 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 1);

4169 
	`wli°_add
 (&
chûds
 [
w
->
pid
 & ((
EV_PID_HASHSIZE
Ë- 1)], (
WL
)w);

4171 
EV_FREQUENT_CHECK
;

4172 
	}
}

4175 
	$ev_chûd_°›
 (
EV_P_
 
ev_chûd
 *
w
Ë
EV_THROW


4177 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4178 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4181 
EV_FREQUENT_CHECK
;

4183 
	`wli°_dñ
 (&
chûds
 [
w
->
pid
 & ((
EV_PID_HASHSIZE
Ë- 1)], (
WL
)w);

4184 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4186 
EV_FREQUENT_CHECK
;

4187 
	}
}

4191 #i‡
EV_STAT_ENABLE


4193 #ifde‡
_WIN32


4194 #unde‡
l°©


4195 
	#l°©
(
a
,
b
Ë
	`_°©i64
 (a,b)

	)

4198 
	#DEF_STAT_INTERVAL
 5.0074891

	)

4199 
	#NFS_STAT_INTERVAL
 30.1074891

	)

4200 
	#MIN_STAT_INTERVAL
 0.1074891

	)

4202 
noölöe
 
°©_timî_cb
 (
EV_P_
 
ev_timî
 *
w_
, 
ªvíts
);

4204 #i‡
EV_USE_INOTIFY


4207 
	#EV_INOTIFY_BUFSIZE
 ( (
öŸify_evít
Ë* 2 + 
NAME_MAX
)

	)

4209 
noölöe


4210 
	$öfy_add
 (
EV_P_
 
ev_°©
 *
w
)

4212 
w
->
wd
 = 
	`öŸify_add_w©ch
 (
fs_fd
, w->
∑th
,

4213 
IN_ATTRIB
 | 
IN_DELETE_SELF
 | 
IN_MOVE_SELF
 | 
IN_MODIFY


4214 | 
IN_CREATE
 | 
IN_DELETE
 | 
IN_MOVED_FROM
 | 
IN_MOVED_TO


4215 | 
IN_DONT_FOLLOW
 | 
IN_MASK_ADD
);

4217 i‡(
w
->
wd
 >= 0)

4219 
°©fs
 
sfs
;

4225 i‡(!
fs_2625
)

4226 
w
->
timî
.
ª≥©
 = w->
öãrvÆ
 ? w->öãrvÆ : 
DEF_STAT_INTERVAL
;

4227 i‡(!
	`°©fs
 (
w
->
∑th
, &
sfs
)

4228 && (
sfs
.
f_ty≥
 == 0x1373

4229 || 
sfs
.
f_ty≥
 == 0x4006

4230 || 
sfs
.
f_ty≥
 == 0x4d44

4231 || 
sfs
.
f_ty≥
 == 0xEF53

4232 || 
sfs
.
f_ty≥
 == 0x72b6

4233 || 
sfs
.
f_ty≥
 == 0x858458f6

4234 || 
sfs
.
f_ty≥
 == 0x5346544e

4235 || 
sfs
.
f_ty≥
 == 0x3153464a

4236 || 
sfs
.
f_ty≥
 == 0x9123683e

4237 || 
sfs
.
f_ty≥
 == 0x52654973

4238 || 
sfs
.
f_ty≥
 == 0x01021994

4239 || 
sfs
.
f_ty≥
 == 0x58465342 ))

4240 
w
->
timî
.
ª≥©
 = 0.;

4242 
w
->
timî
.
ª≥©
 = w->
öãrvÆ
 ? w->öãrvÆ : 
NFS_STAT_INTERVAL
;

4247 
w
->
timî
.
ª≥©
 = w->
öãrvÆ
 ? w->öãrvÆ : 
DEF_STAT_INTERVAL
;

4252 i‡((
î∫o
 =
ENOENT
 ||Éºnÿ=
EACCES
Ë&& 
	`°æí
 (
w
->
∑th
) < 4096)

4254 
∑th
 [4096];

4255 
	`°r˝y
 (
∑th
, 
w
->path);

4259 
mask
 = 
IN_MASK_ADD
 | 
IN_DELETE_SELF
 | 
IN_MOVE_SELF


4260 | (
î∫o
 =
EACCES
 ? 
IN_ATTRIB
 : 
IN_CREATE
 | 
IN_MOVED_TO
);

4262 *
≥nd
 = 
	`°ºchr
 (
∑th
, '/');

4264 i‡(!
≥nd
 ||Öíd =
∑th
)

4267 *
≥nd
 = 0;

4268 
w
->
wd
 = 
	`öŸify_add_w©ch
 (
fs_fd
, 
∑th
, 
mask
);

4270 
w
->
wd
 < 0 && (
î∫o
 =
ENOENT
 ||Éºnÿ=
EACCES
));

4274 i‡(
w
->
wd
 >= 0)

4275 
	`wli°_add
 (&
fs_hash
 [
w
->
wd
 & ((
EV_INOTIFY_HASHSIZE
Ë- 1)].
hód
, (
WL
)w);

4278 i‡(
	`ev_is_a˘ive
 (&
w
->
timî
)Ë
	`ev_ªf
 (
EV_A
);

4279 
	`ev_timî_agaö
 (
EV_A_
 &
w
->
timî
);

4280 i‡(
	`ev_is_a˘ive
 (&
w
->
timî
)Ë
	`ev_uƒef
 (
EV_A
);

4281 
	}
}

4283 
noölöe


4284 
	$öfy_dñ
 (
EV_P_
 
ev_°©
 *
w
)

4286 
¶Ÿ
;

4287 
wd
 = 
w
->wd;

4289 i‡(
wd
 < 0)

4292 
w
->
wd
 = -2;

4293 
¶Ÿ
 = 
wd
 & ((
EV_INOTIFY_HASHSIZE
) - 1);

4294 
	`wli°_dñ
 (&
fs_hash
 [
¶Ÿ
].
hód
, (
WL
)
w
);

4297 
	`öŸify_rm_w©ch
 (
fs_fd
, 
wd
);

4298 
	}
}

4300 
noölöe


4301 
	$öfy_wd
 (
EV_P_
 
¶Ÿ
, 
wd
, 
öŸify_evít
 *
ev
)

4303 i‡(
¶Ÿ
 < 0)

4305 
¶Ÿ
 = 0; slŸ < (
EV_INOTIFY_HASHSIZE
); ++slot)

4306 
	`öfy_wd
 (
EV_A_
 
¶Ÿ
, 
wd
, 
ev
);

4309 
WL
 
w_
;

4311 
w_
 = 
fs_hash
 [
¶Ÿ
 & ((
EV_INOTIFY_HASHSIZE
Ë- 1)].
hód
; w_; )

4313 
ev_°©
 *
w
 = (ev_°© *)
w_
;

4314 
w_
 = w_->
√xt
;

4316 i‡(
w
->
wd
 == wd || wd == -1)

4318 i‡(
ev
->
mask
 & (
IN_IGNORED
 | 
IN_UNMOUNT
 | 
IN_DELETE_SELF
))

4320 
	`wli°_dñ
 (&
fs_hash
 [
¶Ÿ
 & ((
EV_INOTIFY_HASHSIZE
Ë- 1)].
hód
, (
WL
)
w
);

4321 
w
->
wd
 = -1;

4322 
	`öfy_add
 (
EV_A_
 
w
);

4325 
	`°©_timî_cb
 (
EV_A_
 &
w
->
timî
, 0);

4329 
	}
}

4332 
	$öfy_cb
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

4334 
buf
 [
EV_INOTIFY_BUFSIZE
];

4335 
ofs
;

4336 
Àn
 = 
	`ªad
 (
fs_fd
, 
buf
,  (buf));

4338 
ofs
 = 0; of†< 
Àn
; )

4340 
öŸify_evít
 *
ev
 = (öŸify_evíà*)(
buf
 + 
ofs
);

4341 
	`öfy_wd
 (
EV_A_
 
ev
->
wd
,Év->wd,Év);

4342 
ofs
 + (
öŸify_evít
Ë+ 
ev
->
Àn
;

4344 
	}
}

4346 
ölöe_size
 
ecb_cﬁd


4347 
	$ev_check_2625
 (
EV_P
)

4352 i‡(
	`ev_löux_vîsi⁄
 () < 0x020619)

4355 
fs_2625
 = 1;

4356 
	}
}

4358 
ölöe_size
 

4359 
	$öfy_√wfd
 ()

4361 #i‡
deföed
 
IN_CLOEXEC
 && deföed 
IN_NONBLOCK


4362 
fd
 = 
	`öŸify_öô1
 (
IN_CLOEXEC
 | 
IN_NONBLOCK
);

4363 i‡(
fd
 >= 0)

4364  
fd
;

4366  
	`öŸify_öô
 ();

4367 
	}
}

4369 
ölöe_size
 

4370 
	$öfy_öô
 (
EV_P
)

4372 i‡(
fs_fd
 != -2)

4375 
fs_fd
 = -1;

4377 
	`ev_check_2625
 (
EV_A
);

4379 
fs_fd
 = 
	`öfy_√wfd
 ();

4381 i‡(
fs_fd
 >= 0)

4383 
	`fd_öã∫
 (
fs_fd
);

4384 
	`ev_io_öô
 (&
fs_w
, 
öfy_cb
, 
fs_fd
, 
EV_READ
);

4385 
	`ev_£t_¥i‹ôy
 (&
fs_w
, 
EV_MAXPRI
);

4386 
	`ev_io_°¨t
 (
EV_A_
 &
fs_w
);

4387 
	`ev_uƒef
 (
EV_A
);

4389 
	}
}

4391 
ölöe_size
 

4392 
	$öfy_f‹k
 (
EV_P
)

4394 
¶Ÿ
;

4396 i‡(
fs_fd
 < 0)

4399 
	`ev_ªf
 (
EV_A
);

4400 
	`ev_io_°›
 (
EV_A_
 &
fs_w
);

4401 
	`˛o£
 (
fs_fd
);

4402 
fs_fd
 = 
	`öfy_√wfd
 ();

4404 i‡(
fs_fd
 >= 0)

4406 
	`fd_öã∫
 (
fs_fd
);

4407 
	`ev_io_£t
 (&
fs_w
, 
fs_fd
, 
EV_READ
);

4408 
	`ev_io_°¨t
 (
EV_A_
 &
fs_w
);

4409 
	`ev_uƒef
 (
EV_A
);

4412 
¶Ÿ
 = 0; slŸ < (
EV_INOTIFY_HASHSIZE
); ++slot)

4414 
WL
 
w_
 = 
fs_hash
 [
¶Ÿ
].
hód
;

4415 
fs_hash
 [
¶Ÿ
].
hód
 = 0;

4417 
w_
)

4419 
ev_°©
 *
w
 = (ev_°© *)
w_
;

4420 
w_
 = w_->
√xt
;

4422 
w
->
wd
 = -1;

4424 i‡(
fs_fd
 >= 0)

4425 
	`öfy_add
 (
EV_A_
 
w
);

4428 
w
->
timî
.
ª≥©
 = w->
öãrvÆ
 ? w->öãrvÆ : 
DEF_STAT_INTERVAL
;

4429 i‡(
	`ev_is_a˘ive
 (&
w
->
timî
)Ë
	`ev_ªf
 (
EV_A
);

4430 
	`ev_timî_agaö
 (
EV_A_
 &
w
->
timî
);

4431 i‡(
	`ev_is_a˘ive
 (&
w
->
timî
)Ë
	`ev_uƒef
 (
EV_A
);

4435 
	}
}

4439 #ifde‡
_WIN32


4440 
	#EV_LSTAT
(
p
,
b
Ë
	`_°©i64
 (p, b)

	)

4442 
	#EV_LSTAT
(
p
,
b
Ë
	`l°©
 (p, b)

	)

4446 
	$ev_°©_°©
 (
EV_P_
 
ev_°©
 *
w
Ë
EV_THROW


4448 i‡(
	`l°©
 (
w
->
∑th
, &w->
©å
) < 0)

4449 
w
->
©å
.
°_∆ök
 = 0;

4450 i‡(!
w
->
©å
.
°_∆ök
)

4451 
w
->
©å
.
°_∆ök
 = 1;

4452 
	}
}

4454 
noölöe


4455 
	$°©_timî_cb
 (
EV_P_
 
ev_timî
 *
w_
, 
ªvíts
)

4457 
ev_°©
 *
w
 = (ev_°© *)(((*)
w_
Ë- 
	`off£tof
 (ev_°©, 
timî
));

4459 
ev_°©d©a
 
¥ev
 = 
w
->
©å
;

4460 
	`ev_°©_°©
 (
EV_A_
 
w
);

4464 
¥ev
.
°_dev
 !
w
->
©å
.st_dev

4465 || 
¥ev
.
°_öo
 !
w
->
©å
.st_ino

4466 || 
¥ev
.
°_mode
 !
w
->
©å
.st_mode

4467 || 
¥ev
.
°_∆ök
 !
w
->
©å
.st_nlink

4468 || 
¥ev
.
°_uid
 !
w
->
©å
.st_uid

4469 || 
¥ev
.
°_gid
 !
w
->
©å
.st_gid

4470 || 
¥ev
.
°_rdev
 !
w
->
©å
.st_rdev

4471 || 
¥ev
.
°_size
 !
w
->
©å
.st_size

4472 || 
¥ev
.
°_©ime
 !
w
->
©å
.st_atime

4473 || 
¥ev
.
°_mtime
 !
w
->
©å
.st_mtime

4474 || 
¥ev
.
°_˘ime
 !
w
->
©å
.st_ctime

4479 
w
->
¥ev
 =Örev;

4481 #i‡
EV_USE_INOTIFY


4482 i‡(
fs_fd
 >= 0)

4484 
	`öfy_dñ
 (
EV_A_
 
w
);

4485 
	`öfy_add
 (
EV_A_
 
w
);

4486 
	`ev_°©_°©
 (
EV_A_
 
w
);

4490 
	`ev_„ed_evít
 (
EV_A_
 
w
, 
EV_STAT
);

4492 
	}
}

4495 
	$ev_°©_°¨t
 (
EV_P_
 
ev_°©
 *
w
Ë
EV_THROW


4497 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4500 
	`ev_°©_°©
 (
EV_A_
 
w
);

4502 i‡(
w
->
öãrvÆ
 < 
MIN_STAT_INTERVAL
 && w->interval)

4503 
w
->
öãrvÆ
 = 
MIN_STAT_INTERVAL
;

4505 
	`ev_timî_öô
 (&
w
->
timî
, 
°©_timî_cb
, 0., w->
öãrvÆ
 ? w->öãrvÆ : 
DEF_STAT_INTERVAL
);

4506 
	`ev_£t_¥i‹ôy
 (&
w
->
timî
, 
	`ev_¥i‹ôy
 (w));

4508 #i‡
EV_USE_INOTIFY


4509 
	`öfy_öô
 (
EV_A
);

4511 i‡(
fs_fd
 >= 0)

4512 
	`öfy_add
 (
EV_A_
 
w
);

4516 
	`ev_timî_agaö
 (
EV_A_
 &
w
->
timî
);

4517 
	`ev_uƒef
 (
EV_A
);

4520 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 1);

4522 
EV_FREQUENT_CHECK
;

4523 
	}
}

4526 
	$ev_°©_°›
 (
EV_P_
 
ev_°©
 *
w
Ë
EV_THROW


4528 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4529 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4532 
EV_FREQUENT_CHECK
;

4534 #i‡
EV_USE_INOTIFY


4535 
	`öfy_dñ
 (
EV_A_
 
w
);

4538 i‡(
	`ev_is_a˘ive
 (&
w
->
timî
))

4540 
	`ev_ªf
 (
EV_A
);

4541 
	`ev_timî_°›
 (
EV_A_
 &
w
->
timî
);

4544 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4546 
EV_FREQUENT_CHECK
;

4547 
	}
}

4550 #i‡
EV_IDLE_ENABLE


4552 
	$ev_idÀ_°¨t
 (
EV_P_
 
ev_idÀ
 *
w
Ë
EV_THROW


4554 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4557 
	`¥i_adju°
 (
	`EV_A_
 (
W
)
w
);

4559 
EV_FREQUENT_CHECK
;

4562 
a˘ive
 = ++
idÀ˙t
 [
	`ABSPRI
 (
w
)];

4564 ++
idÀÆl
;

4565 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 
a˘ive
);

4567 
	`¨øy_√edsize
 (
ev_idÀ
 *, 
idÀs
 [
	`ABSPRI
 (
w
)], 
idÀmax
 [ABSPRI (w)], 
a˘ive
, 
EMPTY2
);

4568 
idÀs
 [
	`ABSPRI
 (
w
)][
a˘ive
 - 1] = w;

4571 
EV_FREQUENT_CHECK
;

4572 
	}
}

4575 
	$ev_idÀ_°›
 (
EV_P_
 
ev_idÀ
 *
w
Ë
EV_THROW


4577 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4578 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4581 
EV_FREQUENT_CHECK
;

4584 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

4586 
idÀs
 [
	`ABSPRI
 (
w
)][
a˘ive
 - 1] = idÀ†[ABSPRI (w)][--
idÀ˙t
 [ABSPRI (w)]];

4587 
	`ev_a˘ive
 (
idÀs
 [
	`ABSPRI
 (
w
)][
a˘ive
 - 1]) =áctive;

4589 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4590 --
idÀÆl
;

4593 
EV_FREQUENT_CHECK
;

4594 
	}
}

4597 #i‡
EV_PREPARE_ENABLE


4599 
	$ev_¥ï¨e_°¨t
 (
EV_P_
 
ev_¥ï¨e
 *
w
Ë
EV_THROW


4601 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4604 
EV_FREQUENT_CHECK
;

4606 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, ++
¥ï¨e˙t
);

4607 
	`¨øy_√edsize
 (
ev_¥ï¨e
 *, 
¥ï¨es
, 
¥ï¨emax
, 
¥ï¨e˙t
, 
EMPTY2
);

4608 
¥ï¨es
 [
¥ï¨e˙t
 - 1] = 
w
;

4610 
EV_FREQUENT_CHECK
;

4611 
	}
}

4614 
	$ev_¥ï¨e_°›
 (
EV_P_
 
ev_¥ï¨e
 *
w
Ë
EV_THROW


4616 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4617 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4620 
EV_FREQUENT_CHECK
;

4623 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

4625 
¥ï¨es
 [
a˘ive
 - 1] =Öª∑ª†[--
¥ï¨e˙t
];

4626 
	`ev_a˘ive
 (
¥ï¨es
 [
a˘ive
 - 1]) =áctive;

4629 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4631 
EV_FREQUENT_CHECK
;

4632 
	}
}

4635 #i‡
EV_CHECK_ENABLE


4637 
	$ev_check_°¨t
 (
EV_P_
 
ev_check
 *
w
Ë
EV_THROW


4639 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4642 
EV_FREQUENT_CHECK
;

4644 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, ++
check˙t
);

4645 
	`¨øy_√edsize
 (
ev_check
 *, 
checks
, 
checkmax
, 
check˙t
, 
EMPTY2
);

4646 
checks
 [
check˙t
 - 1] = 
w
;

4648 
EV_FREQUENT_CHECK
;

4649 
	}
}

4652 
	$ev_check_°›
 (
EV_P_
 
ev_check
 *
w
Ë
EV_THROW


4654 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4655 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4658 
EV_FREQUENT_CHECK
;

4661 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

4663 
checks
 [
a˘ive
 - 1] = check†[--
check˙t
];

4664 
	`ev_a˘ive
 (
checks
 [
a˘ive
 - 1]) =áctive;

4667 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4669 
EV_FREQUENT_CHECK
;

4670 
	}
}

4673 #i‡
EV_EMBED_ENABLE


4674 
noölöe


4675 
	$ev_embed_swìp
 (
EV_P_
 
ev_embed
 *
w
Ë
EV_THROW


4677 
	`ev_run
 (
w
->
Ÿhî
, 
EVRUN_NOWAIT
);

4678 
	}
}

4681 
	$embed_io_cb
 (
EV_P_
 
ev_io
 *
io
, 
ªvíts
)

4683 
ev_embed
 *
w
 = (ev_embed *)(((*)
io
Ë- 
	`off£tof
 (ev_embed, io));

4685 i‡(
	`ev_cb
 (
w
))

4686 
	`ev_„ed_evít
 (
	`EV_A_
 (
W
)
w
, 
EV_EMBED
);

4688 
	`ev_run
 (
w
->
Ÿhî
, 
EVRUN_NOWAIT
);

4689 
	}
}

4692 
	$embed_¥ï¨e_cb
 (
EV_P_
 
ev_¥ï¨e
 *
¥ï¨e
, 
ªvíts
)

4694 
ev_embed
 *
w
 = (ev_embed *)(((*)
¥ï¨e
Ë- 
	`off£tof
 (ev_embed,Örepare));

4697 
EV_P
 = 
w
->
Ÿhî
;

4699 
fdch™ge˙t
)

4701 
	`fd_ªify
 (
EV_A
);

4702 
	`ev_run
 (
EV_A_
 
EVRUN_NOWAIT
);

4705 
	}
}

4708 
	$embed_f‹k_cb
 (
EV_P_
 
ev_f‹k
 *
f‹k_w
, 
ªvíts
)

4710 
ev_embed
 *
w
 = (ev_embed *)(((*)
f‹k_w
Ë- 
	`off£tof
 (ev_embed, 
f‹k
));

4712 
	`ev_embed_°›
 (
EV_A_
 
w
);

4715 
EV_P
 = 
w
->
Ÿhî
;

4717 
	`ev_lo›_f‹k
 (
EV_A
);

4718 
	`ev_run
 (
EV_A_
 
EVRUN_NOWAIT
);

4721 
	`ev_embed_°¨t
 (
EV_A_
 
w
);

4722 
	}
}

4726 
	$embed_idÀ_cb
 (
EV_P_
 
ev_idÀ
 *
idÀ
, 
ªvíts
)

4728 
	`ev_idÀ_°›
 (
EV_A_
 
idÀ
);

4729 
	}
}

4733 
	$ev_embed_°¨t
 (
EV_P_
 
ev_embed
 *
w
Ë
EV_THROW


4735 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4739 
EV_P
 = 
w
->
Ÿhî
;

4740 
	`as£π
 (("libev:Üo›Åÿbêembedded i†nŸÉmbeddabÀ", 
backíd
 & 
	`ev_embeddabÀ_backíds
 ()));

4741 
	`ev_io_öô
 (&
w
->
io
, 
embed_io_cb
, 
backíd_fd
, 
EV_READ
);

4744 
EV_FREQUENT_CHECK
;

4746 
	`ev_£t_¥i‹ôy
 (&
w
->
io
, 
	`ev_¥i‹ôy
 (w));

4747 
	`ev_io_°¨t
 (
EV_A_
 &
w
->
io
);

4749 
	`ev_¥ï¨e_öô
 (&
w
->
¥ï¨e
, 
embed_¥ï¨e_cb
);

4750 
	`ev_£t_¥i‹ôy
 (&
w
->
¥ï¨e
, 
EV_MINPRI
);

4751 
	`ev_¥ï¨e_°¨t
 (
EV_A_
 &
w
->
¥ï¨e
);

4753 
	`ev_f‹k_öô
 (&
w
->
f‹k
, 
embed_f‹k_cb
);

4754 
	`ev_f‹k_°¨t
 (
EV_A_
 &
w
->
f‹k
);

4758 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, 1);

4760 
EV_FREQUENT_CHECK
;

4761 
	}
}

4764 
	$ev_embed_°›
 (
EV_P_
 
ev_embed
 *
w
Ë
EV_THROW


4766 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4767 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4770 
EV_FREQUENT_CHECK
;

4772 
	`ev_io_°›
 (
EV_A_
 &
w
->
io
);

4773 
	`ev_¥ï¨e_°›
 (
EV_A_
 &
w
->
¥ï¨e
);

4774 
	`ev_f‹k_°›
 (
EV_A_
 &
w
->
f‹k
);

4776 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4778 
EV_FREQUENT_CHECK
;

4779 
	}
}

4782 #i‡
EV_FORK_ENABLE


4784 
	$ev_f‹k_°¨t
 (
EV_P_
 
ev_f‹k
 *
w
Ë
EV_THROW


4786 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4789 
EV_FREQUENT_CHECK
;

4791 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, ++
f‹k˙t
);

4792 
	`¨øy_√edsize
 (
ev_f‹k
 *, 
f‹ks
, 
f‹kmax
, 
f‹k˙t
, 
EMPTY2
);

4793 
f‹ks
 [
f‹k˙t
 - 1] = 
w
;

4795 
EV_FREQUENT_CHECK
;

4796 
	}
}

4799 
	$ev_f‹k_°›
 (
EV_P_
 
ev_f‹k
 *
w
Ë
EV_THROW


4801 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4802 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4805 
EV_FREQUENT_CHECK
;

4808 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

4810 
f‹ks
 [
a˘ive
 - 1] = f‹k†[--
f‹k˙t
];

4811 
	`ev_a˘ive
 (
f‹ks
 [
a˘ive
 - 1]) =áctive;

4814 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4816 
EV_FREQUENT_CHECK
;

4817 
	}
}

4820 #i‡
EV_CLEANUP_ENABLE


4822 
	$ev_˛ónup_°¨t
 (
EV_P_
 
ev_˛ónup
 *
w
Ë
EV_THROW


4824 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4827 
EV_FREQUENT_CHECK
;

4829 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, ++
˛ónup˙t
);

4830 
	`¨øy_√edsize
 (
ev_˛ónup
 *, 
˛ónups
, 
˛ónupmax
, 
˛ónup˙t
, 
EMPTY2
);

4831 
˛ónups
 [
˛ónup˙t
 - 1] = 
w
;

4834 
	`ev_uƒef
 (
EV_A
);

4835 
EV_FREQUENT_CHECK
;

4836 
	}
}

4839 
	$ev_˛ónup_°›
 (
EV_P_
 
ev_˛ónup
 *
w
Ë
EV_THROW


4841 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4842 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4845 
EV_FREQUENT_CHECK
;

4846 
	`ev_ªf
 (
EV_A
);

4849 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

4851 
˛ónups
 [
a˘ive
 - 1] = cÀ™up†[--
˛ónup˙t
];

4852 
	`ev_a˘ive
 (
˛ónups
 [
a˘ive
 - 1]) =áctive;

4855 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4857 
EV_FREQUENT_CHECK
;

4858 
	}
}

4861 #i‡
EV_ASYNC_ENABLE


4863 
	$ev_async_°¨t
 (
EV_P_
 
ev_async
 *
w
Ë
EV_THROW


4865 i‡(
	`ex≥˘_Ál£
 (
	`ev_is_a˘ive
 (
w
)))

4868 
w
->
£¡
 = 0;

4870 
	`evpùe_öô
 (
EV_A
);

4872 
EV_FREQUENT_CHECK
;

4874 
	`ev_°¨t
 (
	`EV_A_
 (
W
)
w
, ++
async˙t
);

4875 
	`¨øy_√edsize
 (
ev_async
 *, 
asyncs
, 
asyncmax
, 
async˙t
, 
EMPTY2
);

4876 
asyncs
 [
async˙t
 - 1] = 
w
;

4878 
EV_FREQUENT_CHECK
;

4879 
	}
}

4882 
	$ev_async_°›
 (
EV_P_
 
ev_async
 *
w
Ë
EV_THROW


4884 
	`˛ór_≥ndög
 (
	`EV_A_
 (
W
)
w
);

4885 i‡(
	`ex≥˘_Ál£
 (!
	`ev_is_a˘ive
 (
w
)))

4888 
EV_FREQUENT_CHECK
;

4891 
a˘ive
 = 
	`ev_a˘ive
 (
w
);

4893 
asyncs
 [
a˘ive
 - 1] =ásync†[--
async˙t
];

4894 
	`ev_a˘ive
 (
asyncs
 [
a˘ive
 - 1]) =áctive;

4897 
	`ev_°›
 (
	`EV_A_
 (
W
)
w
);

4899 
EV_FREQUENT_CHECK
;

4900 
	}
}

4903 
	$ev_async_£nd
 (
EV_P_
 
ev_async
 *
w
Ë
EV_THROW


4905 
w
->
£¡
 = 1;

4906 
	`evpùe_wrôe
 (
EV_A_
 &
async_≥ndög
);

4907 
	}
}

4912 
	sev_⁄˚


4914 
ev_io
 
	mio
;

4915 
ev_timî
 
	mto
;

4916 (*
	mcb
)(
	mªvíts
, *
	m¨g
);

4917 *
	m¨g
;

4921 
	$⁄˚_cb
 (
EV_P_
 
ev_⁄˚
 *
⁄˚
, 
ªvíts
)

4923 (*
cb
)(
ªvíts
, *
¨g
Ë
⁄˚
->cb;

4924 *
¨g
 = 
⁄˚
->arg;

4926 
	`ev_io_°›
 (
EV_A_
 &
⁄˚
->
io
);

4927 
	`ev_timî_°›
 (
EV_A_
 &
⁄˚
->
to
);

4928 
	`ev_‰ì
 (
⁄˚
);

4930 
	`cb
 (
ªvíts
, 
¨g
);

4931 
	}
}

4934 
	$⁄˚_cb_io
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

4936 
ev_⁄˚
 *
⁄˚
 = (ev_⁄˚ *)(((*)
w
Ë- 
	`off£tof
 (ev_⁄˚, 
io
));

4938 
	`⁄˚_cb
 (
EV_A_
 
⁄˚
, 
ªvíts
 | 
	`ev_˛ór_≥ndög
 (EV_A_ &⁄˚->
to
));

4939 
	}
}

4942 
	$⁄˚_cb_to
 (
EV_P_
 
ev_timî
 *
w
, 
ªvíts
)

4944 
ev_⁄˚
 *
⁄˚
 = (ev_⁄˚ *)(((*)
w
Ë- 
	`off£tof
 (ev_⁄˚, 
to
));

4946 
	`⁄˚_cb
 (
EV_A_
 
⁄˚
, 
ªvíts
 | 
	`ev_˛ór_≥ndög
 (EV_A_ &⁄˚->
io
));

4947 
	}
}

4950 
	$ev_⁄˚
 (
EV_P_
 
fd
, 
evíts
, 
ev_t°amp
 
timeout
, (*
cb
)(
ªvíts
, *
¨g
), *¨gË
EV_THROW


4952 
ev_⁄˚
 *
⁄˚
 = (ev_⁄˚ *)
	`ev_mÆloc
 ( (ev_once));

4954 i‡(
	`ex≥˘_Ál£
 (!
⁄˚
))

4956 
	`cb
 (
EV_ERROR
 | 
EV_READ
 | 
EV_WRITE
 | 
EV_TIMER
, 
¨g
);

4960 
⁄˚
->
cb
 = cb;

4961 
⁄˚
->
¨g
 =árg;

4963 
	`ev_öô
 (&
⁄˚
->
io
, 
⁄˚_cb_io
);

4964 i‡(
fd
 >= 0)

4966 
	`ev_io_£t
 (&
⁄˚
->
io
, 
fd
, 
evíts
);

4967 
	`ev_io_°¨t
 (
EV_A_
 &
⁄˚
->
io
);

4970 
	`ev_öô
 (&
⁄˚
->
to
, 
⁄˚_cb_to
);

4971 i‡(
timeout
 >= 0.)

4973 
	`ev_timî_£t
 (&
⁄˚
->
to
, 
timeout
, 0.);

4974 
	`ev_timî_°¨t
 (
EV_A_
 &
⁄˚
->
to
);

4976 
	}
}

4980 #i‡
EV_WALK_ENABLE


4981 
ecb_cﬁd


4982 
	$ev_wÆk
 (
EV_P_
 
ty≥s
, (*
cb
)(EV_P_ 
ty≥
, *
w
)Ë
EV_THROW


4984 
i
, 
j
;

4985 
ev_w©chî_li°
 *
wl
, *
wn
;

4987 i‡(
ty≥s
 & (
EV_IO
 | 
EV_EMBED
))

4988 
i
 = 0; i < 
™fdmax
; ++i)

4989 
wl
 = 
™fds
 [
i
].
hód
; wl; )

4991 
wn
 = 
wl
->
√xt
;

4993 #i‡
EV_EMBED_ENABLE


4994 i‡(
	`ev_cb
 ((
ev_io
 *)
wl
Ë=
embed_io_cb
)

4996 i‡(
ty≥s
 & 
EV_EMBED
)

4997 
	`cb
 (
EV_A_
 
EV_EMBED
, ((*)
wl
Ë- 
	`off£tof
 (
ev_embed
, 
io
));

5001 #i‡
EV_USE_INOTIFY


5002 i‡(
	`ev_cb
 ((
ev_io
 *)
wl
Ë=
öfy_cb
)

5006 i‡((
ev_io
 *)
wl
 !&
pùe_w
)

5007 i‡(
ty≥s
 & 
EV_IO
)

5008 
	`cb
 (
EV_A_
 
EV_IO
, 
wl
);

5010 
wl
 = 
wn
;

5013 i‡(
ty≥s
 & (
EV_TIMER
 | 
EV_STAT
))

5014 
i
 = 
timî˙t
 + 
HEAP0
; i-- > HEAP0; )

5015 #i‡
EV_STAT_ENABLE


5017 i‡(
	`ev_cb
 ((
ev_timî
 *)
	`ANHE_w
 (
timîs
 [
i
])Ë=
°©_timî_cb
)

5019 i‡(
ty≥s
 & 
EV_STAT
)

5020 
	`cb
 (
EV_A_
 
EV_STAT
, ((*)
	`ANHE_w
 (
timîs
 [
i
])Ë- 
	`off£tof
 (
ev_°©
, 
timî
));

5024 i‡(
ty≥s
 & 
EV_TIMER
)

5025 
	`cb
 (
EV_A_
 
EV_TIMER
, 
	`ANHE_w
 (
timîs
 [
i
]));

5027 #i‡
EV_PERIODIC_ENABLE


5028 i‡(
ty≥s
 & 
EV_PERIODIC
)

5029 
i
 = 
≥riodic˙t
 + 
HEAP0
; i-- > HEAP0; )

5030 
	`cb
 (
EV_A_
 
EV_PERIODIC
, 
	`ANHE_w
 (
≥riodics
 [
i
]));

5033 #i‡
EV_IDLE_ENABLE


5034 i‡(
ty≥s
 & 
EV_IDLE
)

5035 
j
 = 
NUMPRI
; j--; )

5036 
i
 = 
idÀ˙t
 [
j
]; i--; )

5037 
	`cb
 (
EV_A_
 
EV_IDLE
, 
idÀs
 [
j
][
i
]);

5040 #i‡
EV_FORK_ENABLE


5041 i‡(
ty≥s
 & 
EV_FORK
)

5042 
i
 = 
f‹k˙t
; i--; )

5043 i‡(
	`ev_cb
 (
f‹ks
 [
i
]Ë!
embed_f‹k_cb
)

5044 
	`cb
 (
EV_A_
 
EV_FORK
, 
f‹ks
 [
i
]);

5047 #i‡
EV_ASYNC_ENABLE


5048 i‡(
ty≥s
 & 
EV_ASYNC
)

5049 
i
 = 
async˙t
; i--; )

5050 
	`cb
 (
EV_A_
 
EV_ASYNC
, 
asyncs
 [
i
]);

5053 #i‡
EV_PREPARE_ENABLE


5054 i‡(
ty≥s
 & 
EV_PREPARE
)

5055 
i
 = 
¥ï¨e˙t
; i--; )

5056 #i‡
EV_EMBED_ENABLE


5057 i‡(
	`ev_cb
 (
¥ï¨es
 [
i
]Ë!
embed_¥ï¨e_cb
)

5059 
	`cb
 (
EV_A_
 
EV_PREPARE
, 
¥ï¨es
 [
i
]);

5062 #i‡
EV_CHECK_ENABLE


5063 i‡(
ty≥s
 & 
EV_CHECK
)

5064 
i
 = 
check˙t
; i--; )

5065 
	`cb
 (
EV_A_
 
EV_CHECK
, 
checks
 [
i
]);

5068 #i‡
EV_SIGNAL_ENABLE


5069 i‡(
ty≥s
 & 
EV_SIGNAL
)

5070 
i
 = 0; i < 
EV_NSIG
 - 1; ++i)

5071 
wl
 = 
sig«ls
 [
i
].
hód
; wl; )

5073 
wn
 = 
wl
->
√xt
;

5074 
	`cb
 (
EV_A_
 
EV_SIGNAL
, 
wl
);

5075 
wl
 = 
wn
;

5079 #i‡
EV_CHILD_ENABLE


5080 i‡(
ty≥s
 & 
EV_CHILD
)

5081 
i
 = (
EV_PID_HASHSIZE
); i--; )

5082 
wl
 = 
chûds
 [
i
]; wl; )

5084 
wn
 = 
wl
->
√xt
;

5085 
	`cb
 (
EV_A_
 
EV_CHILD
, 
wl
);

5086 
wl
 = 
wn
;

5091 
	}
}

5094 #i‡
EV_MULTIPLICITY


5095 
	~"ev_wøp.h
"

	@libev/ev.h

40 #i‚de‡
EV_H_


41 
	#EV_H_


	)

43 #ifde‡
__˝lu•lus


44 
	#EV_CPP
(
x
Ë
	)
x

45 #i‡
__˝lu•lus
 >= 201103L

46 
	#EV_THROW
 
n€x˚±


	)

48 
	#EV_THROW
 
	`throw
 ()

	)

51 
	#EV_CPP
(
x
)

	)

52 
	#EV_THROW


	)

55 
EV_CPP
("C" {)

60 #i‚de‡
EV_COMPAT3


61 
	#EV_COMPAT3
 1

	)

64 #i‚de‡
EV_FEATURES


65 #i‡
deföed
 
__OPTIMIZE_SIZE__


66 
	#EV_FEATURES
 0x7c

	)

68 
	#EV_FEATURES
 0x7f

	)

72 
	#EV_FEATURE_CODE
 ((
EV_FEATURES
Ë& 1)

	)

73 
	#EV_FEATURE_DATA
 ((
EV_FEATURES
Ë& 2)

	)

74 
	#EV_FEATURE_CONFIG
 ((
EV_FEATURES
Ë& 4)

	)

75 
	#EV_FEATURE_API
 ((
EV_FEATURES
Ë& 8)

	)

76 
	#EV_FEATURE_WATCHERS
 ((
EV_FEATURES
Ë& 16)

	)

77 
	#EV_FEATURE_BACKENDS
 ((
EV_FEATURES
Ë& 32)

	)

78 
	#EV_FEATURE_OS
 ((
EV_FEATURES
Ë& 64)

	)

81 #i‚de‡
EV_MINPRI


82 
	#EV_MINPRI
 (
EV_FEATURE_CONFIG
 ? -2 : 0)

	)

84 #i‚de‡
EV_MAXPRI


85 
	#EV_MAXPRI
 (
EV_FEATURE_CONFIG
 ? +2 : 0)

	)

88 #i‚de‡
EV_MULTIPLICITY


89 
	#EV_MULTIPLICITY
 
EV_FEATURE_CONFIG


	)

92 #i‚de‡
EV_PERIODIC_ENABLE


93 
	#EV_PERIODIC_ENABLE
 
EV_FEATURE_WATCHERS


	)

96 #i‚de‡
EV_STAT_ENABLE


97 
	#EV_STAT_ENABLE
 
EV_FEATURE_WATCHERS


	)

100 #i‚de‡
EV_PREPARE_ENABLE


101 
	#EV_PREPARE_ENABLE
 
EV_FEATURE_WATCHERS


	)

104 #i‚de‡
EV_CHECK_ENABLE


105 
	#EV_CHECK_ENABLE
 
EV_FEATURE_WATCHERS


	)

108 #i‚de‡
EV_IDLE_ENABLE


109 
	#EV_IDLE_ENABLE
 
EV_FEATURE_WATCHERS


	)

112 #i‚de‡
EV_FORK_ENABLE


113 
	#EV_FORK_ENABLE
 
EV_FEATURE_WATCHERS


	)

116 #i‚de‡
EV_CLEANUP_ENABLE


117 
	#EV_CLEANUP_ENABLE
 
EV_FEATURE_WATCHERS


	)

120 #i‚de‡
EV_SIGNAL_ENABLE


121 
	#EV_SIGNAL_ENABLE
 
EV_FEATURE_WATCHERS


	)

124 #i‚de‡
EV_CHILD_ENABLE


125 #ifde‡
_WIN32


126 
	#EV_CHILD_ENABLE
 0

	)

128 
	#EV_CHILD_ENABLE
 
EV_FEATURE_WATCHERS


	)

132 #i‚de‡
EV_ASYNC_ENABLE


133 
	#EV_ASYNC_ENABLE
 
EV_FEATURE_WATCHERS


	)

136 #i‚de‡
EV_EMBED_ENABLE


137 
	#EV_EMBED_ENABLE
 
EV_FEATURE_WATCHERS


	)

140 #i‚de‡
EV_WALK_ENABLE


141 
	#EV_WALK_ENABLE
 0

	)

146 #i‡
EV_CHILD_ENABLE
 && !
EV_SIGNAL_ENABLE


147 #unde‡
EV_SIGNAL_ENABLE


148 
	#EV_SIGNAL_ENABLE
 1

	)

153 
	tev_t°amp
;

155 
	~<°rög.h
>

157 #i‚de‡
EV_ATOMIC_T


158 
	~<sig«l.h
>

159 
	#EV_ATOMIC_T
 
sig_©omic_t
 vﬁ©ûe

	)

162 #i‡
EV_STAT_ENABLE


163 #ifde‡
_WIN32


164 
	~<time.h
>

165 
	~<sys/ty≥s.h
>

167 
	~<sys/°©.h
>

171 #i‡
EV_MULTIPLICITY


172 
ev_lo›
;

173 
	#EV_P
 
ev_lo›
 *
lo›


	)

174 
	#EV_P_
 
EV_P
,

	)

175 
	#EV_A
 
lo›


	)

176 
	#EV_A_
 
EV_A
,

	)

177 
	#EV_DEFAULT_UC
 
	`ev_deÁu…_lo›_uc_
 (Ë

	)

178 
	#EV_DEFAULT_UC_
 
EV_DEFAULT_UC
,

	)

179 
	#EV_DEFAULT
 
	`ev_deÁu…_lo›
 (0Ë

	)

180 
	#EV_DEFAULT_
 
EV_DEFAULT
,

	)

182 
	#EV_P
 

	)

183 
	#EV_P_


	)

184 
	#EV_A


	)

185 
	#EV_A_


	)

186 
	#EV_DEFAULT


	)

187 
	#EV_DEFAULT_


	)

188 
	#EV_DEFAULT_UC


	)

189 
	#EV_DEFAULT_UC_


	)

190 #unde‡
EV_EMBED_ENABLE


194 #i‡
__STDC_VERSION__
 >199901L || 
__GNUC__
 >= 3

195 
	#EV_INLINE
 
ölöe


	)

197 
	#EV_INLINE
 

	)

200 #ifde‡
EV_API_STATIC


201 
	#EV_API_DECL
 

	)

203 
	#EV_API_DECL
 

	)

207 #i‚de‡
EV_PROTOTYPES


208 
	#EV_PROTOTYPES
 1

	)

213 
	#EV_VERSION_MAJOR
 4

	)

214 
	#EV_VERSION_MINOR
 22

	)

218 
EV_UNDEF
 = ()0xFFFFFFFF,

219 
EV_NONE
 = 0x00,

220 
EV_READ
 = 0x01,

221 
EV_WRITE
 = 0x02,

222 
EV__IOFDSET
 = 0x80,

223 
EV_IO
 = 
EV_READ
,

224 
EV_TIMER
 = 0x00000100,

225 #i‡
EV_COMPAT3


226 
EV_TIMEOUT
 = 
EV_TIMER
,

228 
EV_PERIODIC
 = 0x00000200,

229 
EV_SIGNAL
 = 0x00000400,

230 
EV_CHILD
 = 0x00000800,

231 
EV_STAT
 = 0x00001000,

232 
EV_IDLE
 = 0x00002000,

233 
EV_PREPARE
 = 0x00004000,

234 
EV_CHECK
 = 0x00008000,

235 
EV_EMBED
 = 0x00010000,

236 
EV_FORK
 = 0x00020000,

237 
EV_CLEANUP
 = 0x00040000,

238 
EV_ASYNC
 = 0x00080000,

239 
EV_CUSTOM
 = 0x01000000,

240 
EV_ERROR
 = ()0x80000000

244 #i‚de‡
EV_COMMON


245 
	#EV_COMMON
 *
d©a
;

	)

248 #i‚de‡
EV_CB_DECLARE


249 
	#EV_CB_DECLARE
(
ty≥
Ë(*
cb
)(
EV_P_
 ty≥ *
w
, 
ªvíts
);

	)

251 #i‚de‡
EV_CB_INVOKE


252 
	#EV_CB_INVOKE
(
w©chî
,
ªvíts
Ë(w©chî)->
	`cb
 (
	`EV_A_
 (w©chî), (ªvíts))

	)

256 
	#EV_CB
(
ty≥
,
«me
Ë
	`«me
 (
EV_P_
 
ev_
 ##Åy≥ *
w
, 
ªvíts
)

	)

275 #i‡
EV_MINPRI
 =
EV_MAXPRI


276 
	#EV_DECL_PRIORITY


	)

277 #ñi‡!
deföed
 (
EV_DECL_PRIORITY
)

278 
	#EV_DECL_PRIORITY
 
¥i‹ôy
;

	)

282 
	#EV_WATCHER
(
ty≥
) \

283 
a˘ive
; \

284 
≥ndög
; \

285 
EV_DECL_PRIORITY
 \

286 
EV_COMMON
 \

287 
	`EV_CB_DECLARE
 (
ty≥
Ë

	)

289 
	#EV_WATCHER_LIST
(
ty≥
) \

290 
	`EV_WATCHER
 (
ty≥
) \

291 
ev_w©chî_li°
 *
√xt
;

	)

293 
	#EV_WATCHER_TIME
(
ty≥
) \

294 
	`EV_WATCHER
 (
ty≥
) \

295 
ev_t°amp
 
©
;

	)

298 
	sev_w©chî


300 
EV_WATCHER
 (
ev_w©chî
)

301 } 
	tev_w©chî
;

304 
	sev_w©chî_li°


306 
EV_WATCHER_LIST
 (
ev_w©chî_li°
)

307 } 
	tev_w©chî_li°
;

310 
	sev_w©chî_time


312 
EV_WATCHER_TIME
 (
ev_w©chî_time
)

313 } 
	tev_w©chî_time
;

317 
	sev_io


319 
EV_WATCHER_LIST
 (
ev_io
)

321 
	gfd
;

322 
	gevíts
;

323 } 
	tev_io
;

327 
	sev_timî


329 
EV_WATCHER_TIME
 (
ev_timî
)

331 
ev_t°amp
 
	gª≥©
;

332 } 
	tev_timî
;

336 
	sev_≥riodic


338 
EV_WATCHER_TIME
 (
ev_≥riodic
)

340 
ev_t°amp
 
	goff£t
;

341 
ev_t°amp
 
	göãrvÆ
;

342 
ev_t°amp
 (*
ªscheduÀ_cb
)(
ev_≥riodic
 *
	gw
,Év_t°am∞
	gnow
Ë
	gEV_THROW
;

343 } 
	tev_≥riodic
;

347 
	sev_sig«l


349 
EV_WATCHER_LIST
 (
ev_sig«l
)

351 
	gsignum
;

352 } 
	tev_sig«l
;

357 
	sev_chûd


359 
EV_WATCHER_LIST
 (
ev_chûd
)

361 
	gÊags
;

362 
	gpid
;

363 
	gΩid
;

364 
	gr°©us
;

365 } 
	tev_chûd
;

367 #i‡
EV_STAT_ENABLE


369 #ifde‡
_WIN32


370 
_°©i64
 
	tev_°©d©a
;

372 
°©
 
	tev_°©d©a
;

377 
	sev_°©


379 
EV_WATCHER_LIST
 (
ev_°©
)

381 
ev_timî
 
	gtimî
;

382 
ev_t°amp
 
	göãrvÆ
;

383 c⁄° *
	g∑th
;

384 
ev_°©d©a
 
	g¥ev
;

385 
ev_°©d©a
 
	g©å
;

387 
	gwd
;

388 } 
	tev_°©
;

391 #i‡
EV_IDLE_ENABLE


394 
	sev_idÀ


396 
EV_WATCHER
 (
ev_idÀ
)

397 } 
	tev_idÀ
;

403 
	sev_¥ï¨e


405 
EV_WATCHER
 (
ev_¥ï¨e
)

406 } 
	tev_¥ï¨e
;

410 
	sev_check


412 
EV_WATCHER
 (
ev_check
)

413 } 
	tev_check
;

415 #i‡
EV_FORK_ENABLE


418 
	sev_f‹k


420 
EV_WATCHER
 (
ev_f‹k
)

421 } 
	tev_f‹k
;

424 #i‡
EV_CLEANUP_ENABLE


427 
	sev_˛ónup


429 
EV_WATCHER
 (
ev_˛ónup
)

430 } 
	tev_˛ónup
;

433 #i‡
EV_EMBED_ENABLE


436 
	sev_embed


438 
EV_WATCHER
 (
ev_embed
)

440 
ev_lo›
 *
	gŸhî
;

441 
ev_io
 
	gio
;

442 
ev_¥ï¨e
 
	g¥ï¨e
;

443 
ev_check
 
	gcheck
;

444 
ev_timî
 
	gtimî
;

445 
ev_≥riodic
 
	g≥riodic
;

446 
ev_idÀ
 
	gidÀ
;

447 
ev_f‹k
 
	gf‹k
;

448 #i‡
EV_CLEANUP_ENABLE


449 
ev_˛ónup
 
	g˛ónup
;

451 } 
	tev_embed
;

454 #i‡
EV_ASYNC_ENABLE


457 
	sev_async


459 
EV_WATCHER
 (
ev_async
)

461 
EV_ATOMIC_T
 
	g£¡
;

462 } 
	tev_async
;

464 
	#ev_async_≥ndög
(
w
Ë(+(w)->
£¡
)

	)

468 
	uev_™y_w©chî


470 
ev_w©chî
 
	gw
;

471 
ev_w©chî_li°
 
	gwl
;

473 
ev_io
 
	gio
;

474 
ev_timî
 
	gtimî
;

475 
ev_≥riodic
 
	g≥riodic
;

476 
ev_sig«l
 
	gsig«l
;

477 
ev_chûd
 
	gchûd
;

478 #i‡
EV_STAT_ENABLE


479 
ev_°©
 
	g°©
;

481 #i‡
EV_IDLE_ENABLE


482 
ev_idÀ
 
	gidÀ
;

484 
ev_¥ï¨e
 
	g¥ï¨e
;

485 
ev_check
 
	gcheck
;

486 #i‡
EV_FORK_ENABLE


487 
ev_f‹k
 
	gf‹k
;

489 #i‡
EV_CLEANUP_ENABLE


490 
ev_˛ónup
 
	g˛ónup
;

492 #i‡
EV_EMBED_ENABLE


493 
ev_embed
 
	gembed
;

495 #i‡
EV_ASYNC_ENABLE


496 
ev_async
 
	gasync
;

503 
	gEVFLAG_AUTO
 = 0x00000000U,

505 
	gEVFLAG_NOENV
 = 0x01000000U,

506 
	gEVFLAG_FORKCHECK
 = 0x02000000U,

508 
	gEVFLAG_NOINOTIFY
 = 0x00100000U,

509 #i‡
EV_COMPAT3


510 
	gEVFLAG_NOSIGFD
 = 0,

512 
	gEVFLAG_SIGNALFD
 = 0x00200000U,

513 
	gEVFLAG_NOSIGMASK
 = 0x00400000U

518 
	gEVBACKEND_SELECT
 = 0x00000001U,

519 
	gEVBACKEND_POLL
 = 0x00000002U,

520 
	gEVBACKEND_EPOLL
 = 0x00000004U,

521 
	gEVBACKEND_KQUEUE
 = 0x00000008U,

522 
	gEVBACKEND_DEVPOLL
 = 0x00000010U,

523 
	gEVBACKEND_PORT
 = 0x00000020U,

524 
	gEVBACKEND_ALL
 = 0x0000003FU,

525 
	gEVBACKEND_MASK
 = 0x0000FFFFU

528 #i‡
EV_PROTOTYPES


529 
EV_API_DECL
 
ev_vîsi⁄_maj‹
 (Ë
	gEV_THROW
;

530 
EV_API_DECL
 
ev_vîsi⁄_mö‹
 (Ë
	gEV_THROW
;

532 
EV_API_DECL
 
ev_suµ‹ãd_backíds
 (Ë
	gEV_THROW
;

533 
EV_API_DECL
 
ev_ªcommíded_backíds
 (Ë
	gEV_THROW
;

534 
EV_API_DECL
 
ev_embeddabÀ_backíds
 (Ë
	gEV_THROW
;

536 
EV_API_DECL
 
ev_t°amp
 
ev_time
 (Ë
	gEV_THROW
;

537 
EV_API_DECL
 
ev_¶ìp
 (
ev_t°amp
 
dñay
Ë
	gEV_THROW
;

545 
EV_API_DECL
 
ev_£t_Æloˇt‹
 (*(*
cb
)(*
±r
, 
size
Ë
EV_THROW
Ë
	gEV_THROW
;

551 
EV_API_DECL
 
ev_£t_sy£º_cb
 ((*
cb
)(c⁄° *
msg
Ë
EV_THROW
Ë
	gEV_THROW
;

553 #i‡
EV_MULTIPLICITY


557 
EV_API_DECL
 
ev_lo›
 *
ev_deÁu…_lo›
 (
Êags
 
EV_CPP
 (0)Ë
EV_THROW
;

559 #ifde‡
EV_API_STATIC


560 
EV_API_DECL
 
ev_lo›
 *
	gev_deÁu…_lo›_±r
;

563 
EV_INLINE
 
ev_lo›
 *

564 
ev_deÁu…_lo›_uc_
 (Ë
	gEV_THROW


566 
ev_lo›
 *
ev_deÁu…_lo›_±r
;

568  
	gev_deÁu…_lo›_±r
;

571 
EV_INLINE
 

572 
ev_is_deÁu…_lo›
 (
EV_P
Ë
	gEV_THROW


574  
	gEV_A
 =
EV_DEFAULT_UC
;

578 
EV_API_DECL
 
ev_lo›
 *
ev_lo›_√w
 (
Êags
 
EV_CPP
 (0)Ë
EV_THROW
;

580 
EV_API_DECL
 
ev_t°amp
 
ev_now
 (
EV_P
Ë
	gEV_THROW
;

584 
EV_API_DECL
 
ev_deÁu…_lo›
 (
Êags
 
EV_CPP
 (0)Ë
EV_THROW
;

586 
EV_API_DECL
 
ev_t°amp
 
	gev_π_now
;

588 
EV_INLINE
 
ev_t°amp


589 
ev_now
 (Ë
	gEV_THROW


591  
	gev_π_now
;

595 
EV_INLINE
 

596 
ev_is_deÁu…_lo›
 (Ë
	gEV_THROW


604 
EV_API_DECL
 
ev_lo›_de°roy
 (
EV_P
);

610 
EV_API_DECL
 
ev_lo›_f‹k
 (
EV_P
Ë
	gEV_THROW
;

612 
EV_API_DECL
 
ev_backíd
 (
EV_P
Ë
	gEV_THROW
;

614 
EV_API_DECL
 
ev_now_upd©e
 (
EV_P
Ë
	gEV_THROW
;

616 #i‡
EV_WALK_ENABLE


620 
EV_API_DECL
 
ev_wÆk
 (
EV_P_
 
ty≥s
, (*
cb
)(EV_P_ 
ty≥
, *
w
)Ë
	gEV_THROW
;

627 
	gEVRUN_NOWAIT
 = 1,

628 
	gEVRUN_ONCE
 = 2

633 
	gEVBREAK_CANCEL
 = 0,

634 
	gEVBREAK_ONE
 = 1,

635 
	gEVBREAK_ALL
 = 2

638 #i‡
EV_PROTOTYPES


639 
EV_API_DECL
 
ev_run
 (
EV_P_
 
Êags
 
EV_CPP
 (= 0));

640 
EV_API_DECL
 
ev_bªak
 (
EV_P_
 
how
 
EV_CPP
 (
EVBREAK_ONE
)Ë
EV_THROW
;

647 
EV_API_DECL
 
ev_ªf
 (
EV_P
Ë
	gEV_THROW
;

648 
EV_API_DECL
 
ev_uƒef
 (
EV_P
Ë
	gEV_THROW
;

654 
EV_API_DECL
 
ev_⁄˚
 (
EV_P_
 
fd
, 
evíts
, 
ev_t°amp
 
timeout
, (*
cb
)(
ªvíts
, *
¨g
), *¨gË
	gEV_THROW
;

656 #i‡
EV_FEATURE_API


657 
EV_API_DECL
 
ev_ôî©i⁄
 (
EV_P
Ë
	gEV_THROW
;

658 
EV_API_DECL
 
ev_dïth
 (
EV_P
Ë
	gEV_THROW
;

659 
EV_API_DECL
 
ev_vîify
 (
EV_P
Ë
	gEV_THROW
;

661 
EV_API_DECL
 
ev_£t_io_cﬁÀ˘_öãrvÆ
 (
EV_P_
 
ev_t°amp
 
öãrvÆ
Ë
	gEV_THROW
;

662 
EV_API_DECL
 
ev_£t_timeout_cﬁÀ˘_öãrvÆ
 (
EV_P_
 
ev_t°amp
 
öãrvÆ
Ë
	gEV_THROW
;

665 
EV_API_DECL
 
ev_£t_u£rd©a
 (
EV_P_
 *
d©a
Ë
	gEV_THROW
;

666 
EV_API_DECL
 *
ev_u£rd©a
 (
EV_P
Ë
	gEV_THROW
;

667 (*
	gev_lo›_ˇŒback
)(
	tEV_P
);

668 
EV_API_DECL
 
ev_£t_övoke_≥ndög_cb
 (
EV_P_
 
ev_lo›_ˇŒback
 
övoke_≥ndög_cb
Ë
	gEV_THROW
;

670 
EV_API_DECL
 
ev_£t_lo›_ªÀa£_cb
 (
EV_P_
 (*
ªÀa£
)(
EV_P
Ë
EV_THROW
, (*
acquúe
)(EV_PËEV_THROWË
	gEV_THROW
;

672 
EV_API_DECL
 
ev_≥ndög_cou¡
 (
EV_P
Ë
	gEV_THROW
;

673 
EV_API_DECL
 
ev_övoke_≥ndög
 (
EV_P
);

678 
EV_API_DECL
 
ev_su•íd
 (
EV_P
Ë
	gEV_THROW
;

679 
EV_API_DECL
 
ev_ªsume
 (
EV_P
Ë
	gEV_THROW
;

686 
	#ev_öô
(
ev
,
cb_
) do { \

687 ((
ev_w©chî
 *)(*)(
ev
))->
a˘ive
 = \

688 ((
ev_w©chî
 *)(*)(
ev
))->
≥ndög
 = 0; \

689 
	`ev_£t_¥i‹ôy
 ((
ev
), 0); \

690 
	`ev_£t_cb
 ((
ev
), 
cb_
); \

691 } 0)

	)

693 
	#ev_io_£t
(
ev
,
fd_
,
evíts_
Ëdÿ{ (ev)->
fd
 = (fd_); (ev)->
evíts
 = (evíts_Ë| 
EV__IOFDSET
; } 0)

	)

694 
	#ev_timî_£t
(
ev
,
a·î_
,
ª≥©_
Ëdÿ{ ((
ev_w©chî_time
 *)”v))->
©
 = (a·î_); (ev)->
ª≥©
 = (ª≥©_); } 0)

	)

695 
	#ev_≥riodic_£t
(
ev
,
ofs_
,
ivÆ_
,
rcb_
Ëdÿ{ (ev)->
off£t
 = (ofs_); (ev)->
öãrvÆ
 = (ivÆ_); (ev)->
ªscheduÀ_cb
 = (rcb_); } 0)

	)

696 
	#ev_sig«l_£t
(
ev
,
signum_
Ëdÿ{ (ev)->
signum
 = (signum_); } 0)

	)

697 
	#ev_chûd_£t
(
ev
,
pid_
,
åa˚_
Ëdÿ{ (ev)->
pid
 = (pid_); (ev)->
Êags
 = !!—ø˚_); } 0)

	)

698 
	#ev_°©_£t
(
ev
,
∑th_
,
öãrvÆ_
Ëdÿ{ (ev)->
∑th
 = (∑th_); (ev)->
öãrvÆ
 = (öãrvÆ_); (ev)->
wd
 = -2; } 0)

	)

699 
	#ev_idÀ_£t
(
ev
Ë

	)

700 
	#ev_¥ï¨e_£t
(
ev
Ë

	)

701 
	#ev_check_£t
(
ev
Ë

	)

702 
	#ev_embed_£t
(
ev
,
Ÿhî_
Ëdÿ{ (ev)->
Ÿhî
 = (Ÿhî_); } 0)

	)

703 
	#ev_f‹k_£t
(
ev
Ë

	)

704 
	#ev_˛ónup_£t
(
ev
Ë

	)

705 
	#ev_async_£t
(
ev
Ë

	)

707 
	#ev_io_öô
(
ev
,
cb
,
fd
,
evíts
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_io_£t
 (”v),(fd),”víts)); } 0)

	)

708 
	#ev_timî_öô
(
ev
,
cb
,
a·î
,
ª≥©
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_timî_£t
 (”v),◊·î),‘ïót)); } 0)

	)

709 
	#ev_≥riodic_öô
(
ev
,
cb
,
ofs
,
ivÆ
,
rcb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_≥riodic_£t
 (”v),(ofs),(ivÆ),‘cb)); } 0)

	)

710 
	#ev_sig«l_öô
(
ev
,
cb
,
signum
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_sig«l_£t
 (”v), (signum)); } 0)

	)

711 
	#ev_chûd_öô
(
ev
,
cb
,
pid
,
åa˚
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_chûd_£t
 (”v),’id),—ø˚)); } 0)

	)

712 
	#ev_°©_öô
(
ev
,
cb
,
∑th
,
öãrvÆ
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_°©_£t
 (”v),’©h),(öãrvÆ)); } 0)

	)

713 
	#ev_idÀ_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_idÀ_£t
 (”v)); } 0)

	)

714 
	#ev_¥ï¨e_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_¥ï¨e_£t
 (”v)); } 0)

	)

715 
	#ev_check_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_check_£t
 (”v)); } 0)

	)

716 
	#ev_embed_öô
(
ev
,
cb
,
Ÿhî
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_embed_£t
 (”v),(Ÿhî)); } 0)

	)

717 
	#ev_f‹k_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_f‹k_£t
 (”v)); } 0)

	)

718 
	#ev_˛ónup_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_˛ónup_£t
 (”v)); } 0)

	)

719 
	#ev_async_öô
(
ev
,
cb
Ëdÿ{ 
	`ev_öô
 (”v), (cb)); 
	`ev_async_£t
 (”v)); } 0)

	)

721 
	#ev_is_≥ndög
(
ev
Ë(0 + ((
ev_w©chî
 *)(*)”v))->
≥ndög
Ë

	)

722 
	#ev_is_a˘ive
(
ev
Ë(0 + ((
ev_w©chî
 *)(*)”v))->
a˘ive
Ë

	)

724 
	#ev_cb_
(
ev
Ë”v)->
cb


	)

725 
	#ev_cb
(
ev
Ë(
	`memmove
 (&
	`ev_cb_
 (ev), &((
ev_w©chî
 *)”v))->
cb
,  (ev_cb_ (ev))), (ev)->cb)

	)

727 #i‡
EV_MINPRI
 =
EV_MAXPRI


728 
	#ev_¥i‹ôy
(
ev
Ë(”v), 
EV_MINPRI
)

	)

729 
	#ev_£t_¥i‹ôy
(
ev
,
¥i
Ë(”v), (¥i))

	)

731 
	#ev_¥i‹ôy
(
ev
Ë(+(((
ev_w©chî
 *)(*)”v))->
¥i‹ôy
))

	)

732 
	#ev_£t_¥i‹ôy
(
ev
,
¥i
Ë–(
ev_w©chî
 *)(*)”v))->
¥i‹ôy
 = (¥i)

	)

735 
	#ev_≥riodic_©
(
ev
Ë(+((
ev_w©chî_time
 *)”v))->
©
)

	)

737 #i‚de‡
ev_£t_cb


738 
	#ev_£t_cb
(
ev
,
cb_
Ë(
	`ev_cb_
 (evË(cb_), 
	`memmove
 (&((
ev_w©chî
 *)”v))->
cb
, &ev_cb_ (ev),  (ev_cb_ (ev))))

	)

743 #i‡
EV_PROTOTYPES


747 
EV_API_DECL
 
ev_„ed_evít
 (
EV_P_
 *
w
, 
ªvíts
Ë
	gEV_THROW
;

748 
EV_API_DECL
 
ev_„ed_fd_evít
 (
EV_P_
 
fd
, 
ªvíts
Ë
	gEV_THROW
;

749 #i‡
EV_SIGNAL_ENABLE


750 
EV_API_DECL
 
ev_„ed_sig«l
 (
signum
Ë
	gEV_THROW
;

751 
EV_API_DECL
 
ev_„ed_sig«l_evít
 (
EV_P_
 
signum
Ë
	gEV_THROW
;

753 
EV_API_DECL
 
ev_övoke
 (
EV_P_
 *
w
, 
ªvíts
);

754 
EV_API_DECL
 
ev_˛ór_≥ndög
 (
EV_P_
 *
w
Ë
	gEV_THROW
;

756 
EV_API_DECL
 
ev_io_°¨t
 (
EV_P_
 
ev_io
 *
w
Ë
	gEV_THROW
;

757 
EV_API_DECL
 
ev_io_°›
 (
EV_P_
 
ev_io
 *
w
Ë
	gEV_THROW
;

759 
EV_API_DECL
 
ev_timî_°¨t
 (
EV_P_
 
ev_timî
 *
w
Ë
	gEV_THROW
;

760 
EV_API_DECL
 
ev_timî_°›
 (
EV_P_
 
ev_timî
 *
w
Ë
	gEV_THROW
;

762 
EV_API_DECL
 
ev_timî_agaö
 (
EV_P_
 
ev_timî
 *
w
Ë
	gEV_THROW
;

764 
EV_API_DECL
 
ev_t°amp
 
ev_timî_ªmaöög
 (
EV_P_
 
ev_timî
 *
w
Ë
	gEV_THROW
;

766 #i‡
EV_PERIODIC_ENABLE


767 
EV_API_DECL
 
ev_≥riodic_°¨t
 (
EV_P_
 
ev_≥riodic
 *
w
Ë
	gEV_THROW
;

768 
EV_API_DECL
 
ev_≥riodic_°›
 (
EV_P_
 
ev_≥riodic
 *
w
Ë
	gEV_THROW
;

769 
EV_API_DECL
 
ev_≥riodic_agaö
 (
EV_P_
 
ev_≥riodic
 *
w
Ë
	gEV_THROW
;

773 #i‡
EV_SIGNAL_ENABLE


774 
EV_API_DECL
 
ev_sig«l_°¨t
 (
EV_P_
 
ev_sig«l
 *
w
Ë
	gEV_THROW
;

775 
EV_API_DECL
 
ev_sig«l_°›
 (
EV_P_
 
ev_sig«l
 *
w
Ë
	gEV_THROW
;

779 #i‡
EV_CHILD_ENABLE


780 
EV_API_DECL
 
ev_chûd_°¨t
 (
EV_P_
 
ev_chûd
 *
w
Ë
	gEV_THROW
;

781 
EV_API_DECL
 
ev_chûd_°›
 (
EV_P_
 
ev_chûd
 *
w
Ë
	gEV_THROW
;

784 #i‡
EV_STAT_ENABLE


785 
EV_API_DECL
 
ev_°©_°¨t
 (
EV_P_
 
ev_°©
 *
w
Ë
	gEV_THROW
;

786 
EV_API_DECL
 
ev_°©_°›
 (
EV_P_
 
ev_°©
 *
w
Ë
	gEV_THROW
;

787 
EV_API_DECL
 
ev_°©_°©
 (
EV_P_
 
ev_°©
 *
w
Ë
	gEV_THROW
;

790 #i‡
EV_IDLE_ENABLE


791 
EV_API_DECL
 
ev_idÀ_°¨t
 (
EV_P_
 
ev_idÀ
 *
w
Ë
	gEV_THROW
;

792 
EV_API_DECL
 
ev_idÀ_°›
 (
EV_P_
 
ev_idÀ
 *
w
Ë
	gEV_THROW
;

795 #i‡
EV_PREPARE_ENABLE


796 
EV_API_DECL
 
ev_¥ï¨e_°¨t
 (
EV_P_
 
ev_¥ï¨e
 *
w
Ë
	gEV_THROW
;

797 
EV_API_DECL
 
ev_¥ï¨e_°›
 (
EV_P_
 
ev_¥ï¨e
 *
w
Ë
	gEV_THROW
;

800 #i‡
EV_CHECK_ENABLE


801 
EV_API_DECL
 
ev_check_°¨t
 (
EV_P_
 
ev_check
 *
w
Ë
	gEV_THROW
;

802 
EV_API_DECL
 
ev_check_°›
 (
EV_P_
 
ev_check
 *
w
Ë
	gEV_THROW
;

805 #i‡
EV_FORK_ENABLE


806 
EV_API_DECL
 
ev_f‹k_°¨t
 (
EV_P_
 
ev_f‹k
 *
w
Ë
	gEV_THROW
;

807 
EV_API_DECL
 
ev_f‹k_°›
 (
EV_P_
 
ev_f‹k
 *
w
Ë
	gEV_THROW
;

810 #i‡
EV_CLEANUP_ENABLE


811 
EV_API_DECL
 
ev_˛ónup_°¨t
 (
EV_P_
 
ev_˛ónup
 *
w
Ë
	gEV_THROW
;

812 
EV_API_DECL
 
ev_˛ónup_°›
 (
EV_P_
 
ev_˛ónup
 *
w
Ë
	gEV_THROW
;

815 #i‡
EV_EMBED_ENABLE


817 
EV_API_DECL
 
ev_embed_°¨t
 (
EV_P_
 
ev_embed
 *
w
Ë
	gEV_THROW
;

818 
EV_API_DECL
 
ev_embed_°›
 (
EV_P_
 
ev_embed
 *
w
Ë
	gEV_THROW
;

819 
EV_API_DECL
 
ev_embed_swìp
 (
EV_P_
 
ev_embed
 *
w
Ë
	gEV_THROW
;

822 #i‡
EV_ASYNC_ENABLE


823 
EV_API_DECL
 
ev_async_°¨t
 (
EV_P_
 
ev_async
 *
w
Ë
	gEV_THROW
;

824 
EV_API_DECL
 
ev_async_°›
 (
EV_P_
 
ev_async
 *
w
Ë
	gEV_THROW
;

825 
EV_API_DECL
 
ev_async_£nd
 (
EV_P_
 
ev_async
 *
w
Ë
	gEV_THROW
;

828 #i‡
EV_COMPAT3


829 
	#EVLOOP_NONBLOCK
 
EVRUN_NOWAIT


	)

830 
	#EVLOOP_ONESHOT
 
EVRUN_ONCE


	)

831 
	#EVUNLOOP_CANCEL
 
EVBREAK_CANCEL


	)

832 
	#EVUNLOOP_ONE
 
EVBREAK_ONE


	)

833 
	#EVUNLOOP_ALL
 
EVBREAK_ALL


	)

834 #i‡
EV_PROTOTYPES


835 
EV_INLINE
 
ev_lo›
 (
EV_P_
 
Êags
Ë{ 
ev_run
 (
EV_A_
 flags); }

836 
EV_INLINE
 
ev_u∆o›
 (
EV_P_
 
how
 ) { 
ev_bªak
 (
EV_A_
 how ); }

837 
EV_INLINE
 
ev_deÁu…_de°roy
 (Ë{ 
ev_lo›_de°roy
 (
EV_DEFAULT
); }

838 
EV_INLINE
 
ev_deÁu…_f‹k
 (Ë{ 
ev_lo›_f‹k
 (
EV_DEFAULT
); }

839 #i‡
EV_FEATURE_API


840 
EV_INLINE
 
ev_lo›_cou¡
 (
EV_P
Ë{  
ev_ôî©i⁄
 (
EV_A
); }

841 
EV_INLINE
 
ev_lo›_dïth
 (
EV_P
Ë{  
ev_dïth
 (
EV_A
); }

842 
EV_INLINE
 
ev_lo›_vîify
 (
EV_P
Ë{ 
ev_vîify
 (
EV_A
); }

846 
ev_lo›
 
	tev_lo›
;

851 
EV_CPP
(})

	@libev/ev_epoll.c

66 
	~<sys/ïﬁl.h
>

68 
	#EV_EMASK_EPERM
 0x80

	)

71 
	$ïﬁl_modify
 (
EV_P_
 
fd
, 
€v
, 
√v
)

73 
ïﬁl_evít
 
ev
;

74 
ﬁdmask
;

84 i‡(!
√v
)

87 
ﬁdmask
 = 
™fds
 [
fd
].
emask
;

88 
™fds
 [
fd
].
emask
 = 
√v
;

91 
ev
.
d©a
.
u64
 = (
uöt64_t
)(
uöt32_t
)
fd


92 | ((
uöt64_t
)(
uöt32_t
)++
™fds
 [
fd
].
egí
 << 32);

93 
ev
.
evíts
 = (
√v
 & 
EV_READ
 ? 
EPOLLIN
 : 0)

94 | (
√v
 & 
EV_WRITE
 ? 
EPOLLOUT
 : 0);

96 i‡(
	`ex≥˘_åue
 (!
	`ïﬁl_˘l
 (
backíd_fd
, 
€v
 && 
ﬁdmask
 !
√v
 ? 
EPOLL_CTL_MOD
 : 
EPOLL_CTL_ADD
, 
fd
, &
ev
)))

99 i‡(
	`ex≥˘_åue
 (
î∫o
 =
ENOENT
))

102 i‡(!
√v
)

103 
dec_egí
;

105 i‡(!
	`ïﬁl_˘l
 (
backíd_fd
, 
EPOLL_CTL_ADD
, 
fd
, &
ev
))

108 i‡(
	`ex≥˘_åue
 (
î∫o
 =
EEXIST
))

112 i‡(
ﬁdmask
 =
√v
)

113 
dec_egí
;

115 i‡(!
	`ïﬁl_˘l
 (
backíd_fd
, 
EPOLL_CTL_MOD
, 
fd
, &
ev
))

118 i‡(
	`ex≥˘_åue
 (
î∫o
 =
EPERM
))

122 
™fds
 [
fd
].
emask
 = 
EV_EMASK_EPERM
;

125 i‡(!(
ﬁdmask
 & 
EV_EMASK_EPERM
))

127 
	`¨øy_√edsize
 (, 
ïﬁl_ïîms
, 
ïﬁl_ïîmmax
, 
ïﬁl_ïîm˙t
 + 1, 
EMPTY2
);

128 
ïﬁl_ïîms
 [
ïﬁl_ïîm˙t
++] = 
fd
;

134 
	`fd_kûl
 (
EV_A_
 
fd
);

136 
dec_egí
:

138 --
™fds
 [
fd
].
egí
;

139 
	}
}

142 
	$ïﬁl_pﬁl
 (
EV_P_
 
ev_t°amp
 
timeout
)

144 
i
;

145 
evít˙t
;

147 i‡(
	`ex≥˘_Ál£
 (
ïﬁl_ïîm˙t
))

148 
timeout
 = 0.;

152 
EV_RELEASE_CB
;

153 
evít˙t
 = 
	`ïﬁl_waô
 (
backíd_fd
, 
ïﬁl_evíts
, 
ïﬁl_evítmax
, 
timeout
 * 1e3);

154 
EV_ACQUIRE_CB
;

156 i‡(
	`ex≥˘_Ál£
 (
evít˙t
 < 0))

158 i‡(
î∫o
 !
EINTR
)

159 
	`ev_sy£º
 ("(libev)Époll_wait");

164 
i
 = 0; i < 
evít˙t
; ++i)

166 
ïﬁl_evít
 *
ev
 = 
ïﬁl_evíts
 + 
i
;

168 
fd
 = (
uöt32_t
)
ev
->
d©a
.
u64
;

169 
w™t
 = 
™fds
 [
fd
].
evíts
;

170 
gŸ
 = (
ev
->
evíts
 & (
EPOLLOUT
 | 
EPOLLERR
 | 
EPOLLHUP
Ë? 
EV_WRITE
 : 0)

171 | (
ev
->
evíts
 & (
EPOLLIN
 | 
EPOLLERR
 | 
EPOLLHUP
Ë? 
EV_READ
 : 0);

179 i‡(
	`ex≥˘_Ál£
 ((
uöt32_t
)
™fds
 [
fd
].
egí
 !(uöt32_t)(
ev
->
d©a
.
u64
 >> 32)))

182 
po°f‹k
 |= 2;

186 i‡(
	`ex≥˘_Ál£
 (
gŸ
 & ~
w™t
))

188 
™fds
 [
fd
].
emask
 = 
w™t
;

199 
ev
->
evíts
 = (
w™t
 & 
EV_READ
 ? 
EPOLLIN
 : 0)

200 | (
w™t
 & 
EV_WRITE
 ? 
EPOLLOUT
 : 0);

204 i‡(
	`ïﬁl_˘l
 (
backíd_fd
, 
w™t
 ? 
EPOLL_CTL_MOD
 : 
EPOLL_CTL_DEL
, 
fd
, 
ev
))

206 
po°f‹k
 |= 2;

211 
	`fd_evít
 (
EV_A_
 
fd
, 
gŸ
);

215 i‡(
	`ex≥˘_Ál£
 (
evít˙t
 =
ïﬁl_evítmax
))

217 
	`ev_‰ì
 (
ïﬁl_evíts
);

218 
ïﬁl_evítmax
 = 
	`¨øy_√xtsize
 ( (
ïﬁl_evít
),Époll_eventmax,Époll_eventmax + 1);

219 
ïﬁl_evíts
 = (
ïﬁl_evít
 *)
	`ev_mÆloc
 ( (ïﬁl_evítË* 
ïﬁl_evítmax
);

223 
i
 = 
ïﬁl_ïîm˙t
; i--; )

225 
fd
 = 
ïﬁl_ïîms
 [
i
];

226 
evíts
 = 
™fds
 [
fd
].evít†& (
EV_READ
 | 
EV_WRITE
);

228 i‡(
™fds
 [
fd
].
emask
 & 
EV_EMASK_EPERM
 && 
evíts
)

229 
	`fd_evít
 (
EV_A_
 
fd
, 
evíts
);

232 
ïﬁl_ïîms
 [
i
] =Épﬁl_ïîm†[--
ïﬁl_ïîm˙t
];

233 
™fds
 [
fd
].
emask
 = 0;

236 
	}
}

238 
ölöe_size


239 
	$ïﬁl_öô
 (
EV_P_
 
Êags
)

241 #ifde‡
EPOLL_CLOEXEC


242 
backíd_fd
 = 
	`ïﬁl_¸óã1
 (
EPOLL_CLOEXEC
);

244 i‡(
backíd_fd
 < 0 && (
î∫o
 =
EINVAL
 ||Éºnÿ=
ENOSYS
))

246 
backíd_fd
 = 
	`ïﬁl_¸óã
 (256);

248 i‡(
backíd_fd
 < 0)

251 
	`f˙é
 (
backíd_fd
, 
F_SETFD
, 
FD_CLOEXEC
);

253 
backíd_mötime
 = 1e-3;

254 
backíd_modify
 = 
ïﬁl_modify
;

255 
backíd_pﬁl
 = 
ïﬁl_pﬁl
;

257 
ïﬁl_evítmax
 = 64;

258 
ïﬁl_evíts
 = (
ïﬁl_evít
 *)
	`ev_mÆloc
 ( (ïﬁl_evítË* 
ïﬁl_evítmax
);

260  
EVBACKEND_EPOLL
;

261 
	}
}

263 
ölöe_size


264 
	$ïﬁl_de°roy
 (
EV_P
)

266 
	`ev_‰ì
 (
ïﬁl_evíts
);

267 
	`¨øy_‰ì
 (
ïﬁl_ïîm
, 
EMPTY
);

268 
	}
}

270 
ölöe_size


271 
	$ïﬁl_f‹k
 (
EV_P
)

273 
	`˛o£
 (
backíd_fd
);

275 (
backíd_fd
 = 
	`ïﬁl_¸óã
 (256)) < 0)

276 
	`ev_sy£º
 ("(libev)Époll_create");

278 
	`f˙é
 (
backíd_fd
, 
F_SETFD
, 
FD_CLOEXEC
);

280 
	`fd_ª¨m_Æl
 (
EV_A
);

281 
	}
}

	@libev/ev_kqueue.c

40 
	~<sys/ty≥s.h
>

41 
	~<sys/time.h
>

42 
	~<sys/evít.h
>

43 
	~<°rög.h
>

44 
	~<î∫o.h
>

46 
ölöe_•ìd


47 
	$kqueue_ch™ge
 (
EV_P_
 
fd
, 
fûãr
, 
Êags
, 
fÊags
)

49 ++
kqueue_ch™ge˙t
;

50 
	`¨øy_√edsize
 (
kevít
, 
kqueue_ch™ges
, 
kqueue_ch™gemax
, 
kqueue_ch™ge˙t
, 
EMPTY2
);

52 
	`EV_SET
 (&
kqueue_ch™ges
 [
kqueue_ch™ge˙t
 - 1], 
fd
, 
fûãr
, 
Êags
, 
fÊags
, 0, 0);

53 
	}
}

56 #i‚de‡
EV_ENABLE


57 
	#EV_ENABLE
 0

	)

59 #i‚de‡
NOTE_EOF


60 
	#NOTE_EOF
 0

	)

64 
	$kqueue_modify
 (
EV_P_
 
fd
, 
€v
, 
√v
)

66 i‡(
€v
 !
√v
)

68 i‡(
€v
 & 
EV_READ
)

69 
	`kqueue_ch™ge
 (
EV_A_
 
fd
, 
EVFILT_READ
 , 
EV_DELETE
, 0);

71 i‡(
€v
 & 
EV_WRITE
)

72 
	`kqueue_ch™ge
 (
EV_A_
 
fd
, 
EVFILT_WRITE
, 
EV_DELETE
, 0);

78 i‡(
√v
 & 
EV_READ
)

79 
	`kqueue_ch™ge
 (
EV_A_
 
fd
, 
EVFILT_READ
 , 
EV_ADD
 | 
EV_ENABLE
, 
NOTE_EOF
);

81 i‡(
√v
 & 
EV_WRITE
)

82 
	`kqueue_ch™ge
 (
EV_A_
 
fd
, 
EVFILT_WRITE
, 
EV_ADD
 | 
EV_ENABLE
, 
NOTE_EOF
);

83 
	}
}

86 
	$kqueue_pﬁl
 (
EV_P_
 
ev_t°amp
 
timeout
)

88 
ªs
, 
i
;

89 
time•ec
 
ts
;

92 i‡(
kqueue_ch™ge˙t
 > 
kqueue_evítmax
)

94 
	`ev_‰ì
 (
kqueue_evíts
);

95 
kqueue_evítmax
 = 
	`¨øy_√xtsize
 ( (
kevít
), kqueue_evítmax, 
kqueue_ch™ge˙t
);

96 
kqueue_evíts
 = (
kevít
 *)
	`ev_mÆloc
 ( (kevítË* 
kqueue_evítmax
);

99 
EV_RELEASE_CB
;

100 
	`EV_TS_SET
 (
ts
, 
timeout
);

101 
ªs
 = 
	`kevít
 (
backíd_fd
, 
kqueue_ch™ges
, 
kqueue_ch™ge˙t
, 
kqueue_evíts
, 
kqueue_evítmax
, &
ts
);

102 
EV_ACQUIRE_CB
;

103 
kqueue_ch™ge˙t
 = 0;

105 i‡(
	`ex≥˘_Ál£
 (
ªs
 < 0))

107 i‡(
î∫o
 !
EINTR
)

108 
	`ev_sy£º
 ("(libev) kevent");

113 
i
 = 0; i < 
ªs
; ++i)

115 
fd
 = 
kqueue_evíts
 [
i
].
idít
;

117 i‡(
	`ex≥˘_Ál£
 (
kqueue_evíts
 [
i
].
Êags
 & 
EV_ERROR
))

119 
îr
 = 
kqueue_evíts
 [
i
].
d©a
;

122 i‡(
™fds
 [
fd
].
evíts
)

124 i‡(
îr
 =
ENOENT
)

125 
	`kqueue_modify
 (
EV_A_
 
fd
, 0, 
™fds
 [fd].
evíts
);

126 i‡(
îr
 =
EBADF
)

128 i‡(
	`fd_vÆid
 (
fd
))

129 
	`kqueue_modify
 (
EV_A_
 
fd
, 0, 
™fds
 [fd].
evíts
);

131 
	`fd_kûl
 (
EV_A_
 
fd
);

134 
	`fd_kûl
 (
EV_A_
 
fd
);

138 
	`fd_evít
 (

139 
EV_A_


140 
fd
,

141 
kqueue_evíts
 [
i
].
fûãr
 =
EVFILT_READ
 ? 
EV_READ


142 : 
kqueue_evíts
 [
i
].
fûãr
 =
EVFILT_WRITE
 ? 
EV_WRITE


147 i‡(
	`ex≥˘_Ál£
 (
ªs
 =
kqueue_evítmax
))

149 
	`ev_‰ì
 (
kqueue_evíts
);

150 
kqueue_evítmax
 = 
	`¨øy_√xtsize
 ( (
kevít
), kqueue_eventmax, kqueue_eventmax + 1);

151 
kqueue_evíts
 = (
kevít
 *)
	`ev_mÆloc
 ( (kevítË* 
kqueue_evítmax
);

153 
	}
}

155 
ölöe_size


156 
	$kqueue_öô
 (
EV_P_
 
Êags
)

159 
kqueue_fd_pid
 = 
	`gëpid
 ();

160 i‡((
backíd_fd
 = 
	`kqueue
 ()) < 0)

163 
	`f˙é
 (
backíd_fd
, 
F_SETFD
, 
FD_CLOEXEC
);

165 
backíd_mötime
 = 1e-9;

166 
backíd_modify
 = 
kqueue_modify
;

167 
backíd_pﬁl
 = 
kqueue_pﬁl
;

169 
kqueue_evítmax
 = 64;

170 
kqueue_evíts
 = (
kevít
 *)
	`ev_mÆloc
 ( (kevítË* 
kqueue_evítmax
);

172 
kqueue_ch™ges
 = 0;

173 
kqueue_ch™gemax
 = 0;

174 
kqueue_ch™ge˙t
 = 0;

176  
EVBACKEND_KQUEUE
;

177 
	}
}

179 
ölöe_size


180 
	$kqueue_de°roy
 (
EV_P
)

182 
	`ev_‰ì
 (
kqueue_evíts
);

183 
	`ev_‰ì
 (
kqueue_ch™ges
);

184 
	}
}

186 
ölöe_size


187 
	$kqueue_f‹k
 (
EV_P
)

197 
pid_t
 
√wpid
 = 
	`gëpid
 ();

199 i‡(
√wpid
 =
kqueue_fd_pid
)

200 
	`˛o£
 (
backíd_fd
);

202 
kqueue_fd_pid
 = 
√wpid
;

203 (
backíd_fd
 = 
	`kqueue
 ()) < 0)

204 
	`ev_sy£º
 ("(libev) kqueue");

206 
	`f˙é
 (
backíd_fd
, 
F_SETFD
, 
FD_CLOEXEC
);

209 
	`fd_ª¨m_Æl
 (
EV_A
);

210 
	}
}

213 #unde‡
EV_ERROR


	@libev/ev_poll.c

40 
	~<pﬁl.h
>

42 
ölöe_size


43 
	$pﬁlidx_öô
 (*
ba£
, 
cou¡
)

47 
cou¡
--)

48 *
ba£
++ = -1;

49 
	}
}

52 
	$pﬁl_modify
 (
EV_P_
 
fd
, 
€v
, 
√v
)

54 
idx
;

56 i‡(
€v
 =
√v
)

59 
	`¨øy_√edsize
 (, 
pﬁlidxs
, 
pﬁlidxmax
, 
fd
 + 1, 
pﬁlidx_öô
);

61 
idx
 = 
pﬁlidxs
 [
fd
];

63 i‡(
idx
 < 0)

65 
pﬁlidxs
 [
fd
] = 
idx
 = 
pﬁl˙t
++;

66 
	`¨øy_√edsize
 (
pﬁlfd
, 
pﬁls
, 
pﬁlmax
, 
pﬁl˙t
, 
EMPTY2
);

67 
pﬁls
 [
idx
].
fd
 = fd;

70 
	`as£π
 (
pﬁls
 [
idx
].
fd
 == fd);

72 i‡(
√v
)

73 
pﬁls
 [
idx
].
evíts
 =

74 (
√v
 & 
EV_READ
 ? 
POLLIN
 : 0)

75 | (
√v
 & 
EV_WRITE
 ? 
POLLOUT
 : 0);

78 
pﬁlidxs
 [
fd
] = -1;

80 i‡(
	`ex≥˘_åue
 (
idx
 < --
pﬁl˙t
))

82 
pﬁls
 [
idx
] =Öﬁl†[
pﬁl˙t
];

83 
pﬁlidxs
 [
pﬁls
 [
idx
].
fd
] = idx;

86 
	}
}

89 
	$pﬁl_pﬁl
 (
EV_P_
 
ev_t°amp
 
timeout
)

91 
pﬁlfd
 *
p
;

92 
ªs
;

94 
EV_RELEASE_CB
;

95 
ªs
 = 
	`pﬁl
 (
pﬁls
, 
pﬁl˙t
, 
timeout
 * 1e3);

96 
EV_ACQUIRE_CB
;

98 i‡(
	`ex≥˘_Ál£
 (
ªs
 < 0))

100 i‡(
î∫o
 =
EBADF
)

101 
	`fd_ebadf
 (
EV_A
);

102 i‡(
î∫o
 =
ENOMEM
 && !
sy£º_cb
)

103 
	`fd_íomem
 (
EV_A
);

104 i‡(
î∫o
 !
EINTR
)

105 
	`ev_sy£º
 ("(libev)Öoll");

108 
p
 = 
pﬁls
; 
ªs
; ++p)

110 
	`as£π
 (("libev:Öﬁl(Ëªtu∫ed iŒegÆÑesu…, brokí BSD kî√l?", 
p
 < 
pﬁls
 + 
pﬁl˙t
));

112 i‡(
	`ex≥˘_Ál£
 (
p
->
ªvíts
))

114 --
ªs
;

116 i‡(
	`ex≥˘_Ál£
 (
p
->
ªvíts
 & 
POLLNVAL
))

117 
	`fd_kûl
 (
EV_A_
 
p
->
fd
);

119 
	`fd_evít
 (

120 
EV_A_


121 
p
->
fd
,

122 (
p
->
ªvíts
 & (
POLLOUT
 | 
POLLERR
 | 
POLLHUP
Ë? 
EV_WRITE
 : 0)

123 | (
p
->
ªvíts
 & (
POLLIN
 | 
POLLERR
 | 
POLLHUP
Ë? 
EV_READ
 : 0)

127 
	}
}

129 
ölöe_size


130 
	$pﬁl_öô
 (
EV_P_
 
Êags
)

132 
backíd_mötime
 = 1e-3;

133 
backíd_modify
 = 
pﬁl_modify
;

134 
backíd_pﬁl
 = 
pﬁl_pﬁl
;

136 
pﬁlidxs
 = 0; 
pﬁlidxmax
 = 0;

137 
pﬁls
 = 0; 
pﬁlmax
 = 0; 
pﬁl˙t
 = 0;

139  
EVBACKEND_POLL
;

140 
	}
}

142 
ölöe_size


143 
	$pﬁl_de°roy
 (
EV_P
)

145 
	`ev_‰ì
 (
pﬁlidxs
);

146 
	`ev_‰ì
 (
pﬁls
);

147 
	}
}

	@libev/ev_port.c

51 
	~<sys/ty≥s.h
>

52 
	~<sys/time.h
>

53 
	~<pﬁl.h
>

54 
	~<p‹t.h
>

55 
	~<°rög.h
>

56 
	~<î∫o.h
>

58 
ölöe_•ìd


59 
	$p‹t_assocüã_™d_check
 (
EV_P_
 
fd
, 
ev
)

62 
	`p‹t_assocüã
 (

63 
backíd_fd
, 
PORT_SOURCE_FD
, 
fd
,

64 (
ev
 & 
EV_READ
 ? 
POLLIN
 : 0)

65 | (
ev
 & 
EV_WRITE
 ? 
POLLOUT
 : 0),

70 i‡(
î∫o
 =
EBADFD
)

71 
	`fd_kûl
 (
EV_A_
 
fd
);

73 
	`ev_sy£º
 ("(libev)Öort_associate");

75 
	}
}

78 
	$p‹t_modify
 (
EV_P_
 
fd
, 
€v
, 
√v
)

83 i‡(!
√v
)

85 i‡(
€v
)

86 
	`p‹t_dissocüã
 (
backíd_fd
, 
PORT_SOURCE_FD
, 
fd
);

89 
	`p‹t_assocüã_™d_check
 (
EV_A_
 
fd
, 
√v
);

90 
	}
}

93 
	$p‹t_pﬁl
 (
EV_P_
 
ev_t°amp
 
timeout
)

95 
ªs
, 
i
;

96 
time•ec
 
ts
;

97 
uöt_t
 
ngë
 = 1;

102 
p‹t_evíts
 [0].
p‹ãv_sour˚
 = 0;

104 
EV_RELEASE_CB
;

105 
	`EV_TS_SET
 (
ts
, 
timeout
);

106 
ªs
 = 
	`p‹t_gën
 (
backíd_fd
, 
p‹t_evíts
, 
p‹t_evítmax
, &
ngë
, &
ts
);

107 
EV_ACQUIRE_CB
;

111 i‡(
ªs
 =-1 && 
î∫o
 !
ETIME
 &&Éºnÿ!
EINTR
)

112 
	`ev_sy£º
 ("(libev)Öort_getn (see http://bugs.opensolaris.org/view_bug.do?bug_id=6268715,Åry LIBEV_FLAGS=3Énv variable)");

114 
i
 = 0; i < 
ngë
; ++i)

116 i‡(
p‹t_evíts
 [
i
].
p‹ãv_sour˚
 =
PORT_SOURCE_FD
)

118 
fd
 = 
p‹t_evíts
 [
i
].
p‹ãv_obje˘
;

120 
	`fd_evít
 (

121 
EV_A_


122 
fd
,

123 (
p‹t_evíts
 [
i
].
p‹ãv_evíts
 & (
POLLOUT
 | 
POLLERR
 | 
POLLHUP
Ë? 
EV_WRITE
 : 0)

124 | (
p‹t_evíts
 [
i
].
p‹ãv_evíts
 & (
POLLIN
 | 
POLLERR
 | 
POLLHUP
Ë? 
EV_READ
 : 0)

127 
	`fd_ch™ge
 (
EV_A_
 
fd
, 
EV__IOFDSET
);

131 i‡(
	`ex≥˘_Ál£
 (
ngë
 =
p‹t_evítmax
))

133 
	`ev_‰ì
 (
p‹t_evíts
);

134 
p‹t_evítmax
 = 
	`¨øy_√xtsize
 ( (
p‹t_evít_t
),Öort_eventmax,Öort_eventmax + 1);

135 
p‹t_evíts
 = (
p‹t_evít_t
 *)
	`ev_mÆloc
 ( (p‹t_evít_tË* 
p‹t_evítmax
);

137 
	}
}

139 
ölöe_size


140 
	$p‹t_öô
 (
EV_P_
 
Êags
)

143 i‡((
backíd_fd
 = 
	`p‹t_¸óã
 ()) < 0)

146 
	`as£π
 (("libev: PORT_SOURCE_FD mu°ÇŸ bêzîo", 
PORT_SOURCE_FD
));

148 
	`f˙é
 (
backíd_fd
, 
F_SETFD
, 
FD_CLOEXEC
);

156 
backíd_mötime
 = 1e-3;

157 
backíd_modify
 = 
p‹t_modify
;

158 
backíd_pﬁl
 = 
p‹t_pﬁl
;

160 
p‹t_evítmax
 = 64;

161 
p‹t_evíts
 = (
p‹t_evít_t
 *)
	`ev_mÆloc
 ( (p‹t_evít_tË* 
p‹t_evítmax
);

163  
EVBACKEND_PORT
;

164 
	}
}

166 
ölöe_size


167 
	$p‹t_de°roy
 (
EV_P
)

169 
	`ev_‰ì
 (
p‹t_evíts
);

170 
	}
}

172 
ölöe_size


173 
	$p‹t_f‹k
 (
EV_P
)

175 
	`˛o£
 (
backíd_fd
);

177 (
backíd_fd
 = 
	`p‹t_¸óã
 ()) < 0)

178 
	`ev_sy£º
 ("(libev)Öort");

180 
	`f˙é
 (
backíd_fd
, 
F_SETFD
, 
FD_CLOEXEC
);

183 
	`fd_ª¨m_Æl
 (
EV_A
);

184 
	}
}

	@libev/ev_select.c

40 #i‚de‡
_WIN32


42 
	~<öây≥s.h
>

43 #i‚de‡
__hpux


45 
	~<sys/£À˘.h
>

49 #i‚de‡
EV_SELECT_USE_FD_SET


50 #ifde‡
NFDBITS


51 
	#EV_SELECT_USE_FD_SET
 0

	)

53 
	#EV_SELECT_USE_FD_SET
 1

	)

57 #i‡
EV_SELECT_IS_WINSOCKET


58 #unde‡
EV_SELECT_USE_FD_SET


59 
	#EV_SELECT_USE_FD_SET
 1

	)

60 #unde‡
NFDBITS


61 
	#NFDBITS
 0

	)

64 #i‡!
EV_SELECT_USE_FD_SET


65 
	#NFDBYTES
 (
NFDBITS
 / 8)

	)

68 
	~<°rög.h
>

71 
	$£À˘_modify
 (
EV_P_
 
fd
, 
€v
, 
√v
)

73 i‡(
€v
 =
√v
)

77 #i‡
EV_SELECT_USE_FD_SET


79 #i‡
EV_SELECT_IS_WINSOCKET


80 
SOCKET
 
h™dÀ
 = 
™fds
 [
fd
].handle;

82 
h™dÀ
 = 
fd
;

85 
	`as£π
 (("libev: fd >FD_SETSIZEÖas£dÅÿfd_£t-ba£d sñe˘ backíd", 
fd
 < 
FD_SETSIZE
));

90 #i‡
EV_SELECT_IS_WINSOCKET


91 i‡((
€v
 ^ 
√v
Ë& 
EV_READ
)

93 i‡(
√v
 & 
EV_READ
)

94 
	`FD_SET
 (
h™dÀ
, (
fd_£t
 *)
vec_ri
);

96 
	`FD_CLR
 (
h™dÀ
, (
fd_£t
 *)
vec_ri
);

98 #i‡
EV_SELECT_IS_WINSOCKET


99 i‡((
€v
 ^ 
√v
Ë& 
EV_WRITE
)

101 i‡(
√v
 & 
EV_WRITE
)

102 
	`FD_SET
 (
h™dÀ
, (
fd_£t
 *)
vec_wi
);

104 
	`FD_CLR
 (
h™dÀ
, (
fd_£t
 *)
vec_wi
);

108 
w‹d
 = 
fd
 / 
NFDBITS
;

109 
fd_mask
 
mask
 = 1UL << (
fd
 % 
NFDBITS
);

111 i‡(
	`ex≥˘_Ál£
 (
vec_max
 <
w‹d
))

113 
√w_max
 = 
w‹d
 + 1;

115 
vec_ri
 = 
	`ev_ªÆloc
 (vec_ri, 
√w_max
 * 
NFDBYTES
);

116 
vec_ro
 = 
	`ev_ªÆloc
 (vec_ro, 
√w_max
 * 
NFDBYTES
);

117 
vec_wi
 = 
	`ev_ªÆloc
 (vec_wi, 
√w_max
 * 
NFDBYTES
);

118 
vec_wo
 = 
	`ev_ªÆloc
 (vec_wo, 
√w_max
 * 
NFDBYTES
);

119 #ifde‡
_WIN32


120 
vec_eo
 = 
	`ev_ªÆloc
 (vec_eo, 
√w_max
 * 
NFDBYTES
);

123 ; 
vec_max
 < 
√w_max
; ++vec_max)

124 ((
fd_mask
 *)
vec_ri
Ë[
vec_max
] =

125 ((
fd_mask
 *)
vec_wi
Ë[
vec_max
] = 0;

128 ((
fd_mask
 *)
vec_ri
Ë[
w‹d
] |
mask
;

129 i‡(!(
√v
 & 
EV_READ
))

130 ((
fd_mask
 *)
vec_ri
Ë[
w‹d
] &~
mask
;

132 ((
fd_mask
 *)
vec_wi
Ë[
w‹d
] |
mask
;

133 i‡(!(
√v
 & 
EV_WRITE
))

134 ((
fd_mask
 *)
vec_wi
Ë[
w‹d
] &~
mask
;

137 
	}
}

140 
	$£À˘_pﬁl
 (
EV_P_
 
ev_t°amp
 
timeout
)

142 
timevÆ
 
tv
;

143 
ªs
;

144 
fd_£tsize
;

146 
EV_RELEASE_CB
;

147 
	`EV_TV_SET
 (
tv
, 
timeout
);

149 #i‡
EV_SELECT_USE_FD_SET


150 
fd_£tsize
 =  (
fd_£t
);

152 
fd_£tsize
 = 
vec_max
 * 
NFDBYTES
;

155 
	`mem˝y
 (
vec_ro
, 
vec_ri
, 
fd_£tsize
);

156 
	`mem˝y
 (
vec_wo
, 
vec_wi
, 
fd_£tsize
);

158 #ifde‡
_WIN32


164 
	`mem˝y
 (
vec_eo
, 
vec_wi
, 
fd_£tsize
);

165 
ªs
 = 
	`£À˘
 (
vec_max
 * 
NFDBITS
, (
fd_£t
 *)
vec_ro
, (fd_£à*)
vec_wo
, (fd_£à*)
vec_eo
, &
tv
);

166 #ñi‡
EV_SELECT_USE_FD_SET


167 
fd_£tsize
 = 
™fdmax
 < 
FD_SETSIZE
 ?ánfdmax : FD_SETSIZE;

168 
ªs
 = 
	`£À˘
 (
fd_£tsize
, (
fd_£t
 *)
vec_ro
, (fd_£à*)
vec_wo
, 0, &
tv
);

170 
ªs
 = 
	`£À˘
 (
vec_max
 * 
NFDBITS
, (
fd_£t
 *)
vec_ro
, (fd_£à*)
vec_wo
, 0, &
tv
);

172 
EV_ACQUIRE_CB
;

174 i‡(
	`ex≥˘_Ál£
 (
ªs
 < 0))

176 #i‡
EV_SELECT_IS_WINSOCKET


177 
î∫o
 = 
	`WSAGëLa°Eº‹
 ();

179 #ifde‡
WSABASEERR


181 i‡(
î∫o
 >
WSABASEERR
 &&Érrno < WSABASEERR + 1000)

182 i‡(
î∫o
 =
WSAENOTSOCK
)

183 
î∫o
 = 
EBADF
;

185 
î∫o
 -
WSABASEERR
;

188 #ifde‡
_WIN32


196 i‡(
î∫o
 =
EINVAL
)

198 i‡(
timeout
)

200 
ms
 = 
timeout
 * 1e3;

201 
	`SÀï
 (
ms
 ? ms : 1);

208 i‡(
î∫o
 =
EBADF
)

209 
	`fd_ebadf
 (
EV_A
);

210 i‡(
î∫o
 =
ENOMEM
 && !
sy£º_cb
)

211 
	`fd_íomem
 (
EV_A
);

212 i‡(
î∫o
 !
EINTR
)

213 
	`ev_sy£º
 ("(libev) select");

218 #i‡
EV_SELECT_USE_FD_SET


221 
fd
;

223 
fd
 = 0; fd < 
™fdmax
; ++fd)

224 i‡(
™fds
 [
fd
].
evíts
)

226 
evíts
 = 0;

227 #i‡
EV_SELECT_IS_WINSOCKET


228 
SOCKET
 
h™dÀ
 = 
™fds
 [
fd
].handle;

230 
h™dÀ
 = 
fd
;

233 i‡(
	`FD_ISSET
 (
h™dÀ
, (
fd_£t
 *)
vec_ro
)Ë
evíts
 |
EV_READ
;

234 i‡(
	`FD_ISSET
 (
h™dÀ
, (
fd_£t
 *)
vec_wo
)Ë
evíts
 |
EV_WRITE
;

235 #ifde‡
_WIN32


236 i‡(
	`FD_ISSET
 (
h™dÀ
, (
fd_£t
 *)
vec_eo
)Ë
evíts
 |
EV_WRITE
;

239 i‡(
	`ex≥˘_åue
 (
evíts
))

240 
	`fd_evít
 (
EV_A_
 
fd
, 
evíts
);

247 
w‹d
, 
bô
;

248 
w‹d
 = 
vec_max
; word--; )

250 
fd_mask
 
w‹d_r
 = ((fd_mask *)
vec_ro
Ë[
w‹d
];

251 
fd_mask
 
w‹d_w
 = ((fd_mask *)
vec_wo
Ë[
w‹d
];

252 #ifde‡
_WIN32


253 
w‹d_w
 |((
fd_mask
 *)
vec_eo
Ë[
w‹d
];

256 i‡(
w‹d_r
 || 
w‹d_w
)

257 
bô
 = 
NFDBITS
; bit--; )

259 
fd_mask
 
mask
 = 1UL << 
bô
;

260 
evíts
 = 0;

262 
evíts
 |
w‹d_r
 & 
mask
 ? 
EV_READ
 : 0;

263 
evíts
 |
w‹d_w
 & 
mask
 ? 
EV_WRITE
 : 0;

265 i‡(
	`ex≥˘_åue
 (
evíts
))

266 
	`fd_evít
 (
EV_A_
 
w‹d
 * 
NFDBITS
 + 
bô
, 
evíts
);

272 
	}
}

274 
ölöe_size


275 
	$£À˘_öô
 (
EV_P_
 
Êags
)

277 
backíd_mötime
 = 1e-6;

278 
backíd_modify
 = 
£À˘_modify
;

279 
backíd_pﬁl
 = 
£À˘_pﬁl
;

281 #i‡
EV_SELECT_USE_FD_SET


282 
vec_ri
 = 
	`ev_mÆloc
 ( (
fd_£t
)); 
	`FD_ZERO
 ((fd_set *)vec_ri);

283 
vec_ro
 = 
	`ev_mÆloc
 ( (
fd_£t
));

284 
vec_wi
 = 
	`ev_mÆloc
 ( (
fd_£t
)); 
	`FD_ZERO
 ((fd_set *)vec_wi);

285 
vec_wo
 = 
	`ev_mÆloc
 ( (
fd_£t
));

286 #ifde‡
_WIN32


287 
vec_eo
 = 
	`ev_mÆloc
 ( (
fd_£t
));

290 
vec_max
 = 0;

291 
vec_ri
 = 0;

292 
vec_ro
 = 0;

293 
vec_wi
 = 0;

294 
vec_wo
 = 0;

295 #ifde‡
_WIN32


296 
vec_eo
 = 0;

300  
EVBACKEND_SELECT
;

301 
	}
}

303 
ölöe_size


304 
	$£À˘_de°roy
 (
EV_P
)

306 
	`ev_‰ì
 (
vec_ri
);

307 
	`ev_‰ì
 (
vec_ro
);

308 
	`ev_‰ì
 (
vec_wi
);

309 
	`ev_‰ì
 (
vec_wo
);

310 #ifde‡
_WIN32


311 
	`ev_‰ì
 (
vec_eo
);

313 
	}
}

	@libev/ev_vars.h

40 
	#VARx
(
ty≥
,
«me
Ë
	`VAR
“ame,Åy≥Çame)

	)

42 
	$VARx
(
ev_t°amp
, 
now_Êo‹
)

43 
	$VARx
(
ev_t°amp
, 
mn_now
)

44 
	$VARx
(
ev_t°amp
, 
πmn_diff
)

47 
	$VARx
(
W
 *, 
r„eds
)

48 
	$VARx
(, 
r„edmax
)

49 
	$VARx
(, 
r„ed˙t
)

51 
	$VAR
 (
≥ndögs
, 
ANPENDING
 *≥ndög†[
NUMPRI
])

52 
	$VAR
 (
≥ndögmax
, ≥ndögmax [
NUMPRI
])

53 
	$VAR
 (
≥ndög˙t
, ≥ndög˙à[
NUMPRI
])

54 
	$VARx
(, 
≥ndög¥i
)

55 
	$VARx
(
ev_¥ï¨e
, 
≥ndög_w
)

57 
	$VARx
(
ev_t°amp
, 
io_blocktime
)

58 
	$VARx
(
ev_t°amp
, 
timeout_blocktime
)

60 
	$VARx
(, 
backíd
)

61 
	$VARx
(, 
a˘ive˙t
)

62 
	$VARx
(
EV_ATOMIC_T
, 
lo›_d⁄e
)

64 
	$VARx
(, 
backíd_fd
)

65 
	$VARx
(
ev_t°amp
, 
backíd_mötime
)

66 
	$VAR
 (
backíd_modify
, (*backíd_modify)(
EV_P_
 
fd
, 
€v
, 
√v
))

67 
	$VAR
 (
backíd_pﬁl
 , (*backíd_pﬁl)(
EV_P_
 
ev_t°amp
 
timeout
))

69 
	$VARx
(
ANFD
 *, 
™fds
)

70 
	$VARx
(, 
™fdmax
)

72 
	$VAR
 (
evpùe
, evpipe [2])

73 
	$VARx
(
ev_io
, 
pùe_w
)

74 
	$VARx
(
EV_ATOMIC_T
, 
pùe_wrôe_w™ãd
)

75 
	$VARx
(
EV_ATOMIC_T
, 
pùe_wrôe_skù≥d
)

77 #i‡!
	`deföed
(
_WIN32
Ë|| 
EV_GENWRAP


78 
	$VARx
(
pid_t
, 
cuΩid
)

81 
	$VARx
(, 
po°f‹k
)

83 #i‡
EV_USE_SELECT
 || 
EV_GENWRAP


84 
	$VARx
(*, 
vec_ri
)

85 
	$VARx
(*, 
vec_ro
)

86 
	$VARx
(*, 
vec_wi
)

87 
	$VARx
(*, 
vec_wo
)

88 #i‡
	`deföed
(
_WIN32
Ë|| 
EV_GENWRAP


89 
	$VARx
(*, 
vec_eo
)

91 
	$VARx
(, 
vec_max
)

94 #i‡
EV_USE_POLL
 || 
EV_GENWRAP


95 
	$VARx
(
pﬁlfd
 *, 
pﬁls
)

96 
	$VARx
(, 
pﬁlmax
)

97 
	$VARx
(, 
pﬁl˙t
)

98 
	$VARx
(*, 
pﬁlidxs
)

99 
	$VARx
(, 
pﬁlidxmax
)

102 #i‡
EV_USE_EPOLL
 || 
EV_GENWRAP


103 
	$VARx
(
ïﬁl_evít
 *, 
ïﬁl_evíts
)

104 
	$VARx
(, 
ïﬁl_evítmax
)

105 
	$VARx
(*, 
ïﬁl_ïîms
)

106 
	$VARx
(, 
ïﬁl_ïîm˙t
)

107 
	$VARx
(, 
ïﬁl_ïîmmax
)

110 #i‡
EV_USE_KQUEUE
 || 
EV_GENWRAP


111 
	$VARx
(
pid_t
, 
kqueue_fd_pid
)

112 
	$VARx
(
kevít
 *, 
kqueue_ch™ges
)

113 
	$VARx
(, 
kqueue_ch™gemax
)

114 
	$VARx
(, 
kqueue_ch™ge˙t
)

115 
	$VARx
(
kevít
 *, 
kqueue_evíts
)

116 
	$VARx
(, 
kqueue_evítmax
)

119 #i‡
EV_USE_PORT
 || 
EV_GENWRAP


120 
	$VARx
(
p‹t_evít
 *, 
p‹t_evíts
)

121 
	$VARx
(, 
p‹t_evítmax
)

124 #i‡
EV_USE_IOCP
 || 
EV_GENWRAP


125 
	$VARx
(
HANDLE
, 
io˝
)

128 
	$VARx
(*, 
fdch™ges
)

129 
	$VARx
(, 
fdch™gemax
)

130 
	$VARx
(, 
fdch™ge˙t
)

132 
	$VARx
(
ANHE
 *, 
timîs
)

133 
	$VARx
(, 
timîmax
)

134 
	$VARx
(, 
timî˙t
)

136 #i‡
EV_PERIODIC_ENABLE
 || 
EV_GENWRAP


137 
	$VARx
(
ANHE
 *, 
≥riodics
)

138 
	$VARx
(, 
≥riodicmax
)

139 
	$VARx
(, 
≥riodic˙t
)

142 #i‡
EV_IDLE_ENABLE
 || 
EV_GENWRAP


143 
	$VAR
 (
idÀs
, 
ev_idÀ
 **idÀ†[
NUMPRI
])

144 
	$VAR
 (
idÀmax
, idÀmax [
NUMPRI
])

145 
	$VAR
 (
idÀ˙t
, idÀ˙à[
NUMPRI
])

147 
	$VARx
(, 
idÀÆl
)

149 
	$VARx
(
ev_¥ï¨e
 **, 
¥ï¨es
)

150 
	$VARx
(, 
¥ï¨emax
)

151 
	$VARx
(, 
¥ï¨e˙t
)

153 
	$VARx
(
ev_check
 **, 
checks
)

154 
	$VARx
(, 
checkmax
)

155 
	$VARx
(, 
check˙t
)

157 #i‡
EV_FORK_ENABLE
 || 
EV_GENWRAP


158 
	$VARx
(
ev_f‹k
 **, 
f‹ks
)

159 
	$VARx
(, 
f‹kmax
)

160 
	$VARx
(, 
f‹k˙t
)

163 #i‡
EV_CLEANUP_ENABLE
 || 
EV_GENWRAP


164 
	$VARx
(
ev_˛ónup
 **, 
˛ónups
)

165 
	$VARx
(, 
˛ónupmax
)

166 
	$VARx
(, 
˛ónup˙t
)

169 #i‡
EV_ASYNC_ENABLE
 || 
EV_GENWRAP


170 
	$VARx
(
EV_ATOMIC_T
, 
async_≥ndög
)

171 
	$VARx
(
ev_async
 **, 
asyncs
)

172 
	$VARx
(, 
asyncmax
)

173 
	$VARx
(, 
async˙t
)

176 #i‡
EV_USE_INOTIFY
 || 
EV_GENWRAP


177 
	$VARx
(, 
fs_fd
)

178 
	$VARx
(
ev_io
, 
fs_w
)

179 
	$VARx
(, 
fs_2625
)

180 
	$VAR
 (
fs_hash
, 
ANFS
 fs_hash [
EV_INOTIFY_HASHSIZE
])

183 
	$VARx
(
EV_ATOMIC_T
, 
sig_≥ndög
)

184 #i‡
EV_USE_SIGNALFD
 || 
EV_GENWRAP


185 
	$VARx
(, 
sigfd
)

186 
	$VARx
(
ev_io
, 
sigfd_w
)

187 
	$VARx
(
sig£t_t
, 
sigfd_£t
)

190 
	$VARx
(, 
‹igÊags
)

192 #i‡
EV_FEATURE_API
 || 
EV_GENWRAP


193 
	$VARx
(, 
lo›_cou¡
)

194 
	$VARx
(, 
lo›_dïth
)

196 
	$VARx
(*, 
u£rd©a
)

198 
	$VAR
 (
ªÀa£_cb
, (*ªÀa£_cb)(
EV_P
Ë
EV_THROW
)

199 
	$VAR
 (
acquúe_cb
, (*acquúe_cb)(
EV_P
Ë
EV_THROW
)

200 
	$VAR
 (
övoke_cb
 , 
ev_lo›_ˇŒback
 invoke_cb)

203 #unde‡
VARx


	@libev/ev_win32.c

40 #ifde‡
_WIN32


46 vﬁ©ûê
	gSIGFPE_REQ
 = 0.0f;

48 
SOCKET


49 
	$ev_t˝_sockë
 ()

51 #i‡
EV_USE_WSASOCKET


52  
	`WSASockë
 (
AF_INET
, 
SOCK_STREAM
, 0, 0, 0, 0);

54  
	`sockë
 (
AF_INET
, 
SOCK_STREAM
, 0);

56 
	}
}

60 
	$ev_pùe
 (
fûedes
 [2])

62 
sockaddr_ö
 
addr
 = { 0 };

63 
addr_size
 =  (
addr
);

64 
sockaddr_ö
 
adr2
;

65 
adr2_size
 =  (
adr2
);

66 
SOCKET
 
li°íî
;

67 
SOCKET
 
sock
 [2] = { -1, -1 };

69 i‡((
li°íî
 = 
	`ev_t˝_sockë
 ()Ë=
INVALID_SOCKET
)

72 
addr
.
sö_Ámûy
 = 
AF_INET
;

73 
addr
.
sö_addr
.
s_addr
 = 
	`ht⁄l
 (
INADDR_LOOPBACK
);

74 
addr
.
sö_p‹t
 = 0;

76 i‡(
	`böd
 (
li°íî
, (
sockaddr
 *)&
addr
, 
addr_size
))

77 
Áû
;

79 i‡(
	`gësock«me
 (
li°íî
, (
sockaddr
 *)&
addr
, &
addr_size
))

80 
Áû
;

82 i‡(
	`li°í
 (
li°íî
, 1))

83 
Áû
;

85 i‡((
sock
 [0] = 
	`ev_t˝_sockë
 ()Ë=
INVALID_SOCKET
)

86 
Áû
;

88 i‡(
	`c⁄√˘
 (
sock
 [0], (
sockaddr
 *)&
addr
, 
addr_size
))

89 
Áû
;

93 i‡((
sock
 [1] = 
	`ac˚±
 (
li°íî
, 0, 0)) < 0)

94 
Áû
;

108 i‡(
	`gë≥î«me
 (
sock
 [0], (
sockaddr
 *)&
addr
, &
addr_size
))

109 
Áû
;

111 i‡(
	`gësock«me
 (
sock
 [1], (
sockaddr
 *)&
adr2
, &
adr2_size
))

112 
Áû
;

114 
î∫o
 = 
WSAEINVAL
;

115 i‡(
addr_size
 !
adr2_size


116 || 
addr
.
sö_addr
.
s_addr
 !
adr2
.sin_addr.s_addr

117 || 
addr
.
sö_p‹t
 !
adr2
.sin_port)

118 
Áû
;

120 
	`˛o£sockë
 (
li°íî
);

122 #i‡
EV_SELECT_IS_WINSOCKET


123 
fûedes
 [0] = 
	`EV_WIN32_HANDLE_TO_FD
 (
sock
 [0]);

124 
fûedes
 [1] = 
	`EV_WIN32_HANDLE_TO_FD
 (
sock
 [1]);

128 
fûedes
 [0] = 
sock
 [0];

129 
fûedes
 [1] = 
sock
 [1];

134 
Áû
:

135 
	`˛o£sockë
 (
li°íî
);

137 i‡(
sock
 [0] !
INVALID_SOCKET
Ë
	`˛o£sockë
 (sock [0]);

138 i‡(
sock
 [1] !
INVALID_SOCKET
Ë
	`˛o£sockë
 (sock [1]);

141 
	}
}

143 #unde‡
pùe


144 
	#pùe
(
fûedes
Ë
	`ev_pùe
 (fûedes)

	)

146 
	#EV_HAVE_EV_TIME
 1

	)

147 
ev_t°amp


148 
	$ev_time
 ()

150 
FILETIME
 
·
;

151 
ULARGE_INTEGER
 
ui
;

153 
	`GëSy°emTimeAsFûeTime
 (&
·
);

154 
ui
.
u
.
LowP¨t
 = 
·
.
dwLowD©eTime
;

155 
ui
.
u
.
HighP¨t
 = 
·
.
dwHighD©eTime
;

158  (
LONGLONG
)(
ui
.
QuadP¨t
 - 116444736000000000) * 1e-7;

159 
	}
}

	@libev/ev_wrap.h

2 #i‚de‡
EV_WRAP_H


3 
	#EV_WRAP_H


	)

4 
	#acquúe_cb
 ((
lo›
)->
acquúe_cb
)

	)

5 
	#a˘ive˙t
 ((
lo›
)->
a˘ive˙t
)

	)

6 
	#™fdmax
 ((
lo›
)->
™fdmax
)

	)

7 
	#™fds
 ((
lo›
)->
™fds
)

	)

8 
	#async_≥ndög
 ((
lo›
)->
async_≥ndög
)

	)

9 
	#async˙t
 ((
lo›
)->
async˙t
)

	)

10 
	#asyncmax
 ((
lo›
)->
asyncmax
)

	)

11 
	#asyncs
 ((
lo›
)->
asyncs
)

	)

12 
	#backíd
 ((
lo›
)->
backíd
)

	)

13 
	#backíd_fd
 ((
lo›
)->
backíd_fd
)

	)

14 
	#backíd_mötime
 ((
lo›
)->
backíd_mötime
)

	)

15 
	#backíd_modify
 ((
lo›
)->
backíd_modify
)

	)

16 
	#backíd_pﬁl
 ((
lo›
)->
backíd_pﬁl
)

	)

17 
	#check˙t
 ((
lo›
)->
check˙t
)

	)

18 
	#checkmax
 ((
lo›
)->
checkmax
)

	)

19 
	#checks
 ((
lo›
)->
checks
)

	)

20 
	#˛ónup˙t
 ((
lo›
)->
˛ónup˙t
)

	)

21 
	#˛ónupmax
 ((
lo›
)->
˛ónupmax
)

	)

22 
	#˛ónups
 ((
lo›
)->
˛ónups
)

	)

23 
	#cuΩid
 ((
lo›
)->
cuΩid
)

	)

24 
	#ïﬁl_ïîm˙t
 ((
lo›
)->
ïﬁl_ïîm˙t
)

	)

25 
	#ïﬁl_ïîmmax
 ((
lo›
)->
ïﬁl_ïîmmax
)

	)

26 
	#ïﬁl_ïîms
 ((
lo›
)->
ïﬁl_ïîms
)

	)

27 
	#ïﬁl_evítmax
 ((
lo›
)->
ïﬁl_evítmax
)

	)

28 
	#ïﬁl_evíts
 ((
lo›
)->
ïﬁl_evíts
)

	)

29 
	#evpùe
 ((
lo›
)->
evpùe
)

	)

30 
	#fdch™ge˙t
 ((
lo›
)->
fdch™ge˙t
)

	)

31 
	#fdch™gemax
 ((
lo›
)->
fdch™gemax
)

	)

32 
	#fdch™ges
 ((
lo›
)->
fdch™ges
)

	)

33 
	#f‹k˙t
 ((
lo›
)->
f‹k˙t
)

	)

34 
	#f‹kmax
 ((
lo›
)->
f‹kmax
)

	)

35 
	#f‹ks
 ((
lo›
)->
f‹ks
)

	)

36 
	#fs_2625
 ((
lo›
)->
fs_2625
)

	)

37 
	#fs_fd
 ((
lo›
)->
fs_fd
)

	)

38 
	#fs_hash
 ((
lo›
)->
fs_hash
)

	)

39 
	#fs_w
 ((
lo›
)->
fs_w
)

	)

40 
	#idÀÆl
 ((
lo›
)->
idÀÆl
)

	)

41 
	#idÀ˙t
 ((
lo›
)->
idÀ˙t
)

	)

42 
	#idÀmax
 ((
lo›
)->
idÀmax
)

	)

43 
	#idÀs
 ((
lo›
)->
idÀs
)

	)

44 
	#övoke_cb
 ((
lo›
)->
övoke_cb
)

	)

45 
	#io_blocktime
 ((
lo›
)->
io_blocktime
)

	)

46 
	#io˝
 ((
lo›
)->
io˝
)

	)

47 
	#kqueue_ch™ge˙t
 ((
lo›
)->
kqueue_ch™ge˙t
)

	)

48 
	#kqueue_ch™gemax
 ((
lo›
)->
kqueue_ch™gemax
)

	)

49 
	#kqueue_ch™ges
 ((
lo›
)->
kqueue_ch™ges
)

	)

50 
	#kqueue_evítmax
 ((
lo›
)->
kqueue_evítmax
)

	)

51 
	#kqueue_evíts
 ((
lo›
)->
kqueue_evíts
)

	)

52 
	#kqueue_fd_pid
 ((
lo›
)->
kqueue_fd_pid
)

	)

53 
	#lo›_cou¡
 ((
lo›
)->
lo›_cou¡
)

	)

54 
	#lo›_dïth
 ((
lo›
)->
lo›_dïth
)

	)

55 
	#lo›_d⁄e
 ((
lo›
)->
lo›_d⁄e
)

	)

56 
	#mn_now
 ((
lo›
)->
mn_now
)

	)

57 
	#now_Êo‹
 ((
lo›
)->
now_Êo‹
)

	)

58 
	#‹igÊags
 ((
lo›
)->
‹igÊags
)

	)

59 
	#≥ndög_w
 ((
lo›
)->
≥ndög_w
)

	)

60 
	#≥ndög˙t
 ((
lo›
)->
≥ndög˙t
)

	)

61 
	#≥ndögmax
 ((
lo›
)->
≥ndögmax
)

	)

62 
	#≥ndög¥i
 ((
lo›
)->
≥ndög¥i
)

	)

63 
	#≥ndögs
 ((
lo›
)->
≥ndögs
)

	)

64 
	#≥riodic˙t
 ((
lo›
)->
≥riodic˙t
)

	)

65 
	#≥riodicmax
 ((
lo›
)->
≥riodicmax
)

	)

66 
	#≥riodics
 ((
lo›
)->
≥riodics
)

	)

67 
	#pùe_w
 ((
lo›
)->
pùe_w
)

	)

68 
	#pùe_wrôe_skù≥d
 ((
lo›
)->
pùe_wrôe_skù≥d
)

	)

69 
	#pùe_wrôe_w™ãd
 ((
lo›
)->
pùe_wrôe_w™ãd
)

	)

70 
	#pﬁl˙t
 ((
lo›
)->
pﬁl˙t
)

	)

71 
	#pﬁlidxmax
 ((
lo›
)->
pﬁlidxmax
)

	)

72 
	#pﬁlidxs
 ((
lo›
)->
pﬁlidxs
)

	)

73 
	#pﬁlmax
 ((
lo›
)->
pﬁlmax
)

	)

74 
	#pﬁls
 ((
lo›
)->
pﬁls
)

	)

75 
	#p‹t_evítmax
 ((
lo›
)->
p‹t_evítmax
)

	)

76 
	#p‹t_evíts
 ((
lo›
)->
p‹t_evíts
)

	)

77 
	#po°f‹k
 ((
lo›
)->
po°f‹k
)

	)

78 
	#¥ï¨e˙t
 ((
lo›
)->
¥ï¨e˙t
)

	)

79 
	#¥ï¨emax
 ((
lo›
)->
¥ï¨emax
)

	)

80 
	#¥ï¨es
 ((
lo›
)->
¥ï¨es
)

	)

81 
	#ªÀa£_cb
 ((
lo›
)->
ªÀa£_cb
)

	)

82 
	#r„ed˙t
 ((
lo›
)->
r„ed˙t
)

	)

83 
	#r„edmax
 ((
lo›
)->
r„edmax
)

	)

84 
	#r„eds
 ((
lo›
)->
r„eds
)

	)

85 
	#πmn_diff
 ((
lo›
)->
πmn_diff
)

	)

86 
	#sig_≥ndög
 ((
lo›
)->
sig_≥ndög
)

	)

87 
	#sigfd
 ((
lo›
)->
sigfd
)

	)

88 
	#sigfd_£t
 ((
lo›
)->
sigfd_£t
)

	)

89 
	#sigfd_w
 ((
lo›
)->
sigfd_w
)

	)

90 
	#timeout_blocktime
 ((
lo›
)->
timeout_blocktime
)

	)

91 
	#timî˙t
 ((
lo›
)->
timî˙t
)

	)

92 
	#timîmax
 ((
lo›
)->
timîmax
)

	)

93 
	#timîs
 ((
lo›
)->
timîs
)

	)

94 
	#u£rd©a
 ((
lo›
)->
u£rd©a
)

	)

95 
	#vec_eo
 ((
lo›
)->
vec_eo
)

	)

96 
	#vec_max
 ((
lo›
)->
vec_max
)

	)

97 
	#vec_ri
 ((
lo›
)->
vec_ri
)

	)

98 
	#vec_ro
 ((
lo›
)->
vec_ro
)

	)

99 
	#vec_wi
 ((
lo›
)->
vec_wi
)

	)

100 
	#vec_wo
 ((
lo›
)->
vec_wo
)

	)

102 #unde‡
EV_WRAP_H


103 #unde‡
acquúe_cb


104 #unde‡
a˘ive˙t


105 #unde‡
™fdmax


106 #unde‡
™fds


107 #unde‡
async_≥ndög


108 #unde‡
async˙t


109 #unde‡
asyncmax


110 #unde‡
asyncs


111 #unde‡
backíd


112 #unde‡
backíd_fd


113 #unde‡
backíd_mötime


114 #unde‡
backíd_modify


115 #unde‡
backíd_pﬁl


116 #unde‡
check˙t


117 #unde‡
checkmax


118 #unde‡
checks


119 #unde‡
˛ónup˙t


120 #unde‡
˛ónupmax


121 #unde‡
˛ónups


122 #unde‡
cuΩid


123 #unde‡
ïﬁl_ïîm˙t


124 #unde‡
ïﬁl_ïîmmax


125 #unde‡
ïﬁl_ïîms


126 #unde‡
ïﬁl_evítmax


127 #unde‡
ïﬁl_evíts


128 #unde‡
evpùe


129 #unde‡
fdch™ge˙t


130 #unde‡
fdch™gemax


131 #unde‡
fdch™ges


132 #unde‡
f‹k˙t


133 #unde‡
f‹kmax


134 #unde‡
f‹ks


135 #unde‡
fs_2625


136 #unde‡
fs_fd


137 #unde‡
fs_hash


138 #unde‡
fs_w


139 #unde‡
idÀÆl


140 #unde‡
idÀ˙t


141 #unde‡
idÀmax


142 #unde‡
idÀs


143 #unde‡
övoke_cb


144 #unde‡
io_blocktime


145 #unde‡
io˝


146 #unde‡
kqueue_ch™ge˙t


147 #unde‡
kqueue_ch™gemax


148 #unde‡
kqueue_ch™ges


149 #unde‡
kqueue_evítmax


150 #unde‡
kqueue_evíts


151 #unde‡
kqueue_fd_pid


152 #unde‡
lo›_cou¡


153 #unde‡
lo›_dïth


154 #unde‡
lo›_d⁄e


155 #unde‡
mn_now


156 #unde‡
now_Êo‹


157 #unde‡
‹igÊags


158 #unde‡
≥ndög_w


159 #unde‡
≥ndög˙t


160 #unde‡
≥ndögmax


161 #unde‡
≥ndög¥i


162 #unde‡
≥ndögs


163 #unde‡
≥riodic˙t


164 #unde‡
≥riodicmax


165 #unde‡
≥riodics


166 #unde‡
pùe_w


167 #unde‡
pùe_wrôe_skù≥d


168 #unde‡
pùe_wrôe_w™ãd


169 #unde‡
pﬁl˙t


170 #unde‡
pﬁlidxmax


171 #unde‡
pﬁlidxs


172 #unde‡
pﬁlmax


173 #unde‡
pﬁls


174 #unde‡
p‹t_evítmax


175 #unde‡
p‹t_evíts


176 #unde‡
po°f‹k


177 #unde‡
¥ï¨e˙t


178 #unde‡
¥ï¨emax


179 #unde‡
¥ï¨es


180 #unde‡
ªÀa£_cb


181 #unde‡
r„ed˙t


182 #unde‡
r„edmax


183 #unde‡
r„eds


184 #unde‡
πmn_diff


185 #unde‡
sig_≥ndög


186 #unde‡
sigfd


187 #unde‡
sigfd_£t


188 #unde‡
sigfd_w


189 #unde‡
timeout_blocktime


190 #unde‡
timî˙t


191 #unde‡
timîmax


192 #unde‡
timîs


193 #unde‡
u£rd©a


194 #unde‡
vec_eo


195 #unde‡
vec_max


196 #unde‡
vec_ri


197 #unde‡
vec_ro


198 #unde‡
vec_wi


199 #unde‡
vec_wo


	@libev/event.c

40 
	~<°ddef.h
>

41 
	~<°dlib.h
>

42 
	~<as£π.h
>

44 #ifde‡
EV_EVENT_H


45 #ö˛udê
EV_EVENT_H


47 
	~"evít.h
"

50 #i‡
EV_MULTIPLICITY


51 
	#dLOOPev
 
ev_lo›
 *
lo›
 = (ev_lo› *)
ev
->
ev_ba£


	)

52 
	#dLOOPba£
 
ev_lo›
 *
lo›
 = (ev_lo› *)
ba£


	)

54 
	#dLOOPev


	)

55 
	#dLOOPba£


	)

59 
	sevít_ba£


61 
	mdummy
;

64 
evít_ba£
 *
	gev_x_cur
;

66 
ev_t°amp


67 
	$ev_tv_gë
 (
timevÆ
 *
tv
)

69 i‡(
tv
)

71 
ev_t°amp
 
a·î
 = 
tv
->
tv_£c
 +Åv->
tv_u£c
 * 1e-6;

72  
a·î
 ?áfter : 1e-6;

76 
	}
}

78 
	#EVENT_STRINGIFY
(
s
Ë#s

	)

79 
	#EVENT_VERSION
(
a
,
b
Ë
	`EVENT_STRINGIFY
 (aË"." EVENT_STRINGIFY (b)

	)

82 
	$evít_gë_vîsi⁄
 ()

85  
	`EVENT_VERSION
 (
EV_VERSION_MAJOR
, 
EV_VERSION_MINOR
);

86 
	}
}

89 
	$evít_gë_mëhod
 ()

92 
	}
}

94 *
	$evít_öô
 ()

96 #i‡
EV_MULTIPLICITY


97 i‡(
ev_x_cur
)

98 
ev_x_cur
 = (
evít_ba£
 *)
	`ev_lo›_√w
 (
EVFLAG_AUTO
);

100 
ev_x_cur
 = (
evít_ba£
 *)
	`ev_deÁu…_lo›
 (
EVFLAG_AUTO
);

102 
	`as£π
 (("libev: mu…ùÀÉvíàba£†nŸ suµ‹ãd whíÇŸ compûed wôh EV_MULTIPLICITY", !
ev_x_cur
));

104 
ev_x_cur
 = (
evít_ba£
 *)()
	`ev_deÁu…_lo›
 (
EVFLAG_AUTO
);

107  
ev_x_cur
;

108 
	}
}

111 
	$evít_ba£_gë_mëhod
 (c⁄° 
evít_ba£
 *
ba£
)

114 
	}
}

116 
evít_ba£
 *

117 
	$evít_ba£_√w
 ()

119 #i‡
EV_MULTIPLICITY


120  (
evít_ba£
 *)
	`ev_lo›_√w
 (
EVFLAG_AUTO
);

122 
	`as£π
 (("libev: multipleÉvent basesÇot supported whenÇot compiled with EV_MULTIPLICITY"));

123  
NULL
;

125 
	}
}

127 
	$evít_ba£_‰ì
 (
evít_ba£
 *
ba£
)

129 
dLOOPba£
;

131 #i‡
EV_MULTIPLICITY


132 i‡(!
	`ev_is_deÁu…_lo›
 (
lo›
))

133 
	`ev_lo›_de°roy
 (
lo›
);

135 
	}
}

137 
	$evít_di•©ch
 ()

139  
	`evít_ba£_di•©ch
 (
ev_x_cur
);

140 
	}
}

142 #ifde‡
EV_STANDALONE


143 
	$evít_£t_log_ˇŒback
 (
evít_log_cb
 
cb
)

146 
	}
}

149 
	$evít_lo›
 (
Êags
)

151  
	`evít_ba£_lo›
 (
ev_x_cur
, 
Êags
);

152 
	}
}

154 
	$evít_lo›exô
 (
timevÆ
 *
tv
)

156  
	`evít_ba£_lo›exô
 (
ev_x_cur
, 
tv
);

157 
	}
}

159 
evít_ˇŒback_‚
 
	gevít_gë_ˇŒback


160 (c⁄° 
evít
 *
	gev
)

162  
	gev
->
	gev_ˇŒback
;

166 
	$ev_x_cb
 (
evít
 *
ev
, 
ªvíts
)

168 
ªvíts
 &
EV_READ
 | 
EV_WRITE
 | 
EV_TIMER
 | 
EV_SIGNAL
;

170 
ev
->
ev_ªs
 = 
ªvíts
;

171 
ev
->
	`ev_ˇŒback
 (ev->
ev_fd
, ()
ªvíts
,Év->
ev_¨g
);

172 
	}
}

175 
	$ev_x_cb_sig
 (
EV_P_
 
ev_sig«l
 *
w
, 
ªvíts
)

177 
evít
 *
ev
 = (evíà*)(((*)
w
Ë- 
	`off£tof
 (evít, 
iosig
.
sig
));

179 i‡(
ªvíts
 & 
EV_ERROR
)

180 
	`evít_dñ
 (
ev
);

182 
	`ev_x_cb
 (
ev
, 
ªvíts
);

183 
	}
}

186 
	$ev_x_cb_io
 (
EV_P_
 
ev_io
 *
w
, 
ªvíts
)

188 
evít
 *
ev
 = (evíà*)(((*)
w
Ë- 
	`off£tof
 (evít, 
iosig
.
io
));

190 i‡((
ªvíts
 & 
EV_ERROR
Ë|| !(
ev
->
ev_evíts
 & 
EV_PERSIST
))

191 
	`evít_dñ
 (
ev
);

193 
	`ev_x_cb
 (
ev
, 
ªvíts
);

194 
	}
}

197 
	$ev_x_cb_to
 (
EV_P_
 
ev_timî
 *
w
, 
ªvíts
)

199 
evít
 *
ev
 = (evíà*)(((*)
w
Ë- 
	`off£tof
 (evít, 
to
));

201 
	`evít_dñ
 (
ev
);

203 
	`ev_x_cb
 (
ev
, 
ªvíts
);

204 
	}
}

206 
	$evít_£t
 (
evít
 *
ev
, 
fd
, 
evíts
, (*
cb
)(, , *), *
¨g
)

208 i‡(
evíts
 & 
EV_SIGNAL
)

209 
	`ev_öô
 (&
ev
->
iosig
.
sig
, 
ev_x_cb_sig
);

211 
	`ev_öô
 (&
ev
->
iosig
.
io
, 
ev_x_cb_io
);

213 
	`ev_öô
 (&
ev
->
to
, 
ev_x_cb_to
);

215 
ev
->
ev_ba£
 = 
ev_x_cur
;

216 
ev
->
ev_fd
 = 
fd
;

217 
ev
->
ev_evíts
 = 
evíts
;

218 
ev
->
ev_¥i
 = 0;

219 
ev
->
ev_ˇŒback
 = 
cb
;

220 
ev
->
ev_¨g
 = 
¨g
;

221 
ev
->
ev_ªs
 = 0;

222 
ev
->
ev_Êags
 = 
EVLIST_INIT
;

223 
	}
}

225 
	$evít_⁄˚
 (
fd
, 
evíts
, (*
cb
)(, , *), *
¨g
, 
timevÆ
 *
tv
)

227  
	`evít_ba£_⁄˚
 (
ev_x_cur
, 
fd
, 
evíts
, 
cb
, 
¨g
, 
tv
);

228 
	}
}

230 
	$evít_add
 (
evít
 *
ev
, 
timevÆ
 *
tv
)

232 
dLOOPev
;

234 i‡(
ev
->
ev_evíts
 & 
EV_SIGNAL
)

236 i‡(!
	`ev_is_a˘ive
 (&
ev
->
iosig
.
sig
))

238 
	`ev_sig«l_£t
 (&
ev
->
iosig
.
sig
,Év->
ev_fd
);

239 
	`ev_sig«l_°¨t
 (
EV_A_
 &
ev
->
iosig
.
sig
);

241 
ev
->
ev_Êags
 |
EVLIST_SIGNAL
;

244 i‡(
ev
->
ev_evíts
 & (
EV_READ
 | 
EV_WRITE
))

246 i‡(!
	`ev_is_a˘ive
 (&
ev
->
iosig
.
io
))

248 
	`ev_io_£t
 (&
ev
->
iosig
.
io
,Év->
ev_fd
,Év->
ev_evíts
 & (
EV_READ
 | 
EV_WRITE
));

249 
	`ev_io_°¨t
 (
EV_A_
 &
ev
->
iosig
.
io
);

251 
ev
->
ev_Êags
 |
EVLIST_INSERTED
;

255 i‡(
tv
)

257 
ev
->
to
.
ª≥©
 = 
	`ev_tv_gë
 (
tv
);

258 
	`ev_timî_agaö
 (
EV_A_
 &
ev
->
to
);

259 
ev
->
ev_Êags
 |
EVLIST_TIMEOUT
;

263 
	`ev_timî_°›
 (
EV_A_
 &
ev
->
to
);

264 
ev
->
ev_Êags
 &~
EVLIST_TIMEOUT
;

267 
ev
->
ev_Êags
 |
EVLIST_ACTIVE
;

270 
	}
}

272 
	$evít_dñ
 (
evít
 *
ev
)

274 
dLOOPev
;

276 i‡(
ev
->
ev_evíts
 & 
EV_SIGNAL
)

277 
	`ev_sig«l_°›
 (
EV_A_
 &
ev
->
iosig
.
sig
);

278 i‡(
ev
->
ev_evíts
 & (
EV_READ
 | 
EV_WRITE
))

279 
	`ev_io_°›
 (
EV_A_
 &
ev
->
iosig
.
io
);

281 i‡(
	`ev_is_a˘ive
 (&
ev
->
to
))

282 
	`ev_timî_°›
 (
EV_A_
 &
ev
->
to
);

284 
ev
->
ev_Êags
 = 
EVLIST_INIT
;

287 
	}
}

289 
	$evít_a˘ive
 (
evít
 *
ev
, 
ªs
, 
nˇŒs
)

291 
dLOOPev
;

293 i‡(
ªs
 & 
EV_TIMEOUT
)

294 
	`ev_„ed_evít
 (
EV_A_
 &
ev
->
to
, 
ªs
 & 
EV_TIMEOUT
);

296 i‡(
ªs
 & 
EV_SIGNAL
)

297 
	`ev_„ed_evít
 (
EV_A_
 &
ev
->
iosig
.
sig
, 
ªs
 & 
EV_SIGNAL
);

299 i‡(
ªs
 & (
EV_READ
 | 
EV_WRITE
))

300 
	`ev_„ed_evít
 (
EV_A_
 &
ev
->
iosig
.
io
, 
ªs
 & (
EV_READ
 | 
EV_WRITE
));

301 
	}
}

303 
	$evít_≥ndög
 (
evít
 *
ev
, 
evíts
, 
timevÆ
 *
tv
)

305 
ªvíts
 = 0;

306 
dLOOPev
;

308 i‡(
ev
->
ev_evíts
 & 
EV_SIGNAL
)

311 i‡(
	`ev_is_a˘ive
 (&
ev
->
iosig
.
sig
Ë|| 
	`ev_is_≥ndög
 (&ev->iosig.sig))

312 
ªvíts
 |
EV_SIGNAL
;

314 i‡(
ev
->
ev_evíts
 & (
EV_READ
 | 
EV_WRITE
))

317 i‡(
	`ev_is_a˘ive
 (&
ev
->
iosig
.
io
Ë|| 
	`ev_is_≥ndög
 (&ev->iosig.io))

318 
ªvíts
 |
ev
->
ev_evíts
 & (
EV_READ
 | 
EV_WRITE
);

321 i‡(
ev
->
ev_evíts
 & 
EV_TIMEOUT
 || 
	`ev_is_a˘ive
 (&ev->
to
Ë|| 
	`ev_is_≥ndög
 (&ev->to))

323 
ªvíts
 |
EV_TIMEOUT
;

325 i‡(
tv
)

327 
ev_t°amp
 
©
 = 
	`ev_now
 (
EV_A
);

329 
tv
->
tv_£c
 = ()
©
;

330 
tv
->
tv_u£c
 = ()((
©
 - (
ev_t°amp
Èv->
tv_£c
) * 1e6);

334  
evíts
 & 
ªvíts
;

335 
	}
}

337 
	$evít_¥i‹ôy_öô
 (
≈ri
)

339  
	`evít_ba£_¥i‹ôy_öô
 (
ev_x_cur
, 
≈ri
);

340 
	}
}

342 
	$evít_¥i‹ôy_£t
 (
evít
 *
ev
, 
¥i
)

344 
ev
->
ev_¥i
 = 
¥i
;

347 
	}
}

349 
	$evít_ba£_£t
 (
evít_ba£
 *
ba£
, 
evít
 *
ev
)

351 
ev
->
ev_ba£
 = 
ba£
;

354 
	}
}

356 
	$evít_ba£_lo›
 (
evít_ba£
 *
ba£
, 
Êags
)

358 
dLOOPba£
;

360  !
	`ev_run
 (
EV_A_
 
Êags
);

361 
	}
}

363 
	$evít_ba£_di•©ch
 (
evít_ba£
 *
ba£
)

365  
	`evít_ba£_lo›
 (
ba£
, 0);

366 
	}
}

369 
	$ev_x_lo›exô_cb
 (
ªvíts
, *
ba£
)

371 
dLOOPba£
;

373 
	`ev_bªak
 (
EV_A_
 
EVBREAK_ONE
);

374 
	}
}

376 
	$evít_ba£_lo›exô
 (
evít_ba£
 *
ba£
, 
timevÆ
 *
tv
)

378 
ev_t°amp
 
a·î
 = 
	`ev_tv_gë
 (
tv
);

379 
dLOOPba£
;

381 
	`ev_⁄˚
 (
EV_A_
 -1, 0, 
a·î
 >0. ?á·î : 0., 
ev_x_lo›exô_cb
, (*)
ba£
);

384 
	}
}

386 
	sev_x_⁄˚


388 
	mfd
;

389 (*
	mcb
)(, , *);

390 *
	m¨g
;

394 
	$ev_x_⁄˚_cb
 (
ªvíts
, *
¨g
)

396 
ev_x_⁄˚
 *
⁄˚
 = (ev_x_⁄˚ *)
¨g
;

398 
⁄˚
->
	`cb
 (⁄˚->
fd
, ()
ªvíts
, on˚->
¨g
);

399 
	`‰ì
 (
⁄˚
);

400 
	}
}

402 
	$evít_ba£_⁄˚
 (
evít_ba£
 *
ba£
, 
fd
, 
evíts
, (*
cb
)(, , *), *
¨g
, 
timevÆ
 *
tv
)

404 
ev_x_⁄˚
 *
⁄˚
 = (ev_x_⁄˚ *)
	`mÆloc
 ( (ev_x_once));

405 
dLOOPba£
;

407 i‡(!
⁄˚
)

410 
⁄˚
->
fd
 = fd;

411 
⁄˚
->
cb
 = cb;

412 
⁄˚
->
¨g
 =árg;

414 
	`ev_⁄˚
 (
EV_A_
 
fd
, 
evíts
 & (
EV_READ
 | 
EV_WRITE
), 
	`ev_tv_gë
 (
tv
), 
ev_x_⁄˚_cb
, (*)
⁄˚
);

417 
	}
}

419 
	$evít_ba£_¥i‹ôy_öô
 (
evít_ba£
 *
ba£
, 
≈ri
)

424 
	}
}

	@libev/event.h

40 #i‚de‡
EVENT_H_


41 
	#EVENT_H_


	)

43 #ifde‡
EV_H


44 #ö˛udê
EV_H


46 
	~"ev.h
"

49 #i‚de‡
EVLOOP_NONBLOCK


50 
	#EVLOOP_NONBLOCK
 
EVRUN_NOWAIT


	)

52 #i‚de‡
EVLOOP_ONESHOT


53 
	#EVLOOP_ONESHOT
 
EVRUN_ONCE


	)

55 #i‚de‡
EV_TIMEOUT


56 
	#EV_TIMEOUT
 
EV_TIMER


	)

59 #ifde‡
__˝lu•lus


64 #i‡!
deföed
 (
WIN32
Ë|| deföed (
__MINGW32__
)

65 
	~<time.h
>

66 
	~<sys/time.h
>

69 
evít_ba£
;

71 
	#EVLIST_TIMEOUT
 0x01

	)

72 
	#EVLIST_INSERTED
 0x02

	)

73 
	#EVLIST_SIGNAL
 0x04

	)

74 
	#EVLIST_ACTIVE
 0x08

	)

75 
	#EVLIST_INTERNAL
 0x10

	)

76 
	#EVLIST_INIT
 0x80

	)

78 (*
evít_ˇŒback_‚
)(, , *);

80 
	sevít


84 
ev_io
 
io
;

85 
ev_sig«l
 
sig
;

86 } 
iosig
;

87 
ev_timî
 
to
;

90 
evít_ba£
 *
ev_ba£
;

91 
evít_ˇŒback_‚
 
ev_ˇŒback
;

92 *
ev_¨g
;

93 
ev_fd
;

94 
ev_¥i
;

95 
ev_ªs
;

96 
ev_Êags
;

97 
ev_evíts
;

100 
evít_ˇŒback_‚
 
evít_gë_ˇŒback
 (c⁄° 
evít
 *
ev
);

102 
	#EV_READ
 
EV_READ


	)

103 
	#EV_WRITE
 
EV_WRITE


	)

104 
	#EV_PERSIST
 0x10

	)

105 
	#EV_ET
 0x20

	)

107 
	#EVENT_SIGNAL
(
ev
Ë((Ë”v)->
ev_fd
)

	)

108 
	#EVENT_FD
(
ev
Ë((Ë”v)->
ev_fd
)

	)

110 
	#evít_öôülized
(
ev
Ë(”v)->
ev_Êags
 & 
EVLIST_INIT
)

	)

112 
	#evtimî_add
(
ev
,
tv
Ë
	`evít_add
 (ev,Åv)

	)

113 
	#evtimî_£t
(
ev
,
cb
,
d©a
Ë
	`evít_£t
 (ev, -1, 0, cb, d©a)

	)

114 
	#evtimî_dñ
(
ev
Ë
	`evít_dñ
 (ev)

	)

115 
	#evtimî_≥ndög
(
ev
,
tv
Ë
	`evít_≥ndög
 (ev, 
EV_TIMEOUT
,Åv)

	)

116 
	#evtimî_öôülized
(
ev
Ë
	`evít_öôülized
 (ev)

	)

118 
	#timeout_add
(
ev
,
tv
Ë
	`evtimî_add
 (ev,Åv)

	)

119 
	#timeout_£t
(
ev
,
cb
,
d©a
Ë
	`evtimî_£t
 (ev, cb, d©a)

	)

120 
	#timeout_dñ
(
ev
Ë
	`evtimî_dñ
 (ev)

	)

121 
	#timeout_≥ndög
(
ev
,
tv
Ë
	`evtimî_≥ndög
 (ev,Åv)

	)

122 
	#timeout_öôülized
(
ev
Ë
	`evtimî_öôülized
 (ev)

	)

124 
	#sig«l_add
(
ev
,
tv
Ë
	`evít_add
 (ev,Åv)

	)

125 
	#sig«l_£t
(
ev
,
sig
,
cb
,
d©a
Ë
	`evít_£t
 (ev, sig, 
EV_SIGNAL
 | 
EV_PERSIST
, cb, d©a)

	)

126 
	#sig«l_dñ
(
ev
Ë
	`evít_dñ
 (ev)

	)

127 
	#sig«l_≥ndög
(
ev
,
tv
Ë
	`evít_≥ndög
 (ev, 
EV_SIGNAL
,Åv)

	)

128 
	#sig«l_öôülized
(
ev
Ë
	`evít_öôülized
 (ev)

	)

130 c⁄° *
evít_gë_vîsi⁄
 ();

131 c⁄° *
evít_gë_mëhod
 ();

133 *
evít_öô
 ();

134 
evít_ba£_‰ì
 (
evít_ba£
 *
ba£
);

136 
	#EVLOOP_ONCE
 
EVLOOP_ONESHOT


	)

137 
evít_lo›
 ();

138 
evít_lo›exô
 (
timevÆ
 *
tv
);

139 
evít_di•©ch
 ();

141 
	#_EVENT_LOG_DEBUG
 0

	)

142 
	#_EVENT_LOG_MSG
 1

	)

143 
	#_EVENT_LOG_WARN
 2

	)

144 
	#_EVENT_LOG_ERR
 3

	)

145 (*
evít_log_cb
)(
	t£vîôy
, c⁄° *
	tmsg
);

146 
evít_£t_log_ˇŒback
(
evít_log_cb
 
cb
);

148 
evít_£t
 (
evít
 *
ev
, 
fd
, 
evíts
, (*
cb
)(, , *), *
¨g
);

149 
evít_⁄˚
 (
fd
, 
evíts
, (*
cb
)(, , *), *
¨g
, 
timevÆ
 *
tv
);

151 
evít_add
 (
evít
 *
ev
, 
timevÆ
 *
tv
);

152 
evít_dñ
 (
evít
 *
ev
);

153 
evít_a˘ive
 (
evít
 *
ev
, 
ªs
, 
nˇŒs
);

155 
evít_≥ndög
 (
evít
 *
ev
, , 
timevÆ
 *
tv
);

157 
evít_¥i‹ôy_öô
 (
≈ri
);

158 
evít_¥i‹ôy_£t
 (
evít
 *
ev
, 
¥i
);

160 
evít_ba£
 *
evít_ba£_√w
 ();

161 c⁄° *
evít_ba£_gë_mëhod
 (c⁄° 
evít_ba£
 *);

162 
evít_ba£_£t
 (
evít_ba£
 *
ba£
, 
evít
 *
ev
);

163 
evít_ba£_lo›
 (
evít_ba£
 *
ba£
, );

164 
evít_ba£_lo›exô
 (
evít_ba£
 *
ba£
, 
timevÆ
 *
tv
);

165 
evít_ba£_di•©ch
 (
evít_ba£
 *
ba£
);

166 
evít_ba£_⁄˚
 (
evít_ba£
 *
ba£
, 
fd
, 
evíts
, (*
cb
)(, , *), *
¨g
, 
timevÆ
 *
tv
);

167 
evít_ba£_¥i‹ôy_öô
 (
evít_ba£
 *
ba£
, 
fd
);

172 #ifde‡
__˝lu•lus


	@local-tcp-client.c

1 
	~<î∫o.h
>

2 
	~<ev.h
>

3 
	~<ik˝.h
>

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	~<°rög.h
>

7 
	~<sys/f˙é.h
>

8 
	~<sys/sockë.h
>

9 
	~<sys/un.h
>

10 
	~<uni°d.h
>

17 
	gEV_P
;

18 
ev_io
 
	g°dö_w©chî
;

19 
ev_io
 
	gªmŸe_w
;

20 
ev_io
 
	g£nd_w
;

21 
	gªmŸe_fd
;

22 *
	gLINE
 = 
NULL
;

23 
size_t
 
	gLEN
 = 0;

25 
ik˝cb
 *
	gk˝
 = 
NULL
;

26 
size_t
 
	gKCP_SESSION
 = 0x998712;

29 
ölöe
 
IINT64
 
	$i˛ock64
() {

30 
IINT64
 
vÆue
;

31 
timevÆ
 
time
;

32 
	`gëtimeofday
(&
time
, 
NULL
);

33 
vÆue
 = ((
IINT64
)
time
.
tv_£c
Ë* 1000 + (time.
tv_u£c
 / 1000);

34  
vÆue
;

35 
	}
}

37 
ölöe
 
IUINT32
 
	$i˛ock
(Ë{  (
IUINT32
)(
	`i˛ock64
(Ë& 0xfffffffful); 
	}
}

39 
	$k˝_check_h™dÀr
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
) {

40 
	`ik˝_upd©e
(
k˝
, 
	`i˛ock
());

42 
buf„r
[100];

43 
Àn
 = 
	`ik˝_ªcv
(
k˝
, 
buf„r
, 100);

44 i‡(
Àn
 > 0) {

45 
	`¥ötf
("˛õ¡ k˝Ñecv %s\n", 
buf„r
);

47 
	}
}

49 
	$k˝_ouçut
(c⁄° *
buf
, 
Àn
, 
ik˝cb
 *
k˝
, *
u£r
) {

50 
ªt
 = 
	`£nd
(
ªmŸe_fd
, 
buf
, 
Àn
, 0);

52 
	}
}

54 
	$£nd_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

55 i‡(
ªvíts
 & 
EV_WRITE
) {

56 
	`ik˝_£nd
(
k˝
, 
LINE
, 
LEN
);

60 
	`ev_io_°›
(
EV_A_
 & 
£nd_w
);

61 
	`ev_io_£t
(&
£nd_w
, 
ªmŸe_fd
, 
EV_READ
);

62 
	`ev_io_°¨t
(
EV_A_
 & 
£nd_w
);

63 } i‡(
ªvíts
 & 
EV_READ
) {

64 
n
;

65 
°r
[100] = ".\0";

66 
n
 = 
	`ªcv
(
ªmŸe_fd
, 
°r
, 100, 0);

67 i‡(
n
 <= 0) {

68 i‡(0 =
n
) {

70 
	`puts
("orderly disconnect");

71 
	`ev_io_°›
(
EV_A_
 & 
£nd_w
);

72 
	`˛o£
(
ªmŸe_fd
);

73 } i‡(
EAGAIN
 =
î∫o
) {

74 
	`puts
("shouldÇever get inÅhis state withÜibev");

76 
	`≥º‹
("recv");

80 
	`ik˝_öput
(
k˝
, 
°r
, 
n
);

82 
	}
}

84 
	$°dö_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

85 
Àn2
;

87 
	`puts
("stdin writtenÅo,Ñeading...");

88 
Àn2
 = 
	`gëlöe
(&
LINE
, &
LEN
, 
°dö
);

89 
	`ev_io_°›
(
EV_A_
 & 
£nd_w
);

90 
	`ev_io_£t
(&
£nd_w
, 
ªmŸe_fd
, 
EV_READ
 | 
EV_WRITE
);

91 
	`ev_io_°¨t
(
EV_A_
 & 
£nd_w
);

92 
	}
}

94 
	$ªmŸe_cb
(
EV_P_
 
ev_io
 *
w
, 
ªvíts
) {

95 
	`puts
("connected,Çow watching stdin");

97 
	`ev_io_°¨t
(
EV_A_
 & 
°dö_w©chî
);

99 
	`ev_io_°›
(
EV_A_
 & 
ªmŸe_w
);

100 
	}
}

103 
	$£ä⁄block
(
fd
) {

104 
Êags
;

106 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
);

107 
Êags
 |
O_NONBLOCK
;

108  
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
);

109 
	}
}

111 
	$c⁄√˘i⁄_√w
(
EV_P_
 *
sock_∑th
) {

112 
Àn
;

113 
sockaddr_un
 
ªmŸe
;

115 i‡(-1 =(
ªmŸe_fd
 = 
	`sockë
(
AF_UNIX
, 
SOCK_STREAM
, 0))) {

116 
	`≥º‹
("socket");

117 
	`exô
(1);

121 i‡(-1 =
	`£ä⁄block
(
ªmŸe_fd
)) {

122 
	`≥º‹
("echo client socketÇonblock");

123 
	`exô
(
EXIT_FAILURE
);

131 
	`ev_io_öô
(&
ªmŸe_w
, 
ªmŸe_cb
, 
ªmŸe_fd
, 
EV_WRITE
);

132 
	`ev_io_°¨t
(
EV_A_
 & 
ªmŸe_w
);

135 
	`ev_io_öô
(&
£nd_w
, 
£nd_cb
, 
ªmŸe_fd
, 
EV_READ
);

136 
	`ev_io_°¨t
(
EV_A_
 & 
£nd_w
);

138 
ªmŸe
.
sun_Ámûy
 = 
AF_UNIX
;

139 
	`°r˝y
(
ªmŸe
.
sun_∑th
, 
sock_∑th
);

140 
Àn
 = 
	`°æí
(
ªmŸe
.
sun_∑th
Ë+ ‘emŸe.
sun_Ámûy
);

142 i‡(-1 =
	`c⁄√˘
(
ªmŸe_fd
, (
sockaddr
 *)&
ªmŸe
, 
Àn
)) {

143 
	`≥º‹
("connect");

146 
	}
}

148 
	$maö
() {

149 
lo›
 = 
EV_DEFAULT
;

152 
	`£ä⁄block
(0);

153 
	`ev_io_öô
(&
°dö_w©chî
, 
°dö_cb
, 0, 
EV_READ
);

155 
k˝
 = 
	`ik˝_¸óã
(
KCP_SESSION
, 
NULL
);

156 
k˝
->
ouçut
 = 
k˝_ouçut
;

157 
ev_≥riodic
 
k˝_check_ev
;

158 
	`ev_≥riodic_öô
(&
k˝_check_ev
, 
k˝_check_h™dÀr
, 0, 0.1, 0);

159 
	`ev_≥riodic_°¨t
(
EV_A_
 &
k˝_check_ev
);

161 
	`c⁄√˘i⁄_√w
(
EV_A_
 "/tmp/libev-echo.sock");

164 
	`ev_lo›
(
EV_A_
 0);

166 
	`ik˝_ªÀa£
(
k˝
);

170 
	}
}

	@local-tcp-server.c

1 
	~<î∫o.h
>

2 
	~<f˙é.h
>

3 
	~<°dio.h
>

4 
	~<°dlib.h
>

5 
	~<°rög.h
>

6 
	~<ik˝.h
>

8 
	~<sys/sockë.h
>

9 
	~<sys/ty≥s.h
>

10 
	~<sys/un.h
>

12 
	~<ev.h
>

14 
	#g_w¨nög
 
¥ötf


	)

17 
	~<uni°d.h
>

18 
	~"¨øy-hóp.h
"

20 
ik˝cb
 *
	gk˝
 = 
NULL
;

21 
size_t
 
	gKCP_SESSION
 = 0x998712;

25 
ölöe
 
IINT64
 
	$i˛ock64
() {

26 
IINT64
 
vÆue
;

27 
timevÆ
 
time
;

28 
	`gëtimeofday
(&
time
, 
NULL
);

29 
vÆue
 = ((
IINT64
)
time
.
tv_£c
Ë* 1000 + (time.
tv_u£c
 / 1000);

30  
vÆue
;

31 
	}
}

33 
ölöe
 
IUINT32
 
	$i˛ock
(Ë{  (
IUINT32
)(
	`i˛ock64
(Ë& 0xfffffffful); 
	}
}

35 
	$k˝_ouçut
(c⁄° *
buf
, 
Àn
, 
ik˝cb
 *
k˝
, *
u£r
) {

37 
	}
}

39 
	$k˝_check_h™dÀr
(
EV_P_
 
ev_≥riodic
 *
w
, 
ªvíts
) {

40 
	`ik˝_upd©e
(
k˝
, 
	`i˛ock
());

42 
buf„r
[1000];

43 
Àn
 = 
	`ik˝_ªcv
(
k˝
, 
buf„r
, 1000);

44 i‡(
Àn
 > 0) {

45 
	`¥ötf
("£rvî k˝Ñecv %s\n", 
buf„r
);

47 
	}
}

49 
	ssock_ev_£rv
 {

50 
ev_io
 
	mio
;

51 
	mfd
;

52 
sockaddr_un
 
	msockë
;

53 
	msockë_Àn
;

54 
¨øy
 
	m˛õ¡s
;

57 
	ssock_ev_˛õ¡
 {

58 
ev_io
 
	mio
;

59 
	mfd
;

60 
	mödex
;

61 
sock_ev_£rv
* 
	m£rvî
;

64 
£ä⁄block
(
fd
);

65 
	$nŸ_blocked
(
EV_P_
 
ev_≥riodic
* 
w
, 
ªvíts
) {

66 
	`puts
("I'mÇot blocked");

67 
	}
}

70 
	$˛õ¡_cb
(
EV_P_
 
ev_io
* 
w
, 
ªvíts
) {

73 
sock_ev_˛õ¡
* 
˛õ¡
 = (sock_ev_˛õ¡*)
w
;

75 
n
;

76 
°r
[1000] = ".\0";

78 
n
 = 
	`ªcv
(
˛õ¡
->
fd
, 
°r
, 1000, 0);

79 i‡(
n
 <= 0) {

80 i‡(0 =
n
) {

82 
	`puts
("orderly disconnect");

83 
	`ev_io_°›
(
EV_A_
 & 
˛õ¡
->
io
);

84 
	`˛o£
(
˛õ¡
->
fd
);

85 } i‡(
EAGAIN
 =
î∫o
) {

86 
	`puts
("shouldÇever get inÅhis state withÜibev");

88 
	`≥º‹
("recv");

92 
ªt
 = 
	`ik˝_öput
(
k˝
, 
°r
, 
n
);

93 
	`¥ötf
("k˝ i≈uà%d\n", 
ªt
);

94 
	}
}

96 
ölöe
 
sock_ev_˛õ¡
* 
	$˛õ¡_√w
(
fd
) {

97 
sock_ev_˛õ¡
* 
˛õ¡
;

99 
˛õ¡
 = 
	`ªÆloc
(
NULL
, (
sock_ev_˛õ¡
));

100 
˛õ¡
->
fd
 = fd;

102 
	`£ä⁄block
(
˛õ¡
->
fd
);

103 
	`ev_io_öô
(&
˛õ¡
->
io
, 
˛õ¡_cb
, clõ¡->
fd
, 
EV_READ
);

105  
˛õ¡
;

106 
	}
}

109 
	$£rvî_cb
(
EV_P_
 
ev_io
* 
w
, 
ªvíts
) {

110 
	`puts
("unix stream socket has becomeÑeadable");

112 
˛õ¡_fd
;

113 
sock_ev_˛õ¡
* 
˛õ¡
;

118 
sock_ev_£rv
* 
£rvî
 = (sock_ev_£rv*)
w
;

121 
˛õ¡_fd
 = 
	`ac˚±
(
£rvî
->
fd
, 
NULL
, NULL);

122 i‡(
˛õ¡_fd
 == -1) {

123 i‡(
î∫o
 !
EAGAIN
 &&Éºnÿ!
EWOULDBLOCK
) {

124 
	`g_w¨nög
("ac˚±(ËÁûedÉºno=%ò(%s)", 
î∫o
, 
	`°ªº‹
(errno));

125 
	`exô
(
EXIT_FAILURE
);

129 
	`puts
("acceptedá client");

130 
˛õ¡
 = 
	`˛õ¡_√w
(
˛õ¡_fd
);

131 
˛õ¡
->
£rvî
 = server;

132 
˛õ¡
->
ödex
 = 
	`¨øy_push
(&
£rvî
->
˛õ¡s
, client);

133 
	`ev_io_°¨t
(
EV_A_
 & 
˛õ¡
->
io
);

135 
	}
}

138 
	$£ä⁄block
(
fd
) {

139 
Êags
;

141 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
);

142 
Êags
 |
O_NONBLOCK
;

143  
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
);

144 
	}
}

146 
	$unix_sockë_öô
(
sockaddr_un
* 
sockë_un
, * 
sock_∑th
,

147 
max_queue
) {

148 
fd
;

150 
	`u∆ök
(
sock_∑th
);

153 
fd
 = 
	`sockë
(
AF_UNIX
, 
SOCK_STREAM
, 0);

154 i‡(-1 =
fd
) {

155 
	`≥º‹
("echo server socket");

156 
	`exô
(
EXIT_FAILURE
);

160 i‡(-1 =
	`£ä⁄block
(
fd
)) {

161 
	`≥º‹
("echo server socketÇonblock");

162 
	`exô
(
EXIT_FAILURE
);

166 
sockë_un
->
sun_Ámûy
 = 
AF_UNIX
;

167 
	`°r˝y
(
sockë_un
->
sun_∑th
, 
sock_∑th
);

169  
fd
;

170 
	}
}

172 
	$£rvî_öô
(
sock_ev_£rv
* 
£rvî
, * 
sock_∑th
, 
max_queue
) {

173 
£rvî
->
fd
 = 
	`unix_sockë_öô
(&£rvî->
sockë
, 
sock_∑th
, 
max_queue
);

174 
£rvî
->
sockë_Àn
 =

175 (
£rvî
->
sockë
.
sun_Ámûy
Ë+ 
	`°æí
(£rvî->sockë.
sun_∑th
);

177 
	`¨øy_öô
(&
£rvî
->
˛õ¡s
, 128);

180 
	`böd
(
£rvî
->
fd
, (
sockaddr
*)&£rvî->
sockë
, sîvî->
sockë_Àn
)) {

181 
	`≥º‹
("echo server bind");

182 
	`exô
(
EXIT_FAILURE
);

185 i‡(-1 =
	`li°í
(
£rvî
->
fd
, 
max_queue
)) {

186 
	`≥º‹
("listen");

187 
	`exô
(
EXIT_FAILURE
);

190 
	}
}

192 
	$maö
() {

193 
max_queue
 = 128;

194 
sock_ev_£rv
 
£rvî
;

195 
ev_≥riodic
 
evîy_„w_£c⁄ds
;

197 
EV_P
 = 
	`ev_deÁu…_lo›
(0);

200 
	`£rvî_öô
(&
£rvî
, "/tmp/libev-echo.sock", 
max_queue
);

203 
	`ev_≥riodic_öô
(&
evîy_„w_£c⁄ds
, 
nŸ_blocked
, 0, 5, 0);

204 
	`ev_≥riodic_°¨t
(
EV_A_
 & 
evîy_„w_£c⁄ds
);

207 
k˝
 = 
	`ik˝_¸óã
(
KCP_SESSION
, 
NULL
);

208 
k˝
->
ouçut
 = 
k˝_ouçut
;

209 
ev_≥riodic
 
k˝_check_ev
;

210 
	`ev_≥riodic_öô
(&
k˝_check_ev
, 
k˝_check_h™dÀr
, 0, 0.1, 0);

211 
	`ev_≥riodic_°¨t
(
EV_A_
 &
k˝_check_ev
);

214 
	`ev_io_öô
(&
£rvî
.
io
, 
£rvî_cb
, sîvî.
fd
, 
EV_READ
);

215 
	`ev_io_°¨t
(
EV_A_
 & 
£rvî
.
io
);

218 
	`puts
("unix-socket-echo starting...\n");

219 
	`ev_lo›
(
EV_A_
 0);

222 
	`˛o£
(
£rvî
.
fd
);

223 
	`ik˝_ªÀa£
(
k˝
);

224  
EXIT_SUCCESS
;

225 
	}
}

	@udp-client.c

1 
	~<°dio.h
>

2 
	~<sys/ty≥s.h
>

3 
	~<sys/sockë.h
>

4 
	~<√töë/ö.h
>

5 
	~<¨∑/öë.h
>

6 
	~<√tdb.h
>

7 
	~<°rög.h
>

8 
	~<uni°d.h
>

9 
	~<°dlib.h
>

10 
	~<sys/waô.h
>

11 
	~<sys/°©.h
>

12 
	~<î∫o.h
>

14 
	#RET_OK
 0

	)

15 
	#RET_ERR
 -1

	)

16 
	#LISTEN_QUEUE_NUM
 5

	)

18 
	#BUFFER_SIZE
 256

	)

19 
	#ECHO_PORT
 2029

	)

21 
	$maö
(
¨gc
, *
¨gv
[])

23 
sockfd
, 
ªt
 = 
RET_OK
;

24 
sockaddr_ö
 
£rvaddr
;

25 
ho°ít
 *
£rvî
;

26 
buf„r
[
BUFFER_SIZE
];

28 i‡(
¨gc
 < 2) {

29 
	`Ârötf
(
°dîr
, "ußgê%†ho°«me\n", 
¨gv
[0]);

30  
RET_ERR
;

33 i‡((
£rvî
 = 
	`gëho°by«me
(
¨gv
[1])Ë=
NULL
) {

34 
	`≥º‹
("gethostbyname. ");

35  
RET_ERR
;

39 i‡((
sockfd
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

40 
	`≥º‹
("ERROR opening ocket");

41  
RET_ERR
;

45 
	`mem£t
(&
£rvaddr
, 0, (servaddr));

46 
£rvaddr
.
sö_Ámûy
 = 
AF_INET
;

47 
£rvaddr
.
sö_addr
.
s_addr
 = *(
uöt32_t
 *Ë
£rvî
->
h_addr
;

48 
£rvaddr
.
sö_p‹t
 = 
	`ht⁄s
((
uöt16_t
Ë
ECHO_PORT
);

51 i‡(
	`c⁄√˘
(
sockfd
, (
sockaddr
 *Ë&
£rvaddr
, (servaddr)) < 0) {

52 
	`≥º‹
("ERROR connecting");

53 
Áûed
;

58 
	`¥ötf
("EnterÅhe messagen : ");

59 i‡(
	`fgës
(
buf„r
, (buf„rË- 1, 
°dö
Ë=
NULL
)

61 i‡((
ªt
 = 
	`wrôe
(
sockfd
, 
buf„r
, 
	`°æí
(buffer))) < 0) {

62 
	`≥º‹
("ERROR writingÅo socket");

65 i‡((
ªt
 = 
	`ªad
(
sockfd
, 
buf„r
, (buffer) - 1)) < 0) {

66 
	`≥º‹
("ERRORÑeading from socket");

70 
buf„r
[
ªt
] = 0;

71 
	`¥ötf
("SîvîÉchÿmesßge:%s\n", 
buf„r
);

73 
Áûed
:

74 
	`˛o£
(
sockfd
);

75  
ªt
 < 0 ? 
RET_ERR
 : 
RET_OK
;

76 
	}
}

	@udp-server.c

1 
	~<°dio.h
>

2 
	~<sys/ty≥s.h
>

3 
	~<sys/sockë.h
>

4 
	~<√töë/ö.h
>

5 
	~<¨∑/öë.h
>

6 
	~<√tdb.h
>

7 
	~<°rög.h
>

8 
	~<uni°d.h
>

9 
	~<°dlib.h
>

10 
	~<sys/waô.h
>

11 
	~<sys/°©.h
>

12 
	~<î∫o.h
>

14 
	#RET_OK
 0

	)

15 
	#RET_ERR
 -1

	)

16 
	#LISTEN_QUEUE_NUM
 5

	)

17 
	#BUFFER_SIZE
 256

	)

18 
	#ECHO_PORT
 2029

	)

20 
	$maö
(
¨gc
, **
¨gv
)

22 
sockfd
, 
›t
 = 1;

23 
uöt32_t
 
Àn
;

24 
sockaddr_ö
 
£rvî_addr
, 
˛õ¡_addr
;

25 
uöt8_t
 
buf„r
[
BUFFER_SIZE
];

26 
ªt
 = 
RET_OK
;

29 i‡((
sockfd
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

30 
	`≥º‹
("ERROR opening socket");

31  
RET_ERR
;

35 i‡((
ªt
 = 
	`£tsock›t
(
sockfd
, 
SOL_SOCKET
, 
SO_REUSEADDR
,

36 &
›t
, (opt))) < 0) {

37 
	`≥º‹
("ERROR setsockpot");

38 
Áûed
;

42 
	`mem£t
(&
£rvî_addr
, 0, (server_addr));

43 
£rvî_addr
.
sö_Ámûy
 = 
AF_INET
;

44 
£rvî_addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

45 
£rvî_addr
.
sö_p‹t
 = 
	`ht⁄s
(
ECHO_PORT
);

48 i‡((
ªt
 = 
	`böd
(
sockfd
, (
sockaddr
 *Ë&
£rvî_addr
,

49 (
£rvî_addr
))) < 0) {

50 
	`≥º‹
("ERROR on binding");

51 
Áûed
;

56 
Àn
=(
˛õ¡_addr
);

57 i‡((
ªt
 = 
	`ªcv‰om
(
sockfd
, 
buf„r
, (buffer), 0,

58 (
sockaddr
 *Ë&
˛õ¡_addr
,

59 &
Àn
)) > 0) {

60 
	`¥ötf
("Recv from %s\r\n", 
	`öë_¡ﬂ
(
˛õ¡_addr
.
sö_addr
));

61 
ªt
 = 
	`£ndto
(
sockfd
, 
buf„r
,Ñet, 0,

62 (
sockaddr
 *Ë&
˛õ¡_addr
, (client_addr));

64 } 
ªt
 >= 0);

66 
Áûed
:
	`˛o£
(
sockfd
);

68 
	}
}

	@
1
.
0
53
1787
build/CMakeFiles/3.18.4/CompilerIdC/CMakeCCompilerId.c
build/CMakeFiles/3.18.4/CompilerIdCXX/CMakeCXXCompilerId.cpp
kcp/ikcp.c
kcp/ikcp.h
kcp/test.cpp
kcp/test.h
libev-examples/include/array-heap.h
libev-examples/include/evn-bool.h
libev-examples/include/evn-buffer-list.h
libev-examples/include/evn-inbuf.h
libev-examples/include/evn.h
libev-examples/ipc/my-data.h
libev-examples/ipc/unix-socket-ipc-daemon.c
libev-examples/ipc/unix-socket-ipc-remote-control.c
libev-examples/paired-threaded-ipc/dummy-daemon.c
libev-examples/paired-threaded-ipc/dummy-rc.c
libev-examples/paired-threaded-ipc/dummy-settings.c
libev-examples/paired-threaded-ipc/dummy-worker-test.c
libev-examples/paired-threaded-ipc/dummy-worker-thread.c
libev-examples/paired-threaded-ipc/dummy-worker.c
libev-examples/paired-threaded-ipc/include/dummy-settings.h
libev-examples/paired-threaded-ipc/include/dummy-worker-thread.h
libev-examples/paired-threaded-ipc/include/dummy-worker.h
libev-examples/paired-threaded-ipc/include/dummy_settings_argp_option.c
libev-examples/paired-threaded-ipc/include/dummy_settings_parse_opt.c
libev-examples/paired-threaded-ipc/include/ev.h
libev-examples/paired-threaded-ipc/include/loop.h
libev-examples/paired-threaded-ipc/include/rand.h
libev-examples/paired-threaded-ipc/rand-test.c
libev-examples/paired-threaded-ipc/rand.c
libev-examples/src/array-heap.c
libev-examples/src/array-test.c
libev-examples/src/udp-echo-server.c
libev-examples/src/unix-echo-client.c
libev-examples/src/unix-echo-server.c
libev/config.h
libev/ev++.h
libev/ev.c
libev/ev.h
libev/ev_epoll.c
libev/ev_kqueue.c
libev/ev_poll.c
libev/ev_port.c
libev/ev_select.c
libev/ev_vars.h
libev/ev_win32.c
libev/ev_wrap.h
libev/event.c
libev/event.h
local-tcp-client.c
local-tcp-server.c
udp-client.c
udp-server.c
